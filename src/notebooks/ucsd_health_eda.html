<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/favicon.ico" />
    <!-- Preload is necessary because we show these images when we disconnect from the server,
    but at that point we cannot load these images from the server -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/gradient-yHQUC_QB.png" as="image" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/noise-60BoTA8O.png" as="image" />
    <!-- Preload the fonts -->
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/Lora-VariableFont_wght-B2ootaw-.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/PTSans-Regular-CxL0S8W7.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/PTSans-Bold-D9fedIX3.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/FiraMono-Regular-BTCkDNvf.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/FiraMono-Medium-DU3aDxX5.ttf" as="font" crossorigin="anonymous" />
    <link rel="preload" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/FiraMono-Bold-CLVRCuM9.ttf" as="font" crossorigin="anonymous" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta name="description" content="a marimo app" />
    <link rel="apple-touch-icon" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/apple-touch-icon.png" />
    <link rel="manifest" crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/manifest.json" />

    <script data-marimo="true">
      function __resizeIframe(obj) {
        const scrollbarHeight = 20; // Max between windows, mac, and linux

        function setHeight() {
          // Guard against race condition where iframe isn't ready
          if (!obj.contentWindow?.document?.documentElement) {
            return;
          }
          const element = obj.contentWindow.document.documentElement;
          // If there is no vertical scrollbar, we don't need to resize the iframe
          if (element.scrollHeight === element.clientHeight) {
            return;
          }

          // Create a new height that includes the scrollbar height if it's visible
          const hasHorizontalScrollbar = element.scrollWidth > element.clientWidth;
          const newHeight = element.scrollHeight + (hasHorizontalScrollbar ? scrollbarHeight : 0);

          // Only update the height if it's different from the current height
          if (obj.style.height !== `${newHeight}px`) {
            obj.style.height = `${newHeight}px`;
          }
        }

        // Resize the iframe to the height of the content and bottom scrollbar height
        setHeight();

        // Resize the iframe when the content changes
        const resizeObserver = new ResizeObserver((_entries) => {
          setHeight();
        });
        // Only observe if iframe content is ready
        if (obj.contentWindow?.document?.body) {
          resizeObserver.observe(obj.contentWindow.document.body);
        }
      }
    </script>
    <marimo-filename hidden>my_analysis.py</marimo-filename>
    <!-- TODO(Trevor): Legacy, required by VS Code plugin. Remove when plugin is updated (see marimo/server/_templates/template.py) -->
    <marimo-version data-version="{{ version }}" hidden></marimo-version>
    <marimo-user-config data-config="{{ user_config }}" hidden></marimo-user-config>
    <marimo-server-token data-token="{{ server_token }}" hidden></marimo-server-token>
    <!-- /TODO -->
    <title>my analysis</title>
    <script type="module" crossorigin crossorigin="anonymous" src="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/index-CD6Gw4UH.js"></script>
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/preload-helper-D2MJg03u.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/clsx-D8GwTfvk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/cn-BKtXLv3a.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/chunk-LvLJmgfZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/react-Bj1aDYRI.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/compiler-runtime-B3qBwwSJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/jsx-runtime-ZmTK25f3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/badge-DX6CQ6PA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/hotkeys-BHHWjLlp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useEventListener-Cb-RVVEn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/button-CZ3Cs4qb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/react-dom-CSu739Rf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/Combination-BAEdC-rz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/menu-items-BMjcEb2j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-DwV58Fb1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/createLucideIcon-BCdY6lG5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/check-Dr3SxUsb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/x-ZP5cObgf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/select-BVdzZKAh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/tooltip-CMQz28hC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/use-toast-BDYuj3zG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/_Uint8Array-BGESiCQL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/_baseIsEqual-B9N9Mw_N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useEvent-BhXAndur.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/invariant-CAG_dYON.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/_baseFor-Duhs3RiJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/merge-BBX6ug-N.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/zod-H_cgTO0M.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/utils-YqBXNpsM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/Deferred-DxQeE5uh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/uuid-DXdzqzcr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/DeferredRequestRegistry-CMf25YiV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/constants-B6Cb__3x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/session-BOFn9QrD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/config-Q0O7_stz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/requests-B4FYHTZl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/isSymbol-BGkTcW3U.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/toString-DlRqgfqz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/_hasUnicode-CWqKLxBC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/assertNever-CBU83Y6o.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/_arrayReduce-TT0iOGKY.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useLifecycle-ClI_npeg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useNonce-CS26E0hA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useTheme-DQozhcp1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/once-Bul8mtFs.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/capabilities-MM7JYRxj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/createReducer-B3rBsy4P.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/paths-BzSgteR-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-DBwNzi3C.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-ChS0Dc_R.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-CtsanegT.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-Dcqqg9UU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-sMh6mJ2d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-Btv5Rh1v.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-bBwmhqty.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-CoCQUAeM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-Gqv0jSNr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/stex-jWatZkll.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/toDate-DETS9bBd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/cjs-CH5Rj0g8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/_baseProperty-NKyJO2oh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/now-6sUe0ZdD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/debounce-B3mjKxHe.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/toInteger-CDcO32Gx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/database-zap-k4ePIFAU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/main-U5Goe76G.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/cells-DPp5cDaO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/spinner-DA8-7wQv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/chevron-right--18M_6o9.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dropdown-menu-ldcmQvIV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/kbd-Cm6Ba9qg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/renderShortcut-BckyRbYt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/multi-map-DxdLNTBd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/alert-BOoN6gJ1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/card-OlSjYhmd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/alert-dialog-BW4srmS0.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dialog-eb-NieZw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dist-CDXJRSCj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/label-E64zk6_7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useDebounce-7iEVSqwM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/textarea-CRI7xDBj.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/numbers-D7O23mOZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/SSRProvider-BIDQNg9Q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/context-BfYAMNLF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useNumberFormatter-Db6Vjve5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/usePress-C__vuri5.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/input-DUrq2DiR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/links-7AQBmdyV.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/popover-CH1FzjxU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/switch-dWLWbbtg.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/table-DScsXgJW.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/mode-Bn7pdJvO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useAsyncData-BMGLSTg8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/errors-TZBmrJmc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/error-banner-B9ts0mNl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/copy-DHrHayPa.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/memoize-BCOZVFBt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/get-6uJrSKbw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/capitalize-CmNnkG9y.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/copy-D-8y6iMN.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/plus-B7DF33lD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/refresh-cw-Dx8TEWFP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/trash-2-DDsWrxuJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/triangle-alert-CebQ7XwA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/ai-model-dropdown-Dk2SdB3C.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/defaultLocale-JieDVWC_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/precisionRound-CU2C3Vxx.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/defaultLocale-BLne0bXb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/vega-loader.browser-DXARUlxo.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/tooltip-DxKBXCGp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/ErrorBoundary-B9Ifj8Jf.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useInstallPackage-D4fX0Ee_.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/ImperativeModal-BNN1HA7x.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/cell-link-B9b7J8QK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/datasource-CtyqtITR.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/state-D4T75eZb.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/MarimoErrorOutput-Lf9P8Fhl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/copy-icon-v8ME_JKB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/html-to-image-CIQqSu-S.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/focus-C1YokgL7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/LazyAnyLanguageCodeMirror-DgZ8iknE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/chunk-5FQGJX7Z-DPlx2kjA.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/katex-CDLTCvjQ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/markdown-renderer-DJy8ww5d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/command-2ElA5IkO.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/download-os8QlW6l.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useRunCells-D2HBb4DB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/purify.es-DZrAQFIu.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/RenderHTML-D-of_-s7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useIframeCapabilities-B_pQb20b.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/formats-CobRswjh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/en-US-CCVfmA-q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/isValid-DDt9wNjK.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/dates-CrvjILe3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/maps-D2_Mq1pZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/extends-BiFDv3jB.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/emotion-is-prop-valid.esm-C59xfSYt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useDateFormatter-CqhdUl2n.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/range-D2UKkEg-.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/table-CfDbAm78.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/JsonOutput-PE5ko4gi.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useDeleteCell-DdRX94yC.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/icons-CCHmxi8d.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/process-output-ByfLnk6j.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/blob-D-eV0cU3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/objectWithoutPropertiesLoose-DfWeGRFv.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/esm-Bmu2DhPy.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/file-Ch78NKWp.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/play-GLWQQs7F.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/add-cell-with-ai-e_HMl7UU.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/isEmpty-CgX_-6Mt.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/bot-message-square-B2ThzDUZ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/chat-display--jAB7huF.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/chart-no-axes-column-qvVRjhv1.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/square-function-B6mgCeFJ.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/spec-Ch0xnJY4.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/column-preview-CXjSXUhP.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/toggle-zVW4FXNz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/globals-BgACvYmr.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/share-ipf2hrOh.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/_baseSet-5Rdwpmr3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/react-resizable-panels.browser.esm-Da3ksQXL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/utilities.esm-dm9SQStE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/floating-outline-BtdqbkUq.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useAddCell-CmuX2hOk.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/eye-off-AK_9uodG.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/readonly-python-code-WjTf6Pdd.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/file-video-camera-C3wGzBnE.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/types-BRfQN3HL.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/refresh-ccw-DN_xCV6A.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/form-BidPUZUn.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/field-CySaBlkz.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useBoolean-Ck_unDZw.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/useDeepCompareMemoize-5OUgerQ3.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/types-C1UhS3qM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/prop-types-DaaA-ptl.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/es-BYgU_srD.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/hasIn-CycJImp8.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/_baseFlatten-CUZNxU8H.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/flatten-D-7VEN0q.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/pick-B_6Qi5aM.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/code-xml-CgN_Yig7.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/download-Dg7clfkc.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/square-CuJ72M8f.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/settings-OBbrbhij.js">
    <link rel="modulepreload" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/bundle.esm-i_UbZC0w.js">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/cells-jmgGt1lS.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/markdown-renderer-DdDKmWlR.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/JsonOutput-B7vuddcd.css">
    <link rel="stylesheet" crossorigin crossorigin="anonymous" href="https://cdn.jsdelivr.net/npm/@marimo-team/frontend@0.19.9/dist/assets/index-CeUwN_0i.css">
  
<script data-marimo="true">
    window.__MARIMO_STATIC__ = {};
    window.__MARIMO_STATIC__.files = {};
</script>
</head>
  <body>
    <div id="root"></div>
    <!-- This is a portal for the data editor to render in -->
    <div id="portal" data-testid="glide-portal" style="position: fixed; left: 0; top: 0; z-index: 9999"></div>
    <script data-marimo="true">
      window.__MARIMO_MOUNT_CONFIG__ = {
            "filename": "my_analysis.py",
            "mode": "read",
            "version": "0.19.9",
            "serverToken": "static",
            "config": {"ai": {"custom_providers": {}, "models": {"custom_models": [], "displayed_models": []}}, "completion": {"activate_on_typing": true, "copilot": false, "signature_hint_on_typing": false}, "diagnostics": {"sql_linter": true}, "display": {"cell_output": "below", "code_editor_font_size": 14, "dataframes": "rich", "default_table_max_columns": 50, "default_table_page_size": 10, "default_width": "medium", "reference_highlighting": true, "theme": "light"}, "formatting": {"line_length": 79}, "keymap": {"overrides": {}, "preset": "default"}, "language_servers": {"pylsp": {"enable_flake8": false, "enable_mypy": true, "enable_pydocstyle": false, "enable_pyflakes": false, "enable_pylint": false, "enable_ruff": true, "enabled": false}}, "mcp": {"mcpServers": {}, "presets": []}, "package_management": {"manager": "uv"}, "runtime": {"auto_instantiate": false, "auto_reload": "off", "default_csv_encoding": "utf-8", "default_sql_output": "auto", "on_cell_change": "autorun", "output_max_bytes": 8000000, "reactive_tests": true, "std_stream_max_bytes": 1000000, "watcher_on_save": "lazy"}, "save": {"autosave": "after_delay", "autosave_delay": 1000, "format_on_save": false}, "server": {"browser": "default", "follow_symlink": false}, "snippets": {"custom_paths": [], "include_default_snippets": true}},
            "configOverrides": {},
            "appConfig": {"auto_download": ["html"], "sql_output": "auto", "width": "medium"},
            "view": {"showAppCode": true},
            "notebook": {"cells": [{"code": "import marimo as mo\nimport ibis\nimport ibis.selectors as s\nfrom ibis import _\nimport simpy\nimport random\nimport numpy as np\nimport pandas as pd\nimport matplotlib.pyplot as plt\nfrom vidigi.resources import VidigiStore\nfrom vidigi.logging import EventLogger\nfrom vidigi.utils import EventPosition, create_event_position_df\nfrom vidigi.animation import animate_activity_log\nimport re\nfrom scipy import stats\n\n# Set options\nibis.options.interactive = True\npd.set_option(\"display.max_columns\", None)", "code_hash": "87efece48dfb19cf06a9d18fb10d361d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hbol", "name": "_"}, {"code": "PHI_COLS = ['event_id', 'pat_enc_csn_id', 'pat_id']\n", "code_hash": "ef8d1869416d7f216780003b0fd1fcb0", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "hyLk", "name": "_"}, {"code": "def to_snake(name: str) -\u003E str:\n    name = name.strip()\n    name = re.sub(r\"[ \\-]+\", \"_\", name)\n    name = re.sub(r\"(.)([A-Z][a-z]+)\", r\"\\1_\\2\", name)\n    name = re.sub(r\"([a-z0-9])([A-Z])\", r\"\\1_\\2\", name)\n    name = re.sub(r\"_+\", \"_\", name)\n    return name.lower()\n\n# Load data\ndf = pd.read_csv('JCHI_ADT Extract_Event Dates CY2025.csv')\n\n# convert columns to all snake case\ndf.columns = [to_snake(c) for c in df.columns]\n\n# Convert time and sort\ndf[\"effective_time\"] = pd.to_datetime(df[\"effective_time\"])\ndf = df.sort_values(\n    by=[\n        \"pat_enc_csn_id\",\n        \"effective_time\",\n        \"seq_num_in_enc\",\n        \"event_id\",\n    ]\n)\n\n# Show result\ndf.loc[:, ~df.columns.isin(['event_id', 'pat_enc_csn_id', 'pat_id'])]", "code_hash": "22f19dcba87b7647b0c25024ccc09459", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "MJUe", "name": "_"}, {"code": "mo.md(r\"\"\"\nGoal: to understand all of the columns, their data types, and events in each column.\n\"\"\")", "code_hash": "65e5ea28945eb2c9058e39ffa939ddeb", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vblA", "name": "_"}, {"code": "# Display all columns and their data types\ndf.dtypes", "code_hash": "444f29f70b8fd840f406e8894fb2bea9", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bkHC", "name": "_"}, {"code": "mo.md(\"\"\"\n# Column Definitions - JCHI ADT Data\n\n## Patient Identifiers\n- **pat_id** - Patient medical record number (same person across multiple visits)\n- **pat_enc_csn_id** - Patient encounter ID (one unique hospital visit)\n\n## Event Information\n- **event_id** - Unique ID for this event record\n- **event_type** - What happened: Admission, Transfer In, Transfer Out, Discharge, Census, Patient Update\n- **event_type_c** - Numeric code for event_type\n- **effective_time** - When this event occurred\n- **seq_num_in_enc** - Order number of events within this encounter (1, 2, 3...)\n\n## Transfer Tracking\n- **linked_transfer_in_event_id** - Links to the \"transfer in\" event_id\n- **linked_transfer_out_event_id** - Links to the \"transfer out\" event_id\n- **transfer_type** - Why patient transferred (ED to Inpatient, Trauma, STEMI, etc.)\n\n## Location Information\n- **department_id** - Department ID number\n- **department_name** - Name of department/unit (e.g., \"LJ EMERGENCY DEPT\", \"HC 2-SICU\")\n- **department_group** - Care level grouping (MedSurg, ICU, PCU, OB, etc.)\n- **location** - Specific location description\n- **room_id** / **room_csn_id** / **room** - Room identifiers and name\n- **bed_id** / **bed_csn_id** / **bed** - Bed identifiers and name\n\n## Patient Classification\n- **base_patient_class** - Simplified: Emergency, Inpatient, or Outpatient\n- **base_pat_class_c** - Numeric code for base_patient_class\n- **patient_class** - Detailed class (e.g., \"Inpatient Admission\", \"Emergency Department - Encounter\")\n- **pat_class_c** - Numeric code for patient_class\n- **patient_levelof_care** - Level of care needed (text)\n- **pat_lvl_of_care_c** - Level of care code (numeric)\n\n## Clinical Service\n- **hospital_service** - Which clinical team (Emergency Medicine, Cardiology, Trauma Surgery, etc.)\n- **pat_service_c** - Numeric code for hospital_service\n\n## Bed Request Tracking (often empty)\n- **pend_id** - Pending bed request ID\n- **bed_request_created_dttm** - When bed was requested\n- **bed_request_first_readyto_plan_dttm** - Ready for bed planning\n- **bed_request_first_preassigned_dttm** - Bed pre-assigned\n- **bed_request_first_assigned_dttm** - Bed officially assigned\n- **bed_request_first_bed_ready_dttm** - Bed physically ready\n- **bed_request_first_readyto_move_dttm** - Patient ready to move\n\n## Other\n- **tc_admit_flag** - Flag indicating admission event\n- **referring_location** - Where patient was referred from\n\n---\n\n**Total: 37 columns**\n\"\"\")", "code_hash": "a6e440820df4b2704a5141b4fd641248", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lEQa", "name": "_"}, {"code": "# Look at first few rows with all columns visible\ndf.head(10)", "code_hash": "d5bc9105a20fdcfddc10fa3c56caaa21", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PKri", "name": "_"}, {"code": "# Event types, what kinds of events do we have?\nprint(\"Unique Event Types:\")\nprint(df['event_type'].value_counts())\nprint(f\"\\nTotal unique event types: {df['event_type'].nunique()}\")", "code_hash": "7de05d7bf75c924abf689585a7de6670", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Xref", "name": "_"}, {"code": "mo.md(\"\"\"\n## Why are there way more discharges than admissions?\n\nLooking at event types:\n- Admissions: 229,440\n- Discharges: 983,931\n\nThat's 4-5x more discharges than admissions, which doesn't make sense. You can't discharge more people than you admit.\n\nWhat's probably happening:\n- \"Discharge\" might include ED patients who go home without being admitted\n- Outpatient visits that end also get counted as discharges\n- We need to check if this is true\n\nLet's look at what patient classes are getting \"discharged\" vs \"admitted\" to figure out what's actually going on.\n\"\"\")", "code_hash": "234640b03d354471cafd848379dd84cf", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SFPL", "name": "_"}, {"code": "# What patient classes have Discharge events?\ndischarge_events = df[df['event_type'] == 'Discharge']\ndischarge_classes = discharge_events['patient_class'].value_counts()\nprint(\"Discharges by Patient Class:\")\nprint(f\"Total unique classes: {len(discharge_classes)}\\n\")\nfor class_name, class_count in discharge_classes.items():\n    print(f\"{class_name}: {class_count:,}\")", "code_hash": "82a36d5312014b551c0f8778fdea5d89", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "BYtC", "name": "_"}, {"code": "# What about Admissions?\nadmission_events = df[df['event_type'] == 'Admission']\nadmission_classes = admission_events['patient_class'].value_counts()\nprint(\"Admissions by Patient Class:\")\nprint(f\"Total unique classes: {len(admission_classes)}\\n\")\nfor admit_class, admit_count in admission_classes.items():\n    print(f\"{admit_class}: {admit_count:,}\")", "code_hash": "df0d06073bc51889cad1a8c620ff7752", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RGSE", "name": "_"}, {"code": "mo.md(\"\"\"\nMost \"Discharges\" are outpatients. Looking at the discharge and admission breakdown by patient class, we found that the majority of the 983K discharges are from outpatient visits - people coming in for radiology, infusion therapy, procedures, clinic visits, etc. They come in, get their service, and leave the same day, which gets recorded as a \"discharge\" even though they were never \"admitted\" in the traditional sense. This explains why there are way more discharges than admissions overall. However, there are still weird discrepancies even within inpatient and ED encounters - for example, 38K inpatient discharges but only 3K inpatient admissions. This suggests there might be data quality issues like duplicate discharge records, missing admission records, or the event types mean something different than we expect. We need to investigate these discrepancies before we can reliably model patient flow.\n\"\"\")", "code_hash": "f49686560193988658b73ba20942f15a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Kclp", "name": "_"}, {"code": "events_per_encounter", "code_hash": "5a14694578e4b4f6f917bc1066491a5d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "OfAd", "name": "_"}, {"code": "# Checking - how many events per encounter?\nevents_per_encounter = df.groupby('pat_enc_csn_id')['event_type'].value_counts().unstack(fill_value=0)\nprint(\"Sample of events per encounter (first 10):\")\nprint(events_per_encounter.reset_index().loc[:, ~events_per_encounter.reset_index().columns.isin(PHI_COLS)].head(10))\nprint(\"\\nSummary stats:\")\nprint(events_per_encounter.describe())", "code_hash": "71ac4e8940e987afa48e59ae58d6f033", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "emfo", "name": "_"}, {"code": "# Checking - do encounters have multiple discharges?\ndischarges_per_encounter = df[df['event_type'] == 'Discharge'].groupby('pat_enc_csn_id').size()\nprint(f\"Encounters with discharges: {len(discharges_per_encounter):,}\")\nprint(f\"Encounters with \u003E1 discharge: {(discharges_per_encounter \u003E 1).sum():,}\")\nprint(f\"\\nMax discharges in one encounter: {discharges_per_encounter.max()}\")", "code_hash": "f02a9793cd6a458341c5dd9e61d01468", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Hstk", "name": "_"}, {"code": "# Checking - do encounters have multiple admissions?\nadmissions_per_encounter = df[df['event_type'] == 'Admission'].groupby('pat_enc_csn_id').size()\nprint(f\"Encounters with admissions: {len(admissions_per_encounter):,}\")\nprint(f\"Encounters with \u003E1 admission: {(admissions_per_encounter \u003E 1).sum():,}\")\nprint(f\"\\nMax admissions in one encounter: {admissions_per_encounter.max()}\")", "code_hash": "26ef0c3693706e8b2c201b884014f675", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nWHF", "name": "_"}, {"code": "mo.md(\"\"\"\nNo duplicate events, but not all encounters have admissions. We discovered that each encounter has exactly 1 discharge, no duplicates, clean data. Each encounter has exactly 1 admission (when it has one) - no duplicates, clean data. BUT only 23% of encounters have an \"Admission\" event - this is the key!\n\nLooking at the summary stats:\n\n- Mean discharges per encounter: 0.999 (almost everyone)\n- Mean admissions per encounter: 0.233 (only 23%!)\n- This explains why 983K discharges vs 229K admissions\n\nWhat does this mean? Basically, outpatient visits get a \"Discharge\" when they leave, but never had an \"Admission\". ED visits that go home \"Discharge\" from ED without hospital \"Admission\". True inpatient stays should have both \"Admission\" AND \"Discharge\".\n\nSome wild outliers:\n\n- One encounter has 364 Census events (daily snapshots over a year)\n- One encounter has 68 transfers!\n\nThe issue is that \"Admission\" and \"Discharge\" as event types mean different things depending on the encounter type.\n\nFor our patient flow model, we don't need to worry about these administrative labels. Instead, we need to focus on the Transfer events which show actual physical movement between units. Let's look at what transfer patterns exist in the data.\n\"\"\")", "code_hash": "75e607c070b1e42a60713bfd4b1a7d80", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "iLit", "name": "_"}, {"code": "# Patient classes, what types of patients?\nprint(\"Unique Patient Classes:\")\nall_patient_classes = df['patient_class'].value_counts()\nprint(f\"Total unique patient classes: {len(all_patient_classes)}\")\nfor patient_class, count in all_patient_classes.items():\n    print(f\"{patient_class}: {count:,}\")", "code_hash": "a90d6c6468c7c7aa13961355268ecd13", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZHCJ", "name": "_"}, {"code": "# Department names, where are patients located?\nall_departments = df['department_name'].value_counts()\nprint(f\"Total unique departments: {len(all_departments)}\")\nfor dept_name, dept_count in all_departments.items():\n    print(f\"{dept_name}: {dept_count:,}\")", "code_hash": "ba72406502acb2ad95be6bfce254f396", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ROlb", "name": "_"}, {"code": "# Department groups, what are the higher level groupings?\nprint(\"Unique Department Groupings:\")\nprint(df['department_group'].value_counts())\nprint(f\"\\nTotal unique department groups: {df['department_group'].nunique()}\")", "code_hash": "666138ac22488079556b53d52c777832", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "qnkX", "name": "_"}, {"code": "# Hospital services, what service lines?\nall_services = df['hospital_service'].value_counts()\nprint(f\"Total unique hospital services: {len(all_services)}\")\nfor service_name, service_count in all_services.items():\n    print(f\"{service_name}: {service_count:,}\")", "code_hash": "884e2db34551e05eb90c27b1eed10c4f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TqIu", "name": "_"}, {"code": "# Transfer types\nall_transfer_types = df['transfer_type'].value_counts()\nprint(f\"Total unique transfer types: {len(all_transfer_types)}\")\nfor transfer_name, transfer_count in all_transfer_types.items():\n    print(f\"{transfer_name}: {transfer_count:,}\")", "code_hash": "c4c5d25fee7e80abeac56583a19e84be", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Vxnm", "name": "_"}, {"code": "# Look at transfers between department_groups (the tiers)\ntransfer_data = df[df['event_type'].isin(['Transfer In', 'Transfer Out'])]\n\n# What tiers do patients transfer between?\nprint(\"Transfers by department group:\")\nprint(transfer_data['department_group'].value_counts())", "code_hash": "aa3c363f6e423e411b9a50c7b8a6c1d6", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "DnEU", "name": "_"}, {"code": "# Base patient class\nprint(\"Unique Base Patient Classes:\")\nprint(df['base_patient_class'].value_counts())\nprint(f\"\\nTotal unique base patient classes: {df['base_patient_class'].nunique()}\")", "code_hash": "e11336cdaca7c42e9addf0e72efd5abf", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ulZA", "name": "_"}, {"code": "# Do patients change class during an encounter?\nclass_changes = df.groupby('pat_enc_csn_id')['patient_class'].nunique()\nprint(f\"Encounters with class changes: {(class_changes \u003E 1).sum():,}\")\nprint(f\"Total encounters: {df['pat_enc_csn_id'].nunique():,}\")", "code_hash": "aec438bd62b85b58b26b5ca127e8119d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ecfG", "name": "_"}, {"code": "mo.md(\"\"\"\nLooking at the transfer data, we can see clear patterns of patient movement:\n\n**Transfer Types:**\n- Inpatient to Inpatient: 26,139 (most common - patients moving between units)\n- ED to Inpatient: 16,344 (patients getting admitted from ED)\n- ED to ED: 14,184 (transfers between emergency departments)\n- Trauma: 11,336 (trauma activations)\n- Specialty transfers: ECMO, Stroke, STEMI, Transplant, Burn (time-sensitive care)\n\n**Transfer Activity by Tier:**\n- OB: 50,241 transfers (obstetrics - lots of movement)\n- MedSurg: 34,207 (general medical/surgical floors - Tier 2)\n- PCU: 27,195 (progressive care - Tier 2)\n- ICU: 24,187 (intensive care - Tier 3)\n- IMU: 16,756 (intermediate medical - Tier 2)\n- NICU: 3,658 (neonatal intensive care - Tier 3)\n\nWe have good transfer data across all three tiers. The transfer events will let us build a transition matrix showing how patients move between ED, regular floors, and ICU across the different hospitals.\n\nNext step is to filter the data to focus on encounters with actual patient flow (those with transfers), then build the transition matrix.\n\"\"\")", "code_hash": "0662983f0e930a744b90a7fa110763e4", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "Pvdt", "name": "_"}, {"code": "# How many events does each encounter have?\nencounter_event_counts = df.groupby('pat_enc_csn_id').size()\n\nprint(\"Events per encounter:\")\nprint(f\"Min: {encounter_event_counts.min()}\")\nprint(f\"Max: {encounter_event_counts.max()}\")\nprint(f\"Mean: {encounter_event_counts.mean():.2f}\")\nprint(f\"Median: {encounter_event_counts.median():.0f}\")\nprint(f\"\\nEncounters with only 1 event: {(encounter_event_counts == 1).sum():,}\")\nprint(f\"Percentage: {(encounter_event_counts == 1).sum() / len(encounter_event_counts) * 100:.1f}%\")", "code_hash": "3e6ea9bf0a4891ad9cf2a1ded2e33d4e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "ZBYS", "name": "_"}, {"code": "# Check encounters with NO transfers (arrive and leave only)\nencounters_with_transfers = df[df['event_type'].isin(['Transfer In', 'Transfer Out'])]['pat_enc_csn_id'].unique()\ntotal_encounters = df['pat_enc_csn_id'].nunique()\nno_transfer_encounters = total_encounters - len(encounters_with_transfers)\n\nprint(f\"Total encounters: {total_encounters:,}\")\nprint(f\"Encounters WITH transfers: {len(encounters_with_transfers):,}\")\nprint(f\"Encounters WITHOUT transfers: {no_transfer_encounters:,}\")\nprint(f\"Percentage without transfers: {no_transfer_encounters / total_encounters * 100:.1f}%\")", "code_hash": "8060a46acad1be98e9980805c5ae16eb", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "aLJB", "name": "_"}, {"code": "# What are these single-event encounters?\nsingle_event_encounters = df[df['pat_enc_csn_id'].isin(events_per_encounter[events_per_encounter == 1].index)]\nprint(\"Single event encounters by event type:\")\nprint(single_event_encounters['event_type'].value_counts())\nprint(\"\\nSingle event encounters by patient class:\")\nprint(single_event_encounters['patient_class'].value_counts().head(10))", "code_hash": "1ae03d821a483388f54946037b79104f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "nHfw", "name": "_"}, {"code": "# Check linked Transfer Out \u2192 Transfer In pairs\n# Use linked_transfer_out_event_id to connect them\n\n# Get Transfer Out events with their department\ntransfer_out = df[df['event_type'] == 'Transfer Out'][['event_id', 'pat_enc_csn_id', 'department_name', 'department_group', 'effective_time']]\ntransfer_out = transfer_out.rename(columns={'event_id': 'transfer_out_id', 'department_name': 'from_dept', 'department_group': 'from_group', 'effective_time': 'out_time'})\n\n# Get Transfer In events with their department\ntransfer_in = df[df['event_type'] == 'Transfer In'][['event_id', 'pat_enc_csn_id', 'department_name', 'department_group', 'effective_time', 'linked_transfer_out_event_id']]\ntransfer_in = transfer_in.rename(columns={'department_name': 'to_dept', 'department_group': 'to_group', 'effective_time': 'in_time'})\n\n# Merge them\ntransfers = transfer_in.merge(transfer_out, left_on='linked_transfer_out_event_id', right_on='transfer_out_id', suffixes=('', '_out'))\n\nprint(f\"Total linked transfers: {len(transfers):,}\")\nprint(f\"\\nTransfers within SAME department: {(transfers['from_dept'] == transfers['to_dept']).sum():,}\")\nprint(f\"Transfers to DIFFERENT department: {(transfers['from_dept'] != transfers['to_dept']).sum():,}\")", "code_hash": "758484c0ac92c2de9bc6f2acd85923ec", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "xXTn", "name": "_"}, {"code": "mo.md(\"\"\"\nIssue 1: Most encounters have only 1 event (76.6%)\n- These are mostly outpatient visits (radiology, infusion, procedures)\n- Also ED visits that discharge home\n- They have 1 event and leave - no patient flow to model, at least for right now while we build the simple model.\n\nIssue 2: 91.5% of encounters have NO transfers\n- Only 83,423 encounters (8.5%) actually have transfer events between units\n- BUT this doesn't mean the other 91.5% are irrelevant!\n- Many are still valid patient flow: ED \u2192 Discharge, ICU \u2192 Discharge (these are important transitions)\n- The real question is what TYPE of encounters to include (ED/ICU/Floor vs Outpatient), not whether they have transfers\n- We'll decide which encounter types to keep after looking at the data more carefully\n\nIssue 3: Same Department Bed Changes\n- Out of 207,300 total transfers:\n  - 82,058 (40%) are within the SAME department - just bed changes!\n  - 125,242 (60%) are to DIFFERENT departments - actual patient flow!\n  - We need to filter these out.\n\nWhat This Means for Data Cleaning:\n\n1. Filter by encounter TYPE (keep ED/ICU/Floor, remove outpatient), not by whether they have transfers\n2. Only use transfers to DIFFERENT departments (125,242 transfers)\n3. Ignore same-department bed shuffles (82,058 transfers)\n\nThis will give us clean patient flow data for the transition matrix.\n\"\"\")", "code_hash": "0c75468c71b0608a26cca1f47e394215", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "AjVT", "name": "_"}, {"code": "mo.md(\"\"\"\nWhat Encounters Do We Have?\n\nBefore filtering, let's see all the encounter types and decide which ones are relevant for ED \u2192 Floor \u2192 ICU flow modeling.\n\"\"\")", "code_hash": "ea12cb960b86dbaa09f65c432622c089", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "pHFh", "name": "_"}, {"code": "# Look at combinations of patient_class and department_group\nencounter_summary = df.groupby(['patient_class', 'department_group']).size().reset_index(name='count')\nencounter_summary = encounter_summary.sort_values('count', ascending=False)\n\nprint(\"Patient Class + Department Group combinations:\")\nprint(encounter_summary.to_string(index=False))", "code_hash": "5d8170c31e578946d9e53a1f546ecde1", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "NCOB", "name": "_"}, {"code": "# Also - which patient classes appear in ED, ICU, MedSurg?\ned_classes = df[df['department_name'].str.contains('EMERGENCY', na=False)]['patient_class'].value_counts()\nprint(\"\\nPatient classes in ED:\")\nprint(ed_classes)", "code_hash": "d6062f341bc1ee5a3c472b5fdb456f80", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "aqbW", "name": "_"}, {"code": "icu_classes = df[df['department_group'] == 'ICU']['patient_class'].value_counts()\nprint(\"\\nPatient classes in ICU:\")\nprint(icu_classes)", "code_hash": "b4b48e3e9350a589a02eebb3105cbe03", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TRpd", "name": "_"}, {"code": "floor_classes = df[df['department_group'].isin(['MedSurg', 'PCU', 'IMU'])]['patient_class'].value_counts()\nprint(\"\\nPatient classes on Floors (MedSurg/PCU/IMU):\")\nprint(floor_classes)", "code_hash": "e8df0678e165ab8ddecb7f3132b1de0f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TXez", "name": "_"}, {"code": "mo.md(\"\"\"\n## Data Filtering Plan: What We Are Keeping vs Removing and Why\n\nKeeping patients who occupy beds and can move between units:\n- Inpatient Admission\n- Emergency Department - Encounter\n- Trauma Inpatient Admission\n- Observation\n- Trauma Observation Admission\n- Hospital Inpatient Surgery\n- Inpatient Psychiatry\n- Newborn\n- Surgical OB Patient\n- Outpatient in a Bed (they're in ICU/MedSurg/PCU - physical beds!)\n- Outpatient Labor and Delivery - Encounter (in OB units)\n\nRemoving same-day outpatient services (no bed, no movement):\n- Outpatient Radiology - Encounter\n- Outpatient Infusion - Encounter\n- Outpatient Radiation Oncology - Series\n- Hospital Outpatient Procedure\n- Hospital Outpatient Surgery\n- Outpatient Clinic Visit - Encounter\n- Outpatient Physical Therapy - Series\n- Outpatient Other - Encounter\n- Lab Referred Specimen\n- Telemedicine - Encounter\n- All other \"Outpatient [service] - Series/Encounter\"\n- Trauma Outpatient (unless in a bed)\n\nThis will give us clean patient flow data for the 9\u00d710 transition matrix.\n\"\"\")", "code_hash": "22ff1655aae2e4503b8f36694a40f9b4", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "dNNg", "name": "_"}, {"code": "# Filter by patient_class to identify which encounters involve physical bed occupancy in hospital units\n# Does this patient_class represent someone who occupies a physical bed in a hospital unit (ED/Floor/ICU) and could potentially transfer between units?\nkeep_classes = [\n    'Inpatient Admission',\n    'Emergency Department - Encounter',\n    'Trauma Inpatient Admission',\n    'Observation',\n    'Trauma Observation Admission',\n    'Hospital Inpatient Surgery',\n    'Inpatient Psychiatry',\n    'Newborn',\n    'Surgical OB Patient',\n    'Outpatient in a Bed',\n    'Outpatient Labor and Delivery - Encounter'\n]\n\n# Filter the data\ndf_filtered = df[df['patient_class'].isin(keep_classes)].copy()\n\nprint(f\"Original data: {len(df):,} rows, {df['pat_enc_csn_id'].nunique():,} encounters\")\nprint(f\"Filtered data: {len(df_filtered):,} rows, {df_filtered['pat_enc_csn_id'].nunique():,} encounters\")\nprint(f\"Removed: {len(df) - len(df_filtered):,} rows ({(len(df) - len(df_filtered))/len(df)*100:.1f}%)\")", "code_hash": "5eb214e5ef25128a3a3a24cc8fb07f0b", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "yCnT", "name": "_"}, {"code": "# What patient classes did we REMOVE?\ndata_removed = df[~df['patient_class'].isin(keep_classes)]\nclasses_removed = data_removed['patient_class'].value_counts()\nprint(\"Removed Patient Classes:\")\nprint(f\"Total classes removed: {len(classes_removed)}\\n\")\nfor removed_class_name, removed_class_count in classes_removed.items():\n    print(f\"{removed_class_name}: {removed_class_count:,}\")", "code_hash": "4991d0f9d735457aff1bb0c2be1ea725", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "wlCL", "name": "_"}, {"code": "# What patient classes did we KEEP?\nprint(\"\\nKept Patient Classes:\")\nprint(df_filtered['patient_class'].value_counts())", "code_hash": "c787e4c240b9cc4235a31b1bda1903c5", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "kqZH", "name": "_"}, {"code": "# Check: Do filtered encounters have transfers?\nfiltered_encounters_with_transfers = df_filtered[df_filtered['event_type'].isin(['Transfer In', 'Transfer Out'])]['pat_enc_csn_id'].nunique()\nprint(f\"\\nFiltered encounters: {df_filtered['pat_enc_csn_id'].nunique():,}\")\nprint(f\"Filtered encounters with transfers: {filtered_encounters_with_transfers:,}\")\nprint(f\"Percentage with transfers: {filtered_encounters_with_transfers / df_filtered['pat_enc_csn_id'].nunique() * 100:.1f}%\")", "code_hash": "cae27eeb5c8ee31caf7afede0d01c209", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "wAgl", "name": "_"}, {"code": "# What department_groups remain?\nprint(\"\\nDepartment Groups in Filtered Data:\")\nprint(df_filtered['department_group'].value_counts())", "code_hash": "e8f95cfefc0cfaac56b7f007fd882165", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "rEll", "name": "_"}, {"code": "# How many filtered encounters have only 1 event?\nfiltered_events_per_encounter = df_filtered.groupby('pat_enc_csn_id').size()\n\nprint(\"Events per encounter in filtered data:\")\nprint(f\"Min: {filtered_events_per_encounter.min()}\")\nprint(f\"Mean: {filtered_events_per_encounter.mean():.2f}\")\nprint(f\"Median: {filtered_events_per_encounter.median():.0f}\")\nprint(f\"\\nEncounters with only 1 event: {(filtered_events_per_encounter == 1).sum():,}\")\nprint(f\"Percentage: {(filtered_events_per_encounter == 1).sum() / len(filtered_events_per_encounter) * 100:.1f}%\")", "code_hash": "a38f9262c644d291718799963fffd1c8", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "dGlV", "name": "_"}, {"code": "# What ARE these single-event filtered encounters?\nsingle_event_filtered = df_filtered[df_filtered['pat_enc_csn_id'].isin(\n    filtered_events_per_encounter[filtered_events_per_encounter == 1].index\n)]\n\nprint(\"\\nSingle Event Encounters (after filtering):\")\nprint(\"By event type:\")\nprint(single_event_filtered['event_type'].value_counts())\nprint(\"\\nBy patient class:\")\nprint(single_event_filtered['patient_class'].value_counts().head())\nprint(\"\\nBy department group:\")\nprint(single_event_filtered['department_group'].value_counts().head())", "code_hash": "13a7798ca37e4f4384bd947a02d3d234", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SdmI", "name": "_"}, {"code": "mo.md(r\"\"\"\nThese data quality checks looks good, the filter worked as intended. Now moving on to other data quality checks.\n\"\"\")", "code_hash": "dc32b07a74715cf565a7d5007aee2d58", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "lgWD", "name": "_"}, {"code": "# Missing critical fields\nprint(\"Missing Values in Key Fields:\")\nprint(f\"Missing effective_time: {df_filtered['effective_time'].isna().sum():,}\")\nprint(f\"Missing department_name: {df_filtered['department_name'].isna().sum():,}\")\nprint(f\"Missing department_group: {df_filtered['department_group'].isna().sum():,}\")\nprint(f\"Missing event_type: {df_filtered['event_type'].isna().sum():,}\")", "code_hash": "cc7744bea38f66f211c963c0787d4929", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "yOPj", "name": "_"}, {"code": "# Do all encounters have a discharge event?\nencounters_with_discharge = df_filtered[df_filtered['event_type'] == 'Discharge']['pat_enc_csn_id'].nunique()\ntotal_filtered_encounters = df_filtered['pat_enc_csn_id'].nunique()\n\nprint(f\"\\nDischarge Events:\")\nprint(f\"Total encounters: {total_filtered_encounters:,}\")\nprint(f\"Encounters with Discharge: {encounters_with_discharge:,}\")\nprint(f\"Encounters without Discharge: {total_filtered_encounters - encounters_with_discharge:,}\")\nprint(f\"Percentage missing discharge: {(total_filtered_encounters - encounters_with_discharge) / total_filtered_encounters * 100:.1f}%\")", "code_hash": "d50de6c40f59542f40ebf8eb851519bd", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "fwwy", "name": "_"}, {"code": "# Calculate rough LOS per encounter\nencounter_los = df_filtered.groupby('pat_enc_csn_id')['effective_time'].agg(['min', 'max'])\nencounter_los['los_days'] = (encounter_los['max'] - encounter_los['min']).dt.total_seconds() / 86400\n\nprint(f\"\\nLength of Stay Distribution:\")\nprint(encounter_los['los_days'].describe())\nprint(f\"Encounters with LOS \u003E 180 days: {(encounter_los['los_days'] \u003E 180).sum():,}\")", "code_hash": "0b4623bf778786f8780496b00db03759", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "LJZf", "name": "_"}, {"code": "# How many events do the LOS=0 encounters have?\nzero_los_encs = encounter_los[encounter_los['los_days'] == 0].index\nzero_los_events = df_filtered[df_filtered['pat_enc_csn_id'].isin(zero_los_encs)]\n\nprint(f\"Encounters with LOS=0: {len(zero_los_encs):,}\")\nprint(f\"\\nEvents per encounter for LOS=0:\")\nprint(zero_los_events.groupby('pat_enc_csn_id').size().value_counts().sort_index())\n\nprint(f\"\\nEvent types for LOS=0:\")\nprint(zero_los_events['event_type'].value_counts())\n\nprint(f\"\\nPatient class for LOS=0:\")\nprint(zero_los_events['patient_class'].value_counts().head(10))", "code_hash": "7a5314c853dd021f1524143753dfa3d4", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "urSm", "name": "_"}, {"code": "# Seeing what patient classes were in these encounters before filtering\norphan_in_original = df[df['pat_enc_csn_id'].isin(zero_los_encs)]\nprint(orphan_in_original.groupby('pat_enc_csn_id').size().describe())\nprint(orphan_in_original['patient_class'].value_counts().head(10))", "code_hash": "6664e603c146e7e36bb1ff307251e46e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "jxvo", "name": "_"}, {"code": "mo.md(r\"\"\"\n1,720 encounters (1.1% of 153,878) have only a single event in df_filtered, resulting in LOS = 0.\nThese are not filtering artifacts \u2014 they had only ~1 event in the original data too (mean 1.08).\nThey are incomplete records (orphan discharges, registration-only entries) and contribute no\ntransitions. Dropping them to keep only encounters with 2+ events.\n\"\"\")", "code_hash": "d9bf0a5cc3e88fbe7caf40116abf34d1", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "mWxS", "name": "_"}, {"code": "# Drop single-event encounters\nevent_counts = df_filtered.groupby('pat_enc_csn_id').size()\nmulti_event_encs = event_counts[event_counts \u003E 1].index\ndf_clean = df_filtered[df_filtered['pat_enc_csn_id'].isin(multi_event_encs)]\nprint(f\"Remaining encounters: {df_clean['pat_enc_csn_id'].nunique():,}\")\nprint(f\"Remaining events: {len(df_clean):,}\")", "code_hash": "ecd6e2284451cc0ed6778ed20b2475fd", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "CcZR", "name": "_"}, {"code": "# Events out of order?\n# Check if seq_num_in_enc matches chronological order\nsample_encounters = df_filtered.groupby('pat_enc_csn_id').filter(lambda x: len(x) \u003E 1).groupby('pat_enc_csn_id').head(20)\nsample = sample_encounters.groupby('pat_enc_csn_id').apply(\n    lambda x: (x.sort_values('effective_time')['seq_num_in_enc'].diff() \u003C 0).any()\n)\nprint(f\"\\nEvent Ordering:\")\nprint(f\"Encounters checked: {len(sample)}\")\nprint(f\"Encounters with seq_num out of order: {sample.sum()}\")", "code_hash": "088368f4b4b6f18e0cf1d29416ee1e18", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "YWSi", "name": "_"}, {"code": "# Do encounters have mutliple patient classes?\nencounters_with_multi_classes = df.groupby('pat_enc_csn_id')['patient_class'].nunique()\nprint(f\"Encounters with multiple patient classes (BEFORE filter): {(encounters_with_multi_classes \u003E 1).sum():,}\")\n\n# After filtering, do they still have multiple?\nfiltered_multi_classes = df_filtered.groupby('pat_enc_csn_id')['patient_class'].nunique()\nprint(f\"Encounters with multiple patient classes (AFTER filter): {(filtered_multi_classes \u003E 1).sum():,}\")", "code_hash": "a5f71284cf30491290a226b2d99d9649", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "zlud", "name": "_"}, {"code": "# Example of an encounter that has multiple patient classes\nsample_multi_class = df_filtered.groupby('pat_enc_csn_id').filter(lambda x: x['patient_class'].nunique() \u003E 1).groupby('pat_enc_csn_id').first().index[0]\n\nprint(f\"Example Encounter with Multiple Classes: {sample_multi_class}:\")\nsample_events = df_filtered[df_filtered['pat_enc_csn_id'] == sample_multi_class][\n    ['event_type', 'effective_time', 'patient_class', 'department_name', 'department_group', 'seq_num_in_enc']\n].sort_values('effective_time')\n\nprint(f\"\\nTotal events in this encounter: {len(sample_events)}\")\nprint(\"\\n\")\nfor idx, row in sample_events.iterrows():\n    print(f\"Event: {row['event_type']:15} | Time: {row['effective_time']} | Class: {row['patient_class']:30} | Dept: {row['department_name']:30} | Group: {row['department_group']}\")", "code_hash": "2e677d7d35641b6fda696ec8b1135552", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "tZnO", "name": "_"}, {"code": "mo.md(r\"\"\"\nLooking at encounters with multiple patient classes, we found that it's completely normal for patient_class to change during a hospital stay. For example, a patient might start as \"Hospital Inpatient Surgery\" in a perioperative area, then get updated to \"Inpatient Admission\" once they transfer to an actual inpatient unit. This explains why we have 40,731 encounters with multiple patient classes after filtering. The 556,863 missing department_group values are from events in perioperative areas, holding areas, recovery rooms, and other pre-admission locations that don't fit into the ED/Floor/ICU tier system. These aren't data errors - they're just areas we don't need to model. For the transition matrix, we'll only use events where department_group exists, which represents when patients are actually in one of our three tiers (ED, Floor, ICU).\n\"\"\")", "code_hash": "b0920a6532e1634e3d6408a1fa64f63e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "xvXZ", "name": "_"}, {"code": "# Check if timestamps are in proper chronological order\ntimestamp_order_issues = df_filtered.groupby('pat_enc_csn_id').apply(\n    lambda x: (x.sort_values('effective_time')['effective_time'].diff().dt.total_seconds() \u003C 0).any()\n)\n\nprint(f\"Encounters with timestamps going BACKWARDS: {timestamp_order_issues.sum()}\")", "code_hash": "a45fbd1ea13fead4ac2101d78df0b713", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "CLip", "name": "_"}, {"code": "# Find an encounter with seq_num issues\nencounters_multi_events = df_filtered.groupby('pat_enc_csn_id').filter(lambda x: len(x) \u003E 1)\nseq_check = encounters_multi_events.groupby('pat_enc_csn_id').apply(\n    lambda x: (x.sort_values('seq_num_in_enc')['effective_time'].diff().dt.total_seconds() \u003C 0).any()\n)\nproblem_encounter = seq_check[seq_check].index[0]\n\nprint(f\"Encounter with Sequencing Issue: {problem_encounter}:\\n\")", "code_hash": "f9b8f6b7c692f9e71981fbcfa2791937", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "YECM", "name": "_"}, {"code": "# Before filtering, all events from original data\nprint(\"Before Filtering (Original Data):\")\nbefore_filter = df[df['pat_enc_csn_id'] == problem_encounter][\n    ['seq_num_in_enc', 'effective_time', 'event_type', 'patient_class', 'department_name']\n].sort_values('seq_num_in_enc')\n\nfor before_idx, before_row in before_filter.iterrows():\n    print(f\"seq={before_row['seq_num_in_enc']:.0f} | {before_row['effective_time']} | {before_row['event_type']:15} | {before_row['patient_class'][:30]:30}\")", "code_hash": "8670bc02262e19b23e957486c8fa38f2", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "cEAS", "name": "_"}, {"code": "# After filtering, only kept events\nprint(\"\\n\\nAfter Filtering (Kept Events):\")\nafter_filter = df_filtered[df_filtered['pat_enc_csn_id'] == problem_encounter][\n    ['seq_num_in_enc', 'effective_time', 'event_type', 'patient_class', 'department_name']\n].sort_values('seq_num_in_enc')\n\nfor after_idx, after_row in after_filter.iterrows():\n    print(f\"seq={after_row['seq_num_in_enc']:.0f} | {after_row['effective_time']} | {after_row['event_type']:15} | {after_row['patient_class'][:30]:30}\")", "code_hash": "ec96cd3bbe97d3840a5bdaed81ccbf0f", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "iXej", "name": "_"}, {"code": "# How widespread is Nan problem in sequencing?\nnan_seq = df_filtered[df_filtered['seq_num_in_enc'].isna()]\nprint(f\"Total events with NaN seq_num: {len(nan_seq):,}\")\nprint(f\"Total encounters with at least one NaN seq: {nan_seq['pat_enc_csn_id'].nunique():,}\")\nprint(f\"Out of total encounters: {df_filtered['pat_enc_csn_id'].nunique():,}\")\nprint(f\"Percentage of encounters affected: {nan_seq['pat_enc_csn_id'].nunique() / df_filtered['pat_enc_csn_id'].nunique() * 100:.1f}%\")\n\nprint(\"\\n--- Event type breakdown for NaN seq events ---\")\nprint(nan_seq['event_type'].value_counts())\n\nprint(\"\\n--- Patient class breakdown for NaN seq events ---\")\nprint(nan_seq['patient_class'].value_counts().head(10))\n\nprint(\"\\n--- Department group breakdown for NaN seq events ---\")\nprint(nan_seq['department_group'].value_counts().head(10))\n\n# Looking at 5 example encounters\nnan_encs = nan_seq['pat_enc_csn_id'].unique()[:5]\n\nfor enc in nan_encs:\n    enc_data = df_filtered[df_filtered['pat_enc_csn_id'] == enc].sort_values('effective_time')\n    print(f\"\\n{'='*80}\")\n    print(f\"Encounter: {enc} ({len(enc_data)} events)\")\n    print(f\"{'='*80}\")\n    for _, r in enc_data.iterrows():\n        seq = r['seq_num_in_enc']\n        seq_str = f\"seq={int(seq)}\" if pd.notna(seq) else \"seq=NaN\"\n        print(f\"  {seq_str:\u003E10} | {r['effective_time']} | {str(r['event_type']):20s} | {str(r['patient_class']):30s} | {str(r['department_group'])}\")", "code_hash": "cbab6f595fd36e459649170890de08e0", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "EJmg", "name": "_"}, {"code": "mo.md(r\"\"\"\nThe seq_num_in_enc field is scoped to the Inpatient Admission patient class, not the full encounter.\nWhen a patient starts in the ED and converts to inpatient, the initial ED Admission event receives no\nsequence number (NaN). This is systematic, not a data quality issue. Since all NaN cases follow this\npattern and timestamps are in correct chronological order, we will use effective_time to order events\nand extract transitions \u2014 no resequencing needed.\n\"\"\")", "code_hash": "9c8ec43aba145232574bd666dc8e6d96", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "UmEG", "name": "_"}, {"code": "# Where is ED hiding?\ned_events = df_clean[df_clean['patient_class'].str.contains('Emergency', na=False)]\nprint(f\"ED events: {len(ed_events):,}\")\nprint(f\"\\nED department_group values:\")\nprint(ed_events['department_group'].value_counts(dropna=False))\n\nprint(f\"\\nED department_name samples:\")\nprint(ed_events['department_name'].value_counts().head(10))", "code_hash": "15354471e895b7c2ad93902b4c539e1a", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vEBW", "name": "_"}, {"code": "mo.md(r\"\"\"\nED events (306,495) have NaN for department_group in the source data \u2014 the field was never populated\nfor emergency departments. This accounts for the majority of the ~556K missing department_group values\nidentified earlier. ED events are still present in df_clean and can be identified via patient_class\n(\"Emergency Department - Encounter\") or department_name prefix (LJ/HC/EC EMERGENCY DEPT). We will\nfill in \"ED\" as the department_group for these events before building the transition matrix.\n\"\"\")", "code_hash": "9f6dd6ed47c8a124a3f8d90a5737bfd6", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "kLmu", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Tier Mapping\n\nOur simulation models patient flow between 9 states: 3 care tiers (ED, ICU, Floor) \u00d7 3 campuses\n(La Jolla, Hillcrest, East Campus), plus discharge home. The raw data has ~10 granular department\ngroups (MedSurg, PCU, IMU, OB, etc.) that need to be collapsed into these 3 tiers. Mapping: ED\nevents (identified via patient_class/department_name since department_group is NaN for ED), ICU stays\nas ICU, and everything else (MedSurg, OB, PCU, IMU, MedSTele, Behavioral Health, Nursery, NICU) as\nFloor. Events with no tier (perioperative/holding) will be skipped in transition extraction so\ntransitions connect around them (e.g., ED \u2192 periop \u2192 Floor becomes ED \u2192 Floor).\n\"\"\")", "code_hash": "b329e37e5b17da7ad16847c7ec8b5c6e", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "IpqN", "name": "_"}, {"code": "# Create tier mapping\ndef assign_tier(row):\n    if row['patient_class'] == 'Emergency Department - Encounter' or \\\n       (pd.isna(row['department_group']) and 'EMERGENCY' in str(row['department_name'])):\n        return 'ED'\n    elif row['department_group'] == 'ICU':\n        return 'ICU'\n    elif pd.notna(row['department_group']):\n        return 'Floor'\n    else:\n        return None  # perioperative/holding - no tier\n\ndf_clean_tier = df_clean.copy()\ndf_clean_tier['tier'] = df_clean_tier.apply(assign_tier, axis=1)\n\nprint(\"Tier counts:\")\nprint(df_clean_tier['tier'].value_counts(dropna=False))\n\nprint(\"\\nTier x Location:\")\nprint(pd.crosstab(df_clean_tier['tier'], df_clean_tier['location']))", "code_hash": "f03863db75af8a9d8ee6c6fdc3412bcc", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "dxZZ", "name": "_"}, {"code": "# Check None tier events\nno_tier = df_clean_tier[df_clean_tier['tier'].isna()]\nprint(f\"Events with no tier: {len(no_tier):,}\")\nprint(f\"Encounters affected: {no_tier['pat_enc_csn_id'].nunique():,}\")\nprint(f\"\\ndepartment_name for no-tier events:\")\nfor dept, cnt in no_tier['department_name'].value_counts().items():\n    print(f\"  {dept}: {cnt:,}\")", "code_hash": "40fc7fa5e2c3d5ecd6966cc902e34e58", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "dlnW", "name": "_"}, {"code": "# Create state column: tier + location\ndf_clean_tier['state'] = df_clean_tier['tier'] + '_' + df_clean_tier['location']\n\n# Sort by encounter and time, drop no-tier events\ndf_sorted = df_clean_tier[df_clean_tier['tier'].notna()].sort_values(['pat_enc_csn_id', 'effective_time'])\n\n# Extract transition pairs\ntransition_pairs = []\nfor enc_id, group in df_sorted.groupby('pat_enc_csn_id'):\n    states = group['state'].values\n    # Remove consecutive duplicates\n    path = [states[0]]\n    for st in states[1:]:\n        if st != path[-1]:\n            path.append(st)\n    # Add discharge as final state\n    path.append('Discharge')\n    # Collect pairs\n    for i in range(len(path) - 1):\n        transition_pairs.append((path[i], path[i+1]))\n\ntransitions_df = pd.DataFrame(transition_pairs, columns=['from_state', 'to_state'])\nprint(f\"Total transitions: {len(transitions_df):,}\")\nprint(f\"\\nTransition counts:\")\nfor pair, n_trans in transitions_df.value_counts().head(20).items():\n    print(f\"  {pair[0]} -\u003E {pair[1]}: {n_trans:,}\")", "code_hash": "414fc64fa3e996aa6a201d13f6c55db0", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "TTti", "name": "_"}, {"code": "# Define states\nfrom_states = [\n    'ED_La Jolla', 'ED_Hillcrest', 'ED_East Campus',\n    'Floor_La Jolla', 'Floor_Hillcrest', 'Floor_East Campus',\n    'ICU_La Jolla', 'ICU_Hillcrest', 'ICU_East Campus'\n]\nto_states = from_states + ['Discharge']\n\n# Build count matrix\ncount_matrix = pd.DataFrame(0, index=from_states, columns=to_states)\nfor (f, t), num in transitions_df.value_counts().items():\n    if f in from_states and t in to_states:\n        count_matrix.loc[f, t] = num\n\nprint(\"Count Matrix:\")\nprint(count_matrix)\n\n# Convert to probabilities (each row sums to 1)\nprob_matrix = count_matrix.div(count_matrix.sum(axis=1), axis=0)\nprint(\"\\nProbability Matrix:\")\nprint(prob_matrix.round(4))\n\n# Verify rows sum to 1\nprint(f\"\\nRow sums: {prob_matrix.sum(axis=1).values}\")", "code_hash": "33fe649568c018722ea661716633a0bb", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "RKFZ", "name": "_"}, {"code": "# Build state blocks with duration\ndf_states = df_clean_tier[df_clean_tier['tier'].notna()].copy()\ndf_states['state'] = (df_states['tier'] + '_' + df_states['location']).str.upper().str.replace(' ', '_')\ndf_states = df_states.sort_values(['pat_enc_csn_id', 'effective_time'])\n\n# Detect state changes and assign block IDs\ndf_states['prev_state'] = df_states.groupby('pat_enc_csn_id')['state'].shift()\ndf_states['is_new'] = (df_states['state'] != df_states['prev_state']).astype(int)\ndf_states['block'] = df_states.groupby('pat_enc_csn_id')['is_new'].cumsum()\n\n# Collapse to one row per block with time_in, time_out, duration\nstate_blocks = (\n    df_states.groupby(['pat_enc_csn_id', 'block', 'state'])\n    .agg(time_in=('effective_time', 'min'), time_out=('effective_time', 'max'))\n    .reset_index()\n    .sort_values(['pat_enc_csn_id', 'block'])\n)\nstate_blocks['duration_hours'] = (state_blocks['time_out'] - state_blocks['time_in']).dt.total_seconds() / 3600\n\n# Build trajectory library\ntrajectory_library = (\n    state_blocks\n    .sort_values(['pat_enc_csn_id', 'block'])\n    .groupby('pat_enc_csn_id')\n    .apply(lambda g: list(zip(g['state'], g['duration_hours'])))\n    .to_dict()\n)\n\n# Preview a few\n# for eid, traj in list(trajectory_library.items())[:5]:\n#     traj_str = ' \u2192 '.join([f\"{state} ({dur:.1f}h)\" for state, dur in traj])\n#     print(f\"{eid}: {traj_str}\")\n\nprint(f\"\\nTotal trajectories: {len(trajectory_library):,}\")", "code_hash": "d8a4c68e04f9837a6a3de23009289ca0", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "IaQp", "name": "_"}, {"code": "# Get durations per state from state_blocks\nfor state_name, grp in state_blocks.groupby('state'):\n    durations = grp['duration_hours']\n    print(f\"{state_name}: n={len(grp):,}, mean={durations.mean():.1f}h, median={durations.median():.1f}h, std={durations.std():.1f}h\")", "code_hash": "8a8d963cd06c3c3ec78134da699a5685", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "IWgg", "name": "_"}, {"code": "distributions = {\n    'lognorm': stats.lognorm,\n    'gamma': stats.gamma,\n    'expon': stats.expon,\n    'weibull_min': stats.weibull_min\n}\n\nfit_results = {}\nfor sname, sgrp in state_blocks.groupby('state'):\n    dur_hrs = sgrp['duration_hours'].dropna()\n    dur_hrs = dur_hrs[dur_hrs \u003E 0]\n\n    print(f\"\\n{'='*60}\")\n    print(f\"Fitting: {sname} (n={len(dur_hrs):,})\")\n    print(f\"{'='*60}\")\n\n    best_name = None\n    best_sse = float('inf')\n    best_params = None\n\n    for dist_name, dist in distributions.items():\n        params = dist.fit(dur_hrs)\n        pdf_values = dist.pdf(sorted(dur_hrs), *params)\n        sse = np.sum((np.histogram(dur_hrs, bins=50, density=True)[0] - \n                       dist.pdf(np.histogram(dur_hrs, bins=50)[1][:-1] + \n                       np.diff(np.histogram(dur_hrs, bins=50)[1])/2, *params))**2)\n        print(f\"  {dist_name}: SSE={sse:.6f}, params={tuple(round(p,4) for p in params)}\")\n\n        if sse \u003C best_sse:\n            best_sse = sse\n            best_name = dist_name\n            best_params = params\n\n    fit_results[sname] = {'dist': best_name, 'params': best_params, 'sse': best_sse}\n    print(f\"  \u2192 Best: {best_name}\")", "code_hash": "8e5300a66b1a9ca72e68b0ad7ba0e257", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "fCoF", "name": "_"}, {"code": "boarded = df_clean_tier[\n    (df_clean_tier['department_name'].str.contains('EMERGENCY', na=False)) \u0026 \n    (df_clean_tier['patient_class'] != 'Emergency Department - Encounter')\n]\nprint(f\"Potential boarded events: {len(boarded):,}\")\nprint(f\"\\nTier breakdown:\")\nfor tier_val, n in boarded['tier'].value_counts(dropna=False).items():\n    print(f\"  {tier_val}: {n:,}\")", "code_hash": "e0db2b3447c6a046128ef3c4ec6599c7", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "LkGn", "name": "_"}, {"code": "# Compare ED durations: true ED patients vs boarded\ned_blocks = state_blocks[state_blocks['state'].str.startswith('ED_')]\n\n# Tag which encounters have boarded events\nboarded_encs = boarded['pat_enc_csn_id'].unique()\ned_blocks_tagged = ed_blocks.copy()\ned_blocks_tagged['is_boarded'] = ed_blocks_tagged['pat_enc_csn_id'].isin(boarded_encs)\n\nprint(\"ED durations for encounters WITH boarding:\")\nprint(ed_blocks_tagged[ed_blocks_tagged['is_boarded']]['duration_hours'].describe())\n\nprint(\"\\nED durations for encounters WITHOUT boarding:\")\nprint(ed_blocks_tagged[~ed_blocks_tagged['is_boarded']]['duration_hours'].describe())", "code_hash": "52aaf93a6c571f17d908fa5f1fe2ccc7", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "zVRe", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Boarded Patients (Known Limitation)\n\n148,234 ED events (~33% of all ED events) are boarded patients \u2014 physically in the ED but already\nadmitted as inpatients. These inflate ED duration distributions significantly: median 14.7h with\nboarding vs 3.3h without. For v1 of the simulation, boarded time is counted as ED occupancy. Future\niterations could split these encounters at the patient_class change point to separate true ED time\nfrom boarding time.\n\"\"\")", "code_hash": "b5f99b93fd803e14ffb9170cfe1038e2", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "woaO", "name": "_"}, {"code": "mo.md(r\"\"\"\n## Arrival Rates: Weekday vs Weekend\n\nThe simulation needs to know how many patients enter the system per day at each campus. Patient arrival\npatterns differ between weekdays and weekends (e.g., fewer elective admissions on weekends, different ED\nvolumes). We calculate mean daily arrivals by campus (La Jolla, Hillcrest, East Campus) split by\nweekday vs weekend. These rates will drive patient generation in the simulation \u2014 each simulated day\nsamples from the appropriate arrival distribution to determine how many new patients enter each campus.\n\"\"\")", "code_hash": "d5f2bd8344b9c77e20daf9ba799a0a77", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "HnMC", "name": "_"}, {"code": "# Get first event per encounter (arrival) with tier\narrivals = df_clean_tier[df_clean_tier['tier'].notna()].sort_values('effective_time').groupby('pat_enc_csn_id').first().reset_index()\narrivals['day_of_week'] = arrivals['effective_time'].dt.dayofweek\narrivals['is_weekend'] = arrivals['day_of_week'].isin([5, 6])\narrivals['date'] = arrivals['effective_time'].dt.date\n\n# Daily arrival counts by campus and weekday/weekend\ndaily = arrivals.groupby(['location', 'is_weekend', 'date']).size().reset_index(name='daily_arrivals')\n\nprint(\"Mean daily arrivals by campus and day type:\")\nfor (loc, wknd), sub in daily.groupby(['location', 'is_weekend']):\n    day_type = 'Weekend' if wknd else 'Weekday'\n    print(f\"  {loc} ({day_type}): mean={sub['daily_arrivals'].mean():.1f}, std={sub['daily_arrivals'].std():.1f}\")", "code_hash": "a2fbb065545707eb1827cfea177c3e04", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "wadT", "name": "_"}, {"code": "mo.md(r\"\"\"\n# UCSD Health DES \u2014 EDA \u0026 Data Preparation Summary\n\n## Data Cleaning Pipeline\n\n**Starting point:** 2.1M ADT events across 985K patient encounters (2025).\n\n**Step 1 \u2014 Filter to bed-occupying patients:** Removed non-bed-occupying patient classes (outpatient radiology, infusion, therapy, etc.), reducing to 1.15M rows across 153,878 encounters.\n\n**Step 2 \u2014 Drop single-event encounters:** 1,720 encounters (1.1%) had only a single event, producing no usable transitions. These were incomplete records in the source system (orphan discharges, registration-only entries), not artifacts of our filtering. Dropped to yield 152,158 encounters / 1,151,386 events.\n\n**Step 3 \u2014 Tier mapping:** Collapsed ~10 granular department groups into 3 care tiers for the simulation's 9-state model (3 tiers \u00d7 3 campuses). ED events had NaN for `department_group` in the source data (never populated for emergency departments) and were identified via `patient_class` and `department_name`. Mapping: ED \u2192 ED, ICU \u2192 ICU, everything else (MedSurg, OB, PCU, IMU, MedSTele, Behavioral Health, Nursery, NICU) \u2192 Floor. 100,633 events with no tier (perioperative/holding areas) are skipped in transition extraction so transitions connect around them (e.g., ED \u2192 periop \u2192 Floor becomes ED \u2192 Floor).\n\n**Step 4 \u2014 Timestamp-based ordering:** The `seq_num_in_enc` field is scoped to the Inpatient Admission patient class, not the full encounter. ED Admission events receive NaN sequence numbers. Since timestamps are in correct chronological order, all event ordering uses `effective_time` \u2014 no resequencing needed.\n\n---\n\n## 1. Transition Matrix (9\u00d710)\n\nTransition probabilities between 9 states (ED/Floor/ICU \u00d7 La Jolla/Hillcrest/East Campus) plus Discharge. Built by sorting each encounter by `effective_time`, extracting the sequence of states (dropping NaN-tier events and consecutive duplicates), and counting state-to-state transitions. 185,866 total transitions extracted.\n\n|  | ED_LJ | ED_HC | ED_EC | Fl_LJ | Fl_HC | Fl_EC | ICU_LJ | ICU_HC | ICU_EC | Disch |\n|---|---|---|---|---|---|---|---|---|---|---|\n| **ED_LJ** | 0.000 | 0.001 | 0.000 | 0.163 | 0.008 | 0.015 | 0.027 | 0.001 | 0.001 | 0.785 |\n| **ED_HC** | 0.001 | 0.000 | 0.000 | 0.001 | 0.173 | 0.023 | 0.001 | 0.028 | 0.001 | 0.774 |\n| **ED_EC** | 0.002 | 0.006 | 0.000 | 0.000 | 0.005 | 0.112 | 0.000 | 0.001 | 0.019 | 0.854 |\n| **Fl_LJ** | 0.001 | 0.000 | 0.000 | 0.000 | 0.002 | 0.001 | 0.042 | 0.000 | 0.000 | 0.955 |\n| **Fl_HC** | 0.000 | 0.001 | 0.000 | 0.010 | 0.000 | 0.002 | 0.002 | 0.037 | 0.000 | 0.949 |\n| **Fl_EC** | 0.000 | 0.000 | 0.000 | 0.004 | 0.011 | 0.000 | 0.000 | 0.000 | 0.027 | 0.957 |\n| **ICU_LJ** | 0.000 | 0.000 | 0.000 | 0.559 | 0.001 | 0.000 | 0.000 | 0.001 | 0.001 | 0.438 |\n| **ICU_HC** | 0.000 | 0.001 | 0.000 | 0.003 | 0.743 | 0.000 | 0.017 | 0.000 | 0.005 | 0.230 |\n| **ICU_EC** | 0.000 | 0.000 | 0.002 | 0.006 | 0.005 | 0.648 | 0.032 | 0.018 | 0.000 | 0.289 |\n\n**Key patterns:** ED \u2192 Discharge is dominant (77\u201385%), reflecting most ED patients going home. Floor \u2192 Discharge (95\u201396%) shows most floor patients discharge directly. ICU \u2192 Floor same campus (56\u201374%) is the primary step-down pathway. Cross-campus transfers exist but are rare.\n\n---\n\n## 2. Duration Distributions (Lognormal Fits)\n\nLength of stay per state block, fit using scipy. Lognormal wins 8 of 9 states (exponential for ED East Campus). All states are heavily right-skewed (mean \u003E\u003E median) due to long-stay outliers.\n\n| State | Best Fit | Params (shape, loc, scale) | Mean (h) | Median (h) |\n|---|---|---|---|---|\n| ED_East Campus | expon | (0.017, 3.67) | 3.7 | 2.5 |\n| ED_Hillcrest | lognorm | (0.777, -0.658, 5.644) | 7.0 | 4.8 |\n| ED_La Jolla | lognorm | (1.255, -0.107, 6.123) | 13.7 | 4.8 |\n| Floor_East Campus | lognorm | (1.001, -1.784, 59.882) | 110.5 | 53.1 |\n| Floor_Hillcrest | lognorm | (1.186, -3.259, 59.236) | 112.1 | 61.9 |\n| Floor_La Jolla | lognorm | (1.177, -3.345, 52.999) | 99.8 | 53.8 |\n| ICU_East Campus | lognorm | (0.946, -2.649, 48.313) | 74.6 | 42.8 |\n| ICU_Hillcrest | lognorm | (1.002, -2.176, 59.649) | 102.2 | 51.6 |\n| ICU_La Jolla | lognorm | (1.120, -0.956, 46.637) | 93.2 | 43.4 |\n\n---\n\n## 3. Trajectory Library\n\n150,337 patient trajectories with state and duration at each stop. Each encounter maps to a sequence of `(state, duration_hours)` tuples. Example: `ED_La Jolla (4.5h) \u2192 Floor_La Jolla (48.2h) \u2192 Discharge`. Combines the transition logic with the duration data for full patient path reconstruction.\n\n---\n\n## 4. Arrival Rates (Weekday vs Weekend)\n\nMean daily arrivals by campus and day type, calculated from the first event of each encounter.\n\n| Campus | Weekday (mean \u00b1 std) | Weekend (mean \u00b1 std) |\n|---|---|---|\n| East Campus | 92.4 \u00b1 10.5 | 83.3 \u00b1 10.5 |\n| Hillcrest | 144.7 \u00b1 19.9 | 125.1 \u00b1 10.3 |\n| La Jolla | 198.2 \u00b1 26.2 | 148.9 \u00b1 14.5 |\n\nAll campuses show 10\u201325% fewer arrivals on weekends, consistent with reduced elective admissions. La Jolla has the largest absolute drop.\n\n---\n\n## Known Limitation: Boarded Patients\n\n148,234 ED events (~33% of all ED events) are boarded patients \u2014 physically in the ED but already admitted as inpatients. These inflate ED duration distributions significantly: median 14.7h with boarding vs 3.3h without. For v1 of the simulation, boarded time is counted as ED occupancy. Future iterations could split these encounters at the patient_class change point to separate true ED time from boarding time.\n\"\"\")", "code_hash": "18faa67fc0a2f5254b2b2c256a9e20c5", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "VCRE", "name": "_"}, {"code": "mo.md(r\"\"\"\n# Saving all tables to be imported to another notebook for DES\n\"\"\")", "code_hash": "2f37e0322356a7f0d85ffc469d0b8f2f", "config": {"column": null, "disabled": false, "hide_code": true}, "id": "hgqU", "name": "_"}, {"code": "# df_clean_tier.to_csv('ADT_cleaned_with_tiers.csv')", "code_hash": "831d8109e51406ed77dc4b22b8dac329", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PSUk", "name": "_"}, {"code": "# prob_matrix.to_csv('probability_matrix.csv')\nprob_matrix", "code_hash": "0e887b641b5020b61b4b0ed78dacad54", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "mfOT", "name": "_"}, {"code": "\nfitted_dist_data = [\n    [\"ED_East Campus\", \"expon\", (0.017, 3.67), 3.7, 2.5],\n    [\"ED_Hillcrest\", \"lognorm\", (0.777, -0.658, 5.644), 7.0, 4.8],\n    [\"ED_La Jolla\", \"lognorm\", (1.255, -0.107, 6.123), 13.7, 4.8],\n    [\"Floor_East Campus\", \"lognorm\", (1.001, -1.784, 59.882), 110.5, 53.1],\n    [\"Floor_Hillcrest\", \"lognorm\", (1.186, -3.259, 59.236), 112.1, 61.9],\n    [\"Floor_La Jolla\", \"lognorm\", (1.177, -3.345, 52.999), 99.8, 53.8],\n    [\"ICU_East Campus\", \"lognorm\", (0.946, -2.649, 48.313), 74.6, 42.8],\n    [\"ICU_Hillcrest\", \"lognorm\", (1.002, -2.176, 59.649), 102.2, 51.6],\n    [\"ICU_La Jolla\", \"lognorm\", (1.120, -0.956, 46.637), 93.2, 43.4],\n]\n\nfitted_dist_df = pd.DataFrame(\n    fitted_dist_data,\n    columns=[\"state\", \"best_fit\", \"params)\", \"mean\", \"median\"]\n)\n\n# fitted_dist_df.to_csv('states_fitted_distribution_df.csv')\n# fitted_dist_df", "code_hash": "3ffbf2a43690019e7d3187833cc84d74", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "vGiW", "name": "_"}, {"code": "arrival_rates_data = [\n    [\"East Campus\", 92.4, 10.5, 83.3, 10.5],\n    [\"Hillcrest\", 144.7, 19.9, 125.1, 10.3],\n    [\"La Jolla\", 198.2, 26.2, 148.9, 14.5],\n]\n\ndf_week = pd.DataFrame(\n    arrival_rates_data,\n    columns=[\n        \"campus\",\n        \"weekday_mean\",\n        \"weekday_std\",\n        \"weekend_mean\",\n        \"weekend_std\",\n    ]\n)\n\n# df_week.to_csv('weekday_weekend_arrival_rates_df.csv')\ndf_week", "code_hash": "07f3032b5b97f2e336ac211811cb4c29", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "SYQT", "name": "_"}, {"code": "type(trajectory_library)", "code_hash": "079c15461fa339690a6a862553e29491", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "bMrW", "name": "_"}, {"code": "import json\nwith open('trajectory_library.json', 'w') as json_file:\n    json.dump(trajectory_library, json_file, indent=4)", "code_hash": "54e86e4a133db83451cc24c25e61e20d", "config": {"column": null, "disabled": false, "hide_code": false}, "id": "PSQn", "name": "_"}, {"code": "", "code_hash": null, "config": {"column": null, "disabled": false, "hide_code": false}, "id": "OfTS", "name": "_"}], "metadata": {"marimo_version": "0.19.9"}, "version": "1"},
            "session": {"cells": [{"code_hash": "87efece48dfb19cf06a9d18fb10d361d", "console": [], "id": "Hbol", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "ef8d1869416d7f216780003b0fd1fcb0", "console": [], "id": "hyLk", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "22f19dcba87b7647b0c25024ccc09459", "console": [], "id": "MJUe", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='MJUe-0' random-id='9d3cf4d1-5be4-2945-65ad-1a86762dd2a3'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:849178,\u0026#92;\u0026quot;effective_time\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2025-01-01 23:59:00\u0026#92;\u0026quot;,\u0026#92;\u0026quot;event_type_c\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;event_type\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;,\u0026#92;\u0026quot;linked_transfer_out_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;linked_transfer_in_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;seq_num_in_enc\u0026#92;\u0026quot;:2261.0,\u0026#92;\u0026quot;pend_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_created_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_plan_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_preassigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_assigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_bed_ready_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_move_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;department_id\u0026#92;\u0026quot;:2406651,\u0026#92;\u0026quot;department_name\u0026#92;\u0026quot;:\u0026#92;\u0026quot;UC EMERGENCY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;department_group\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;room_id\u0026#92;\u0026quot;:2036.0,\u0026#92;\u0026quot;room_csn_id\u0026#92;\u0026quot;:10460.0,\u0026#92;\u0026quot;room\u0026#92;\u0026quot;:\u0026#92;\u0026quot;PSYCHIATRY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;bed_id\u0026#92;\u0026quot;:4654.0,\u0026#92;\u0026quot;bed_csn_id\u0026#92;\u0026quot;:4700.0,\u0026#92;\u0026quot;bed\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Psych TeleMed\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_lvl_of_care_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;patient_levelof_care\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_pat_class_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_patient_class\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;pat_class_c\u0026#92;\u0026quot;:40.0,\u0026#92;\u0026quot;patient_class\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Telemedicine - Encounter\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_service_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;hospital_service\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;tc_admit_flag\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;referring_location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;transfer_type\u0026#92;\u0026quot;:NaN},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:1014858,\u0026#92;\u0026quot;effective_time\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2025-01-02 23:59:00\u0026#92;\u0026quot;,\u0026#92;\u0026quot;event_type_c\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;event_type\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;,\u0026#92;\u0026quot;linked_transfer_out_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;linked_transfer_in_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;seq_num_in_enc\u0026#92;\u0026quot;:2262.0,\u0026#92;\u0026quot;pend_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_created_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_plan_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_preassigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_assigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_bed_ready_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_move_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;department_id\u0026#92;\u0026quot;:2406651,\u0026#92;\u0026quot;department_name\u0026#92;\u0026quot;:\u0026#92;\u0026quot;UC EMERGENCY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;department_group\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;room_id\u0026#92;\u0026quot;:2036.0,\u0026#92;\u0026quot;room_csn_id\u0026#92;\u0026quot;:10460.0,\u0026#92;\u0026quot;room\u0026#92;\u0026quot;:\u0026#92;\u0026quot;PSYCHIATRY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;bed_id\u0026#92;\u0026quot;:4654.0,\u0026#92;\u0026quot;bed_csn_id\u0026#92;\u0026quot;:4700.0,\u0026#92;\u0026quot;bed\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Psych TeleMed\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_lvl_of_care_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;patient_levelof_care\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_pat_class_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_patient_class\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;pat_class_c\u0026#92;\u0026quot;:40.0,\u0026#92;\u0026quot;patient_class\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Telemedicine - Encounter\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_service_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;hospital_service\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;tc_admit_flag\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;referring_location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;transfer_type\u0026#92;\u0026quot;:NaN},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:1913264,\u0026#92;\u0026quot;effective_time\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2025-01-03 23:59:00\u0026#92;\u0026quot;,\u0026#92;\u0026quot;event_type_c\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;event_type\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;,\u0026#92;\u0026quot;linked_transfer_out_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;linked_transfer_in_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;seq_num_in_enc\u0026#92;\u0026quot;:2263.0,\u0026#92;\u0026quot;pend_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_created_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_plan_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_preassigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_assigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_bed_ready_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_move_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;department_id\u0026#92;\u0026quot;:2406651,\u0026#92;\u0026quot;department_name\u0026#92;\u0026quot;:\u0026#92;\u0026quot;UC EMERGENCY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;department_group\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;room_id\u0026#92;\u0026quot;:2036.0,\u0026#92;\u0026quot;room_csn_id\u0026#92;\u0026quot;:10460.0,\u0026#92;\u0026quot;room\u0026#92;\u0026quot;:\u0026#92;\u0026quot;PSYCHIATRY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;bed_id\u0026#92;\u0026quot;:4654.0,\u0026#92;\u0026quot;bed_csn_id\u0026#92;\u0026quot;:4700.0,\u0026#92;\u0026quot;bed\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Psych TeleMed\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_lvl_of_care_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;patient_levelof_care\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_pat_class_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_patient_class\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;pat_class_c\u0026#92;\u0026quot;:40.0,\u0026#92;\u0026quot;patient_class\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Telemedicine - Encounter\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_service_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;hospital_service\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;tc_admit_flag\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;referring_location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;transfer_type\u0026#92;\u0026quot;:NaN},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:1875766,\u0026#92;\u0026quot;effective_time\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2025-01-04 23:59:00\u0026#92;\u0026quot;,\u0026#92;\u0026quot;event_type_c\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;event_type\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;,\u0026#92;\u0026quot;linked_transfer_out_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;linked_transfer_in_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;seq_num_in_enc\u0026#92;\u0026quot;:2264.0,\u0026#92;\u0026quot;pend_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_created_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_plan_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_preassigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_assigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_bed_ready_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_move_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;department_id\u0026#92;\u0026quot;:2406651,\u0026#92;\u0026quot;department_name\u0026#92;\u0026quot;:\u0026#92;\u0026quot;UC EMERGENCY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;department_group\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;room_id\u0026#92;\u0026quot;:2036.0,\u0026#92;\u0026quot;room_csn_id\u0026#92;\u0026quot;:10460.0,\u0026#92;\u0026quot;room\u0026#92;\u0026quot;:\u0026#92;\u0026quot;PSYCHIATRY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;bed_id\u0026#92;\u0026quot;:4654.0,\u0026#92;\u0026quot;bed_csn_id\u0026#92;\u0026quot;:4700.0,\u0026#92;\u0026quot;bed\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Psych TeleMed\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_lvl_of_care_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;patient_levelof_care\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_pat_class_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_patient_class\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;pat_class_c\u0026#92;\u0026quot;:40.0,\u0026#92;\u0026quot;patient_class\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Telemedicine - Encounter\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_service_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;hospital_service\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;tc_admit_flag\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;referring_location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;transfer_type\u0026#92;\u0026quot;:NaN},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:1597184,\u0026#92;\u0026quot;effective_time\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2025-01-05 23:59:00\u0026#92;\u0026quot;,\u0026#92;\u0026quot;event_type_c\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;event_type\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;,\u0026#92;\u0026quot;linked_transfer_out_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;linked_transfer_in_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;seq_num_in_enc\u0026#92;\u0026quot;:2265.0,\u0026#92;\u0026quot;pend_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_created_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_plan_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_preassigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_assigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_bed_ready_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_move_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;department_id\u0026#92;\u0026quot;:2406651,\u0026#92;\u0026quot;department_name\u0026#92;\u0026quot;:\u0026#92;\u0026quot;UC EMERGENCY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;department_group\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;room_id\u0026#92;\u0026quot;:2036.0,\u0026#92;\u0026quot;room_csn_id\u0026#92;\u0026quot;:10460.0,\u0026#92;\u0026quot;room\u0026#92;\u0026quot;:\u0026#92;\u0026quot;PSYCHIATRY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;bed_id\u0026#92;\u0026quot;:4654.0,\u0026#92;\u0026quot;bed_csn_id\u0026#92;\u0026quot;:4700.0,\u0026#92;\u0026quot;bed\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Psych TeleMed\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_lvl_of_care_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;patient_levelof_care\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_pat_class_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_patient_class\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;pat_class_c\u0026#92;\u0026quot;:40.0,\u0026#92;\u0026quot;patient_class\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Telemedicine - Encounter\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_service_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;hospital_service\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;tc_admit_flag\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;referring_location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;transfer_type\u0026#92;\u0026quot;:NaN},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:1071874,\u0026#92;\u0026quot;effective_time\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2025-01-06 23:59:00\u0026#92;\u0026quot;,\u0026#92;\u0026quot;event_type_c\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;event_type\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;,\u0026#92;\u0026quot;linked_transfer_out_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;linked_transfer_in_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;seq_num_in_enc\u0026#92;\u0026quot;:2266.0,\u0026#92;\u0026quot;pend_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_created_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_plan_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_preassigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_assigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_bed_ready_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_move_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;department_id\u0026#92;\u0026quot;:2406651,\u0026#92;\u0026quot;department_name\u0026#92;\u0026quot;:\u0026#92;\u0026quot;UC EMERGENCY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;department_group\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;room_id\u0026#92;\u0026quot;:2036.0,\u0026#92;\u0026quot;room_csn_id\u0026#92;\u0026quot;:10460.0,\u0026#92;\u0026quot;room\u0026#92;\u0026quot;:\u0026#92;\u0026quot;PSYCHIATRY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;bed_id\u0026#92;\u0026quot;:4654.0,\u0026#92;\u0026quot;bed_csn_id\u0026#92;\u0026quot;:4700.0,\u0026#92;\u0026quot;bed\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Psych TeleMed\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_lvl_of_care_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;patient_levelof_care\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_pat_class_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_patient_class\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;pat_class_c\u0026#92;\u0026quot;:40.0,\u0026#92;\u0026quot;patient_class\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Telemedicine - Encounter\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_service_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;hospital_service\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;tc_admit_flag\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;referring_location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;transfer_type\u0026#92;\u0026quot;:NaN},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:332842,\u0026#92;\u0026quot;effective_time\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2025-01-07 23:59:00\u0026#92;\u0026quot;,\u0026#92;\u0026quot;event_type_c\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;event_type\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;,\u0026#92;\u0026quot;linked_transfer_out_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;linked_transfer_in_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;seq_num_in_enc\u0026#92;\u0026quot;:2267.0,\u0026#92;\u0026quot;pend_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_created_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_plan_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_preassigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_assigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_bed_ready_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_move_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;department_id\u0026#92;\u0026quot;:2406651,\u0026#92;\u0026quot;department_name\u0026#92;\u0026quot;:\u0026#92;\u0026quot;UC EMERGENCY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;department_group\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;room_id\u0026#92;\u0026quot;:2036.0,\u0026#92;\u0026quot;room_csn_id\u0026#92;\u0026quot;:10460.0,\u0026#92;\u0026quot;room\u0026#92;\u0026quot;:\u0026#92;\u0026quot;PSYCHIATRY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;bed_id\u0026#92;\u0026quot;:4654.0,\u0026#92;\u0026quot;bed_csn_id\u0026#92;\u0026quot;:4700.0,\u0026#92;\u0026quot;bed\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Psych TeleMed\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_lvl_of_care_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;patient_levelof_care\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_pat_class_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_patient_class\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;pat_class_c\u0026#92;\u0026quot;:40.0,\u0026#92;\u0026quot;patient_class\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Telemedicine - Encounter\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_service_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;hospital_service\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;tc_admit_flag\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;referring_location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;transfer_type\u0026#92;\u0026quot;:NaN},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:185540,\u0026#92;\u0026quot;effective_time\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2025-01-08 23:59:00\u0026#92;\u0026quot;,\u0026#92;\u0026quot;event_type_c\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;event_type\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;,\u0026#92;\u0026quot;linked_transfer_out_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;linked_transfer_in_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;seq_num_in_enc\u0026#92;\u0026quot;:2268.0,\u0026#92;\u0026quot;pend_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_created_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_plan_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_preassigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_assigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_bed_ready_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_move_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;department_id\u0026#92;\u0026quot;:2406651,\u0026#92;\u0026quot;department_name\u0026#92;\u0026quot;:\u0026#92;\u0026quot;UC EMERGENCY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;department_group\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;room_id\u0026#92;\u0026quot;:2036.0,\u0026#92;\u0026quot;room_csn_id\u0026#92;\u0026quot;:10460.0,\u0026#92;\u0026quot;room\u0026#92;\u0026quot;:\u0026#92;\u0026quot;PSYCHIATRY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;bed_id\u0026#92;\u0026quot;:4654.0,\u0026#92;\u0026quot;bed_csn_id\u0026#92;\u0026quot;:4700.0,\u0026#92;\u0026quot;bed\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Psych TeleMed\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_lvl_of_care_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;patient_levelof_care\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_pat_class_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_patient_class\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;pat_class_c\u0026#92;\u0026quot;:40.0,\u0026#92;\u0026quot;patient_class\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Telemedicine - Encounter\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_service_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;hospital_service\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;tc_admit_flag\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;referring_location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;transfer_type\u0026#92;\u0026quot;:NaN},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:1119747,\u0026#92;\u0026quot;effective_time\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2025-01-09 23:59:00\u0026#92;\u0026quot;,\u0026#92;\u0026quot;event_type_c\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;event_type\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;,\u0026#92;\u0026quot;linked_transfer_out_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;linked_transfer_in_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;seq_num_in_enc\u0026#92;\u0026quot;:2269.0,\u0026#92;\u0026quot;pend_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_created_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_plan_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_preassigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_assigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_bed_ready_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_move_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;department_id\u0026#92;\u0026quot;:2406651,\u0026#92;\u0026quot;department_name\u0026#92;\u0026quot;:\u0026#92;\u0026quot;UC EMERGENCY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;department_group\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;room_id\u0026#92;\u0026quot;:2036.0,\u0026#92;\u0026quot;room_csn_id\u0026#92;\u0026quot;:10460.0,\u0026#92;\u0026quot;room\u0026#92;\u0026quot;:\u0026#92;\u0026quot;PSYCHIATRY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;bed_id\u0026#92;\u0026quot;:4654.0,\u0026#92;\u0026quot;bed_csn_id\u0026#92;\u0026quot;:4700.0,\u0026#92;\u0026quot;bed\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Psych TeleMed\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_lvl_of_care_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;patient_levelof_care\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_pat_class_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_patient_class\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;pat_class_c\u0026#92;\u0026quot;:40.0,\u0026#92;\u0026quot;patient_class\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Telemedicine - Encounter\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_service_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;hospital_service\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;tc_admit_flag\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;referring_location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;transfer_type\u0026#92;\u0026quot;:NaN},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:1541789,\u0026#92;\u0026quot;effective_time\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2025-01-10 23:59:00\u0026#92;\u0026quot;,\u0026#92;\u0026quot;event_type_c\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;event_type\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;,\u0026#92;\u0026quot;linked_transfer_out_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;linked_transfer_in_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;seq_num_in_enc\u0026#92;\u0026quot;:2270.0,\u0026#92;\u0026quot;pend_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_created_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_plan_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_preassigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_assigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_bed_ready_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_move_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;department_id\u0026#92;\u0026quot;:2406651,\u0026#92;\u0026quot;department_name\u0026#92;\u0026quot;:\u0026#92;\u0026quot;UC EMERGENCY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;department_group\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;room_id\u0026#92;\u0026quot;:2036.0,\u0026#92;\u0026quot;room_csn_id\u0026#92;\u0026quot;:10460.0,\u0026#92;\u0026quot;room\u0026#92;\u0026quot;:\u0026#92;\u0026quot;PSYCHIATRY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;bed_id\u0026#92;\u0026quot;:4654.0,\u0026#92;\u0026quot;bed_csn_id\u0026#92;\u0026quot;:4700.0,\u0026#92;\u0026quot;bed\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Psych TeleMed\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_lvl_of_care_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;patient_levelof_care\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_pat_class_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_patient_class\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;pat_class_c\u0026#92;\u0026quot;:40.0,\u0026#92;\u0026quot;patient_class\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Telemedicine - Encounter\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_service_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;hospital_service\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;tc_admit_flag\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;referring_location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;transfer_type\u0026#92;\u0026quot;:NaN}]\u0026quot;' data-total-rows='2107128' data-total-columns='34' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='10' data-field-types='[[\u0026quot;effective_time\u0026quot;,[\u0026quot;datetime\u0026quot;,\u0026quot;datetime64[us]\u0026quot;]],[\u0026quot;event_type_c\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;int64\u0026quot;]],[\u0026quot;event_type\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;linked_transfer_out_event_id\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;linked_transfer_in_event_id\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;seq_num_in_enc\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;pend_id\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;bed_request_created_dttm\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;bed_request_first_readyto_plan_dttm\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;bed_request_first_preassigned_dttm\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;bed_request_first_assigned_dttm\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;bed_request_first_bed_ready_dttm\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;bed_request_first_readyto_move_dttm\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;department_id\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;int64\u0026quot;]],[\u0026quot;department_name\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;department_group\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;location\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;room_id\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;room_csn_id\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;room\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;bed_id\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;bed_csn_id\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;bed\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;pat_lvl_of_care_c\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;patient_levelof_care\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;base_pat_class_c\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;base_patient_class\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;pat_class_c\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;patient_class\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;pat_service_c\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;hospital_service\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;tc_admit_flag\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;referring_location\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;transfer_type\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[[\u0026quot;\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;int64\u0026quot;]]]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "65e5ea28945eb2c9058e39ffa939ddeb", "console": [], "id": "vblA", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EGoal: to understand all of the columns, their data types, and events in each column.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "444f29f70b8fd840f406e8894fb2bea9", "console": [], "id": "bkHC", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='bkHC-0' random-id='2742a55a-6b83-bdc0-2fbe-faf3c0bd21c6'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:\u0026#92;\u0026quot;event_id\u0026#92;\u0026quot;,\u0026#92;\u0026quot;value\u0026#92;\u0026quot;:\u0026#92;\u0026quot;int64\u0026#92;\u0026quot;},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:\u0026#92;\u0026quot;effective_time\u0026#92;\u0026quot;,\u0026#92;\u0026quot;value\u0026#92;\u0026quot;:\u0026#92;\u0026quot;datetime64[us]\u0026#92;\u0026quot;},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:\u0026#92;\u0026quot;pat_enc_csn_id\u0026#92;\u0026quot;,\u0026#92;\u0026quot;value\u0026#92;\u0026quot;:\u0026#92;\u0026quot;int64\u0026#92;\u0026quot;},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:\u0026#92;\u0026quot;pat_id\u0026#92;\u0026quot;,\u0026#92;\u0026quot;value\u0026#92;\u0026quot;:{\u0026#92;\u0026quot;_storage\u0026#92;\u0026quot;:\u0026#92;\u0026quot;pyarrow\u0026#92;\u0026quot;,\u0026#92;\u0026quot;_na_value\u0026#92;\u0026quot;:NaN}},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:\u0026#92;\u0026quot;event_type_c\u0026#92;\u0026quot;,\u0026#92;\u0026quot;value\u0026#92;\u0026quot;:\u0026#92;\u0026quot;int64\u0026#92;\u0026quot;},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:\u0026#92;\u0026quot;event_type\u0026#92;\u0026quot;,\u0026#92;\u0026quot;value\u0026#92;\u0026quot;:{\u0026#92;\u0026quot;_storage\u0026#92;\u0026quot;:\u0026#92;\u0026quot;pyarrow\u0026#92;\u0026quot;,\u0026#92;\u0026quot;_na_value\u0026#92;\u0026quot;:NaN}},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:\u0026#92;\u0026quot;linked_transfer_out_event_id\u0026#92;\u0026quot;,\u0026#92;\u0026quot;value\u0026#92;\u0026quot;:\u0026#92;\u0026quot;float64\u0026#92;\u0026quot;},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:\u0026#92;\u0026quot;linked_transfer_in_event_id\u0026#92;\u0026quot;,\u0026#92;\u0026quot;value\u0026#92;\u0026quot;:\u0026#92;\u0026quot;float64\u0026#92;\u0026quot;},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:\u0026#92;\u0026quot;seq_num_in_enc\u0026#92;\u0026quot;,\u0026#92;\u0026quot;value\u0026#92;\u0026quot;:\u0026#92;\u0026quot;float64\u0026#92;\u0026quot;},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:\u0026#92;\u0026quot;pend_id\u0026#92;\u0026quot;,\u0026#92;\u0026quot;value\u0026#92;\u0026quot;:\u0026#92;\u0026quot;float64\u0026#92;\u0026quot;}]\u0026quot;' data-total-rows='37' data-total-columns='1' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='10' data-field-types='[[\u0026quot;value\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;object\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[[\u0026quot;\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]]]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "a6e440820df4b2704a5141b4fd641248", "console": [], "id": "lEQa", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"column-definitions-jchi-adt-data\"\u003EColumn Definitions - JCHI ADT Data\u003C/h1\u003E\n\u003Ch2 id=\"patient-identifiers\"\u003EPatient Identifiers\u003C/h2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003Epat_id\u003C/strong\u003E - Patient medical record number (same person across multiple visits)\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Epat_enc_csn_id\u003C/strong\u003E - Patient encounter ID (one unique hospital visit)\u003C/li\u003E\n\u003C/ul\u003E\n\u003Ch2 id=\"event-information\"\u003EEvent Information\u003C/h2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003Eevent_id\u003C/strong\u003E - Unique ID for this event record\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Eevent_type\u003C/strong\u003E - What happened: Admission, Transfer In, Transfer Out, Discharge, Census, Patient Update\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Eevent_type_c\u003C/strong\u003E - Numeric code for event_type\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Eeffective_time\u003C/strong\u003E - When this event occurred\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Eseq_num_in_enc\u003C/strong\u003E - Order number of events within this encounter (1, 2, 3...)\u003C/li\u003E\n\u003C/ul\u003E\n\u003Ch2 id=\"transfer-tracking\"\u003ETransfer Tracking\u003C/h2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003Elinked_transfer_in_event_id\u003C/strong\u003E - Links to the \"transfer in\" event_id\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Elinked_transfer_out_event_id\u003C/strong\u003E - Links to the \"transfer out\" event_id\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Etransfer_type\u003C/strong\u003E - Why patient transferred (ED to Inpatient, Trauma, STEMI, etc.)\u003C/li\u003E\n\u003C/ul\u003E\n\u003Ch2 id=\"location-information\"\u003ELocation Information\u003C/h2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003Edepartment_id\u003C/strong\u003E - Department ID number\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Edepartment_name\u003C/strong\u003E - Name of department/unit (e.g., \"LJ EMERGENCY DEPT\", \"HC 2-SICU\")\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Edepartment_group\u003C/strong\u003E - Care level grouping (MedSurg, ICU, PCU, OB, etc.)\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Elocation\u003C/strong\u003E - Specific location description\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Eroom_id\u003C/strong\u003E / \u003Cstrong\u003Eroom_csn_id\u003C/strong\u003E / \u003Cstrong\u003Eroom\u003C/strong\u003E - Room identifiers and name\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Ebed_id\u003C/strong\u003E / \u003Cstrong\u003Ebed_csn_id\u003C/strong\u003E / \u003Cstrong\u003Ebed\u003C/strong\u003E - Bed identifiers and name\u003C/li\u003E\n\u003C/ul\u003E\n\u003Ch2 id=\"patient-classification\"\u003EPatient Classification\u003C/h2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003Ebase_patient_class\u003C/strong\u003E - Simplified: Emergency, Inpatient, or Outpatient\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Ebase_pat_class_c\u003C/strong\u003E - Numeric code for base_patient_class\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Epatient_class\u003C/strong\u003E - Detailed class (e.g., \"Inpatient Admission\", \"Emergency Department - Encounter\")\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Epat_class_c\u003C/strong\u003E - Numeric code for patient_class\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Epatient_levelof_care\u003C/strong\u003E - Level of care needed (text)\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Epat_lvl_of_care_c\u003C/strong\u003E - Level of care code (numeric)\u003C/li\u003E\n\u003C/ul\u003E\n\u003Ch2 id=\"clinical-service\"\u003EClinical Service\u003C/h2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003Ehospital_service\u003C/strong\u003E - Which clinical team (Emergency Medicine, Cardiology, Trauma Surgery, etc.)\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Epat_service_c\u003C/strong\u003E - Numeric code for hospital_service\u003C/li\u003E\n\u003C/ul\u003E\n\u003Ch2 id=\"bed-request-tracking-often-empty\"\u003EBed Request Tracking (often empty)\u003C/h2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003Epend_id\u003C/strong\u003E - Pending bed request ID\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Ebed_request_created_dttm\u003C/strong\u003E - When bed was requested\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Ebed_request_first_readyto_plan_dttm\u003C/strong\u003E - Ready for bed planning\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Ebed_request_first_preassigned_dttm\u003C/strong\u003E - Bed pre-assigned\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Ebed_request_first_assigned_dttm\u003C/strong\u003E - Bed officially assigned\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Ebed_request_first_bed_ready_dttm\u003C/strong\u003E - Bed physically ready\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Ebed_request_first_readyto_move_dttm\u003C/strong\u003E - Patient ready to move\u003C/li\u003E\n\u003C/ul\u003E\n\u003Ch2 id=\"other\"\u003EOther\u003C/h2\u003E\n\u003Cul\u003E\n\u003Cli\u003E\u003Cstrong\u003Etc_admit_flag\u003C/strong\u003E - Flag indicating admission event\u003C/li\u003E\n\u003Cli\u003E\u003Cstrong\u003Ereferring_location\u003C/strong\u003E - Where patient was referred from\u003C/li\u003E\n\u003C/ul\u003E\n\u003Chr /\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003ETotal: 37 columns\u003C/strong\u003E\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "d5bc9105a20fdcfddc10fa3c56caaa21", "console": [], "id": "PKri", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='PKri-0' random-id='c9744bc4-5a21-963f-ca71-0a735b054370'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:849178,\u0026#92;\u0026quot;event_id\u0026#92;\u0026quot;:54864456,\u0026#92;\u0026quot;effective_time\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2025-01-01 23:59:00\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_enc_csn_id\u0026#92;\u0026quot;:66045866110,\u0026#92;\u0026quot;pat_id\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Z4894229\u0026#92;\u0026quot;,\u0026#92;\u0026quot;event_type_c\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;event_type\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;,\u0026#92;\u0026quot;linked_transfer_out_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;linked_transfer_in_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;seq_num_in_enc\u0026#92;\u0026quot;:2261.0,\u0026#92;\u0026quot;pend_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_created_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_plan_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_preassigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_assigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_bed_ready_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_move_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;department_id\u0026#92;\u0026quot;:2406651,\u0026#92;\u0026quot;department_name\u0026#92;\u0026quot;:\u0026#92;\u0026quot;UC EMERGENCY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;department_group\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;room_id\u0026#92;\u0026quot;:2036.0,\u0026#92;\u0026quot;room_csn_id\u0026#92;\u0026quot;:10460.0,\u0026#92;\u0026quot;room\u0026#92;\u0026quot;:\u0026#92;\u0026quot;PSYCHIATRY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;bed_id\u0026#92;\u0026quot;:4654.0,\u0026#92;\u0026quot;bed_csn_id\u0026#92;\u0026quot;:4700.0,\u0026#92;\u0026quot;bed\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Psych TeleMed\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_lvl_of_care_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;patient_levelof_care\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_pat_class_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_patient_class\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;pat_class_c\u0026#92;\u0026quot;:40.0,\u0026#92;\u0026quot;patient_class\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Telemedicine - Encounter\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_service_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;hospital_service\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;tc_admit_flag\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;referring_location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;transfer_type\u0026#92;\u0026quot;:NaN},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:1014858,\u0026#92;\u0026quot;event_id\u0026#92;\u0026quot;:54883995,\u0026#92;\u0026quot;effective_time\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2025-01-02 23:59:00\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_enc_csn_id\u0026#92;\u0026quot;:66045866110,\u0026#92;\u0026quot;pat_id\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Z4894229\u0026#92;\u0026quot;,\u0026#92;\u0026quot;event_type_c\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;event_type\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;,\u0026#92;\u0026quot;linked_transfer_out_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;linked_transfer_in_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;seq_num_in_enc\u0026#92;\u0026quot;:2262.0,\u0026#92;\u0026quot;pend_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_created_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_plan_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_preassigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_assigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_bed_ready_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_move_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;department_id\u0026#92;\u0026quot;:2406651,\u0026#92;\u0026quot;department_name\u0026#92;\u0026quot;:\u0026#92;\u0026quot;UC EMERGENCY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;department_group\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;room_id\u0026#92;\u0026quot;:2036.0,\u0026#92;\u0026quot;room_csn_id\u0026#92;\u0026quot;:10460.0,\u0026#92;\u0026quot;room\u0026#92;\u0026quot;:\u0026#92;\u0026quot;PSYCHIATRY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;bed_id\u0026#92;\u0026quot;:4654.0,\u0026#92;\u0026quot;bed_csn_id\u0026#92;\u0026quot;:4700.0,\u0026#92;\u0026quot;bed\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Psych TeleMed\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_lvl_of_care_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;patient_levelof_care\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_pat_class_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_patient_class\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;pat_class_c\u0026#92;\u0026quot;:40.0,\u0026#92;\u0026quot;patient_class\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Telemedicine - Encounter\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_service_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;hospital_service\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;tc_admit_flag\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;referring_location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;transfer_type\u0026#92;\u0026quot;:NaN},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:1913264,\u0026#92;\u0026quot;event_id\u0026#92;\u0026quot;:54906777,\u0026#92;\u0026quot;effective_time\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2025-01-03 23:59:00\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_enc_csn_id\u0026#92;\u0026quot;:66045866110,\u0026#92;\u0026quot;pat_id\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Z4894229\u0026#92;\u0026quot;,\u0026#92;\u0026quot;event_type_c\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;event_type\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;,\u0026#92;\u0026quot;linked_transfer_out_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;linked_transfer_in_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;seq_num_in_enc\u0026#92;\u0026quot;:2263.0,\u0026#92;\u0026quot;pend_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_created_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_plan_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_preassigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_assigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_bed_ready_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_move_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;department_id\u0026#92;\u0026quot;:2406651,\u0026#92;\u0026quot;department_name\u0026#92;\u0026quot;:\u0026#92;\u0026quot;UC EMERGENCY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;department_group\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;room_id\u0026#92;\u0026quot;:2036.0,\u0026#92;\u0026quot;room_csn_id\u0026#92;\u0026quot;:10460.0,\u0026#92;\u0026quot;room\u0026#92;\u0026quot;:\u0026#92;\u0026quot;PSYCHIATRY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;bed_id\u0026#92;\u0026quot;:4654.0,\u0026#92;\u0026quot;bed_csn_id\u0026#92;\u0026quot;:4700.0,\u0026#92;\u0026quot;bed\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Psych TeleMed\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_lvl_of_care_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;patient_levelof_care\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_pat_class_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_patient_class\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;pat_class_c\u0026#92;\u0026quot;:40.0,\u0026#92;\u0026quot;patient_class\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Telemedicine - Encounter\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_service_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;hospital_service\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;tc_admit_flag\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;referring_location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;transfer_type\u0026#92;\u0026quot;:NaN},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:1875766,\u0026#92;\u0026quot;event_id\u0026#92;\u0026quot;:54920837,\u0026#92;\u0026quot;effective_time\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2025-01-04 23:59:00\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_enc_csn_id\u0026#92;\u0026quot;:66045866110,\u0026#92;\u0026quot;pat_id\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Z4894229\u0026#92;\u0026quot;,\u0026#92;\u0026quot;event_type_c\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;event_type\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;,\u0026#92;\u0026quot;linked_transfer_out_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;linked_transfer_in_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;seq_num_in_enc\u0026#92;\u0026quot;:2264.0,\u0026#92;\u0026quot;pend_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_created_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_plan_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_preassigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_assigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_bed_ready_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_move_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;department_id\u0026#92;\u0026quot;:2406651,\u0026#92;\u0026quot;department_name\u0026#92;\u0026quot;:\u0026#92;\u0026quot;UC EMERGENCY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;department_group\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;room_id\u0026#92;\u0026quot;:2036.0,\u0026#92;\u0026quot;room_csn_id\u0026#92;\u0026quot;:10460.0,\u0026#92;\u0026quot;room\u0026#92;\u0026quot;:\u0026#92;\u0026quot;PSYCHIATRY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;bed_id\u0026#92;\u0026quot;:4654.0,\u0026#92;\u0026quot;bed_csn_id\u0026#92;\u0026quot;:4700.0,\u0026#92;\u0026quot;bed\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Psych TeleMed\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_lvl_of_care_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;patient_levelof_care\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_pat_class_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_patient_class\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;pat_class_c\u0026#92;\u0026quot;:40.0,\u0026#92;\u0026quot;patient_class\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Telemedicine - Encounter\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_service_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;hospital_service\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;tc_admit_flag\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;referring_location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;transfer_type\u0026#92;\u0026quot;:NaN},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:1597184,\u0026#92;\u0026quot;event_id\u0026#92;\u0026quot;:54934091,\u0026#92;\u0026quot;effective_time\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2025-01-05 23:59:00\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_enc_csn_id\u0026#92;\u0026quot;:66045866110,\u0026#92;\u0026quot;pat_id\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Z4894229\u0026#92;\u0026quot;,\u0026#92;\u0026quot;event_type_c\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;event_type\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;,\u0026#92;\u0026quot;linked_transfer_out_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;linked_transfer_in_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;seq_num_in_enc\u0026#92;\u0026quot;:2265.0,\u0026#92;\u0026quot;pend_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_created_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_plan_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_preassigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_assigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_bed_ready_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_move_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;department_id\u0026#92;\u0026quot;:2406651,\u0026#92;\u0026quot;department_name\u0026#92;\u0026quot;:\u0026#92;\u0026quot;UC EMERGENCY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;department_group\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;room_id\u0026#92;\u0026quot;:2036.0,\u0026#92;\u0026quot;room_csn_id\u0026#92;\u0026quot;:10460.0,\u0026#92;\u0026quot;room\u0026#92;\u0026quot;:\u0026#92;\u0026quot;PSYCHIATRY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;bed_id\u0026#92;\u0026quot;:4654.0,\u0026#92;\u0026quot;bed_csn_id\u0026#92;\u0026quot;:4700.0,\u0026#92;\u0026quot;bed\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Psych TeleMed\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_lvl_of_care_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;patient_levelof_care\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_pat_class_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_patient_class\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;pat_class_c\u0026#92;\u0026quot;:40.0,\u0026#92;\u0026quot;patient_class\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Telemedicine - Encounter\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_service_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;hospital_service\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;tc_admit_flag\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;referring_location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;transfer_type\u0026#92;\u0026quot;:NaN},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:1071874,\u0026#92;\u0026quot;event_id\u0026#92;\u0026quot;:54957590,\u0026#92;\u0026quot;effective_time\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2025-01-06 23:59:00\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_enc_csn_id\u0026#92;\u0026quot;:66045866110,\u0026#92;\u0026quot;pat_id\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Z4894229\u0026#92;\u0026quot;,\u0026#92;\u0026quot;event_type_c\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;event_type\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;,\u0026#92;\u0026quot;linked_transfer_out_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;linked_transfer_in_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;seq_num_in_enc\u0026#92;\u0026quot;:2266.0,\u0026#92;\u0026quot;pend_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_created_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_plan_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_preassigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_assigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_bed_ready_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_move_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;department_id\u0026#92;\u0026quot;:2406651,\u0026#92;\u0026quot;department_name\u0026#92;\u0026quot;:\u0026#92;\u0026quot;UC EMERGENCY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;department_group\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;room_id\u0026#92;\u0026quot;:2036.0,\u0026#92;\u0026quot;room_csn_id\u0026#92;\u0026quot;:10460.0,\u0026#92;\u0026quot;room\u0026#92;\u0026quot;:\u0026#92;\u0026quot;PSYCHIATRY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;bed_id\u0026#92;\u0026quot;:4654.0,\u0026#92;\u0026quot;bed_csn_id\u0026#92;\u0026quot;:4700.0,\u0026#92;\u0026quot;bed\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Psych TeleMed\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_lvl_of_care_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;patient_levelof_care\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_pat_class_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_patient_class\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;pat_class_c\u0026#92;\u0026quot;:40.0,\u0026#92;\u0026quot;patient_class\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Telemedicine - Encounter\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_service_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;hospital_service\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;tc_admit_flag\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;referring_location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;transfer_type\u0026#92;\u0026quot;:NaN},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:332842,\u0026#92;\u0026quot;event_id\u0026#92;\u0026quot;:54981411,\u0026#92;\u0026quot;effective_time\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2025-01-07 23:59:00\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_enc_csn_id\u0026#92;\u0026quot;:66045866110,\u0026#92;\u0026quot;pat_id\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Z4894229\u0026#92;\u0026quot;,\u0026#92;\u0026quot;event_type_c\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;event_type\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;,\u0026#92;\u0026quot;linked_transfer_out_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;linked_transfer_in_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;seq_num_in_enc\u0026#92;\u0026quot;:2267.0,\u0026#92;\u0026quot;pend_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_created_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_plan_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_preassigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_assigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_bed_ready_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_move_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;department_id\u0026#92;\u0026quot;:2406651,\u0026#92;\u0026quot;department_name\u0026#92;\u0026quot;:\u0026#92;\u0026quot;UC EMERGENCY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;department_group\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;room_id\u0026#92;\u0026quot;:2036.0,\u0026#92;\u0026quot;room_csn_id\u0026#92;\u0026quot;:10460.0,\u0026#92;\u0026quot;room\u0026#92;\u0026quot;:\u0026#92;\u0026quot;PSYCHIATRY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;bed_id\u0026#92;\u0026quot;:4654.0,\u0026#92;\u0026quot;bed_csn_id\u0026#92;\u0026quot;:4700.0,\u0026#92;\u0026quot;bed\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Psych TeleMed\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_lvl_of_care_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;patient_levelof_care\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_pat_class_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_patient_class\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;pat_class_c\u0026#92;\u0026quot;:40.0,\u0026#92;\u0026quot;patient_class\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Telemedicine - Encounter\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_service_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;hospital_service\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;tc_admit_flag\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;referring_location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;transfer_type\u0026#92;\u0026quot;:NaN},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:185540,\u0026#92;\u0026quot;event_id\u0026#92;\u0026quot;:55002554,\u0026#92;\u0026quot;effective_time\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2025-01-08 23:59:00\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_enc_csn_id\u0026#92;\u0026quot;:66045866110,\u0026#92;\u0026quot;pat_id\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Z4894229\u0026#92;\u0026quot;,\u0026#92;\u0026quot;event_type_c\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;event_type\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;,\u0026#92;\u0026quot;linked_transfer_out_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;linked_transfer_in_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;seq_num_in_enc\u0026#92;\u0026quot;:2268.0,\u0026#92;\u0026quot;pend_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_created_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_plan_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_preassigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_assigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_bed_ready_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_move_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;department_id\u0026#92;\u0026quot;:2406651,\u0026#92;\u0026quot;department_name\u0026#92;\u0026quot;:\u0026#92;\u0026quot;UC EMERGENCY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;department_group\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;room_id\u0026#92;\u0026quot;:2036.0,\u0026#92;\u0026quot;room_csn_id\u0026#92;\u0026quot;:10460.0,\u0026#92;\u0026quot;room\u0026#92;\u0026quot;:\u0026#92;\u0026quot;PSYCHIATRY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;bed_id\u0026#92;\u0026quot;:4654.0,\u0026#92;\u0026quot;bed_csn_id\u0026#92;\u0026quot;:4700.0,\u0026#92;\u0026quot;bed\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Psych TeleMed\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_lvl_of_care_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;patient_levelof_care\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_pat_class_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_patient_class\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;pat_class_c\u0026#92;\u0026quot;:40.0,\u0026#92;\u0026quot;patient_class\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Telemedicine - Encounter\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_service_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;hospital_service\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;tc_admit_flag\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;referring_location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;transfer_type\u0026#92;\u0026quot;:NaN},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:1119747,\u0026#92;\u0026quot;event_id\u0026#92;\u0026quot;:55023164,\u0026#92;\u0026quot;effective_time\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2025-01-09 23:59:00\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_enc_csn_id\u0026#92;\u0026quot;:66045866110,\u0026#92;\u0026quot;pat_id\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Z4894229\u0026#92;\u0026quot;,\u0026#92;\u0026quot;event_type_c\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;event_type\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;,\u0026#92;\u0026quot;linked_transfer_out_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;linked_transfer_in_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;seq_num_in_enc\u0026#92;\u0026quot;:2269.0,\u0026#92;\u0026quot;pend_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_created_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_plan_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_preassigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_assigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_bed_ready_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_move_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;department_id\u0026#92;\u0026quot;:2406651,\u0026#92;\u0026quot;department_name\u0026#92;\u0026quot;:\u0026#92;\u0026quot;UC EMERGENCY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;department_group\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;room_id\u0026#92;\u0026quot;:2036.0,\u0026#92;\u0026quot;room_csn_id\u0026#92;\u0026quot;:10460.0,\u0026#92;\u0026quot;room\u0026#92;\u0026quot;:\u0026#92;\u0026quot;PSYCHIATRY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;bed_id\u0026#92;\u0026quot;:4654.0,\u0026#92;\u0026quot;bed_csn_id\u0026#92;\u0026quot;:4700.0,\u0026#92;\u0026quot;bed\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Psych TeleMed\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_lvl_of_care_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;patient_levelof_care\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_pat_class_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_patient_class\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;pat_class_c\u0026#92;\u0026quot;:40.0,\u0026#92;\u0026quot;patient_class\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Telemedicine - Encounter\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_service_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;hospital_service\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;tc_admit_flag\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;referring_location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;transfer_type\u0026#92;\u0026quot;:NaN},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:1541789,\u0026#92;\u0026quot;event_id\u0026#92;\u0026quot;:55047279,\u0026#92;\u0026quot;effective_time\u0026#92;\u0026quot;:\u0026#92;\u0026quot;2025-01-10 23:59:00\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_enc_csn_id\u0026#92;\u0026quot;:66045866110,\u0026#92;\u0026quot;pat_id\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Z4894229\u0026#92;\u0026quot;,\u0026#92;\u0026quot;event_type_c\u0026#92;\u0026quot;:6,\u0026#92;\u0026quot;event_type\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;,\u0026#92;\u0026quot;linked_transfer_out_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;linked_transfer_in_event_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;seq_num_in_enc\u0026#92;\u0026quot;:2270.0,\u0026#92;\u0026quot;pend_id\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_created_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_plan_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_preassigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_assigned_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_bed_ready_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;bed_request_first_readyto_move_dttm\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;department_id\u0026#92;\u0026quot;:2406651,\u0026#92;\u0026quot;department_name\u0026#92;\u0026quot;:\u0026#92;\u0026quot;UC EMERGENCY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;department_group\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;room_id\u0026#92;\u0026quot;:2036.0,\u0026#92;\u0026quot;room_csn_id\u0026#92;\u0026quot;:10460.0,\u0026#92;\u0026quot;room\u0026#92;\u0026quot;:\u0026#92;\u0026quot;PSYCHIATRY TELEMED\u0026#92;\u0026quot;,\u0026#92;\u0026quot;bed_id\u0026#92;\u0026quot;:4654.0,\u0026#92;\u0026quot;bed_csn_id\u0026#92;\u0026quot;:4700.0,\u0026#92;\u0026quot;bed\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Psych TeleMed\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_lvl_of_care_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;patient_levelof_care\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_pat_class_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;base_patient_class\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;pat_class_c\u0026#92;\u0026quot;:40.0,\u0026#92;\u0026quot;patient_class\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Telemedicine - Encounter\u0026#92;\u0026quot;,\u0026#92;\u0026quot;pat_service_c\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;hospital_service\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;tc_admit_flag\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;referring_location\u0026#92;\u0026quot;:NaN,\u0026#92;\u0026quot;transfer_type\u0026#92;\u0026quot;:NaN}]\u0026quot;' data-total-rows='10' data-total-columns='37' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='10' data-field-types='[[\u0026quot;event_id\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;int64\u0026quot;]],[\u0026quot;effective_time\u0026quot;,[\u0026quot;datetime\u0026quot;,\u0026quot;datetime64[us]\u0026quot;]],[\u0026quot;pat_enc_csn_id\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;int64\u0026quot;]],[\u0026quot;pat_id\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;event_type_c\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;int64\u0026quot;]],[\u0026quot;event_type\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;linked_transfer_out_event_id\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;linked_transfer_in_event_id\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;seq_num_in_enc\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;pend_id\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;bed_request_created_dttm\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;bed_request_first_readyto_plan_dttm\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;bed_request_first_preassigned_dttm\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;bed_request_first_assigned_dttm\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;bed_request_first_bed_ready_dttm\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;bed_request_first_readyto_move_dttm\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;department_id\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;int64\u0026quot;]],[\u0026quot;department_name\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;department_group\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;location\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;room_id\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;room_csn_id\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;room\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;bed_id\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;bed_csn_id\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;bed\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;pat_lvl_of_care_c\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;patient_levelof_care\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;base_pat_class_c\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;base_patient_class\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;pat_class_c\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;patient_class\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;pat_service_c\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;hospital_service\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;tc_admit_flag\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;referring_location\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;transfer_type\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[[\u0026quot;\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;int64\u0026quot;]]]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "7de05d7bf75c924abf689585a7de6670", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Unique Event Types:\nevent_type\nDischarge         983931\nCensus            323411\nAdmission         229440\nTransfer Out      207300\nTransfer In       207300\nPatient Update    155746\nName: count, dtype: int64\n\nTotal unique event types: 6\n", "type": "stream"}], "id": "Xref", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "234640b03d354471cafd848379dd84cf", "console": [], "id": "SFPL", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"why-are-there-way-more-discharges-than-admissions\"\u003EWhy are there way more discharges than admissions?\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003ELooking at event types:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003EAdmissions: 229,440\u003C/li\u003E\n\u003Cli\u003EDischarges: 983,931\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003EThat's 4-5x more discharges than admissions, which doesn't make sense. You can't discharge more people than you admit.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EWhat's probably happening:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003E\"Discharge\" might include ED patients who go home without being admitted\u003C/li\u003E\n\u003Cli\u003EOutpatient visits that end also get counted as discharges\u003C/li\u003E\n\u003Cli\u003EWe need to check if this is true\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003ELet's look at what patient classes are getting \"discharged\" vs \"admitted\" to figure out what's actually going on.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "82a36d5312014b551c0f8778fdea5d89", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Discharges by Patient Class:\nTotal unique classes: 31\n\nOutpatient Radiology - Encounter: 213,371\nOutpatient Infusion - Encounter: 142,395\nEmergency Department - Encounter: 90,906\nOutpatient Radiation Oncology - Series: 78,302\nLab Referred Specimen: 61,779\nHospital Outpatient Procedure: 59,888\nOutpatient Clinic Visit - Encounter: 45,119\nOutpatient Other - Encounter: 42,504\nInpatient Admission: 38,689\nOutpatient Physical Therapy - Series: 34,727\nHospital Outpatient Surgery: 28,644\nOutpatient Chronic Dialysis - Series: 15,686\nHospital Outpatient Lab: 15,517\nOutpatient Nuclear Medicine - Series: 13,880\nOutpatient Occupational Therapy - Series: 7,989\nOutpatient Series - Apheresis: 7,387\nObservation: 5,587\nNewborn: 5,585\nOutpatient Labor and Delivery - Encounter: 4,728\nOutpatient in a Bed: 3,580\nOutpatient Burn Clinic Visit - Encounter: 2,750\nTrauma Inpatient Admission: 1,823\nTelemedicine - Encounter: 1,405\nInpatient Psychiatry: 1,175\nOutpatient Speech Therapy - Series: 1,046\nTrauma Observation Admission: 340\nSurgical OB Patient: 327\nHospital Inpatient Surgery: 193\nTrauma Outpatient: 191\nTrauma Outpatient in a Bed: 124\nOutpatient Dialysis - Series: 2\n", "type": "stream"}], "id": "BYtC", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "df0d06073bc51889cad1a8c620ff7752", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Admissions by Patient Class:\nTotal unique classes: 17\n\nEmergency Department - Encounter: 118,737\nHospital Outpatient Procedure: 50,515\nHospital Outpatient Surgery: 30,580\nOutpatient Labor and Delivery - Encounter: 9,437\nHospital Inpatient Surgery: 6,017\nNewborn: 5,565\nInpatient Admission: 3,446\nTrauma Outpatient: 2,166\nTelemedicine - Encounter: 1,442\nSurgical OB Patient: 1,089\nInpatient Psychiatry: 261\nObservation: 143\nOutpatient Other - Encounter: 18\nOutpatient in a Bed: 13\nTrauma Inpatient Admission: 7\nTrauma Observation Admission: 3\nTrauma Outpatient in a Bed: 1\n", "type": "stream"}], "id": "RGSE", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "f49686560193988658b73ba20942f15a", "console": [], "id": "Kclp", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EMost \"Discharges\" are outpatients. Looking at the discharge and admission breakdown by patient class, we found that the majority of the 983K discharges are from outpatient visits - people coming in for radiology, infusion therapy, procedures, clinic visits, etc. They come in, get their service, and leave the same day, which gets recorded as a \"discharge\" even though they were never \"admitted\" in the traditional sense. This explains why there are way more discharges than admissions overall. However, there are still weird discrepancies even within inpatient and ED encounters - for example, 38K inpatient discharges but only 3K inpatient admissions. This suggests there might be data quality issues like duplicate discharge records, missing admission records, or the event types mean something different than we expect. We need to investigate these discrepancies before we can reliably model patient flow.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "5a14694578e4b4f6f917bc1066491a5d", "console": [], "id": "OfAd", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='OfAd-0' random-id='2aa8abfb-d679-ce87-b7e3-b5ee0597493b'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;pat_enc_csn_id\u0026#92;\u0026quot;:66045866110,\u0026#92;\u0026quot;Admission\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;:364,\u0026#92;\u0026quot;Discharge\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Patient Update\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Transfer In\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Transfer Out\u0026#92;\u0026quot;:0},{\u0026#92;\u0026quot;pat_enc_csn_id\u0026#92;\u0026quot;:66119087273,\u0026#92;\u0026quot;Admission\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;:27,\u0026#92;\u0026quot;Discharge\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;Patient Update\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Transfer In\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Transfer Out\u0026#92;\u0026quot;:0},{\u0026#92;\u0026quot;pat_enc_csn_id\u0026#92;\u0026quot;:66120280389,\u0026#92;\u0026quot;Admission\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;:27,\u0026#92;\u0026quot;Discharge\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;Patient Update\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Transfer In\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Transfer Out\u0026#92;\u0026quot;:0},{\u0026#92;\u0026quot;pat_enc_csn_id\u0026#92;\u0026quot;:66126520307,\u0026#92;\u0026quot;Admission\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Discharge\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;Patient Update\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Transfer In\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Transfer Out\u0026#92;\u0026quot;:0},{\u0026#92;\u0026quot;pat_enc_csn_id\u0026#92;\u0026quot;:66129951028,\u0026#92;\u0026quot;Admission\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;:5,\u0026#92;\u0026quot;Discharge\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;Patient Update\u0026#92;\u0026quot;:3,\u0026#92;\u0026quot;Transfer In\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;Transfer Out\u0026#92;\u0026quot;:1},{\u0026#92;\u0026quot;pat_enc_csn_id\u0026#92;\u0026quot;:66136830900,\u0026#92;\u0026quot;Admission\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;Discharge\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;Patient Update\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;Transfer In\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;Transfer Out\u0026#92;\u0026quot;:1},{\u0026#92;\u0026quot;pat_enc_csn_id\u0026#92;\u0026quot;:66141034867,\u0026#92;\u0026quot;Admission\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Discharge\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;Patient Update\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Transfer In\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Transfer Out\u0026#92;\u0026quot;:0},{\u0026#92;\u0026quot;pat_enc_csn_id\u0026#92;\u0026quot;:66142438636,\u0026#92;\u0026quot;Admission\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Discharge\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;Patient Update\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Transfer In\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Transfer Out\u0026#92;\u0026quot;:0},{\u0026#92;\u0026quot;pat_enc_csn_id\u0026#92;\u0026quot;:66142438908,\u0026#92;\u0026quot;Admission\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Discharge\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;Patient Update\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Transfer In\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Transfer Out\u0026#92;\u0026quot;:0},{\u0026#92;\u0026quot;pat_enc_csn_id\u0026#92;\u0026quot;:66142752544,\u0026#92;\u0026quot;Admission\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;Census\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Discharge\u0026#92;\u0026quot;:1,\u0026#92;\u0026quot;Patient Update\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Transfer In\u0026#92;\u0026quot;:0,\u0026#92;\u0026quot;Transfer Out\u0026#92;\u0026quot;:0}]\u0026quot;' data-total-rows='984801' data-total-columns='6' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='10' data-field-types='[[\u0026quot;Admission\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;int64\u0026quot;]],[\u0026quot;Census\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;int64\u0026quot;]],[\u0026quot;Discharge\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;int64\u0026quot;]],[\u0026quot;Patient Update\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;int64\u0026quot;]],[\u0026quot;Transfer In\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;int64\u0026quot;]],[\u0026quot;Transfer Out\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;int64\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='true' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[[\u0026quot;pat_enc_csn_id\u0026quot;,[\u0026quot;integer\u0026quot;,\u0026quot;int64\u0026quot;]]]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "71ac4e8940e987afa48e59ae58d6f033", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Sample of events per encounter (first 10):\nevent_type  Admission  Census  Discharge  Patient Update  Transfer In  \\\n0                   0     364          0               0            0   \n1                   0      27          1               0            0   \n2                   0      27          1               0            0   \n3                   1       0          1               0            0   \n4                   1       5          1               3            1   \n5                   1       1          1               1            1   \n6                   1       0          1               0            0   \n7                   1       0          1               0            0   \n8                   1       0          1               0            0   \n9                   1       0          1               0            0   \n\nevent_type  Transfer Out  \n0                      0  \n1                      0  \n2                      0  \n3                      0  \n4                      1  \n5                      1  \n6                      0  \n7                      0  \n8                      0  \n9                      0  \n\nSummary stats:\nevent_type      Admission         Census      Discharge  Patient Update  \\\ncount       984801.000000  984801.000000  984801.000000   984801.000000   \nmean             0.232981       0.328402       0.999117        0.158150   \nstd              0.422731       2.606511       0.029709        0.782531   \nmin              0.000000       0.000000       0.000000        0.000000   \n25%              0.000000       0.000000       1.000000        0.000000   \n50%              0.000000       0.000000       1.000000        0.000000   \n75%              0.000000       0.000000       1.000000        0.000000   \nmax              1.000000     364.000000       1.000000       39.000000   \n\nevent_type    Transfer In   Transfer Out  \ncount       984801.000000  984801.000000  \nmean             0.210499       0.210499  \nstd              0.983287       0.983287  \nmin              0.000000       0.000000  \n25%              0.000000       0.000000  \n50%              0.000000       0.000000  \n75%              0.000000       0.000000  \nmax             68.000000      68.000000  \n", "type": "stream"}], "id": "emfo", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "f02a9793cd6a458341c5dd9e61d01468", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Encounters with discharges: 983,931\nEncounters with \u003E1 discharge: 0\n\nMax discharges in one encounter: 1\n", "type": "stream"}], "id": "Hstk", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "26ef0c3693706e8b2c201b884014f675", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Encounters with admissions: 229,440\nEncounters with \u003E1 admission: 0\n\nMax admissions in one encounter: 1\n", "type": "stream"}], "id": "nWHF", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "75e607c070b1e42a60713bfd4b1a7d80", "console": [], "id": "iLit", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ENo duplicate events, but not all encounters have admissions. We discovered that each encounter has exactly 1 discharge, no duplicates, clean data. Each encounter has exactly 1 admission (when it has one) - no duplicates, clean data. BUT only 23% of encounters have an \"Admission\" event - this is the key!\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003ELooking at the summary stats:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003EMean discharges per encounter: 0.999 (almost everyone)\u003C/li\u003E\n\u003Cli\u003EMean admissions per encounter: 0.233 (only 23%!)\u003C/li\u003E\n\u003Cli\u003EThis explains why 983K discharges vs 229K admissions\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003EWhat does this mean? Basically, outpatient visits get a \"Discharge\" when they leave, but never had an \"Admission\". ED visits that go home \"Discharge\" from ED without hospital \"Admission\". True inpatient stays should have both \"Admission\" AND \"Discharge\".\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003ESome wild outliers:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003EOne encounter has 364 Census events (daily snapshots over a year)\u003C/li\u003E\n\u003Cli\u003EOne encounter has 68 transfers!\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003EThe issue is that \"Admission\" and \"Discharge\" as event types mean different things depending on the encounter type.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EFor our patient flow model, we don't need to worry about these administrative labels. Instead, we need to focus on the Transfer events which show actual physical movement between units. Let's look at what transfer patterns exist in the data.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "a90d6c6468c7c7aa13961355268ecd13", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Unique Patient Classes:\nTotal unique patient classes: 33\nInpatient Admission: 616,028\nEmergency Department - Encounter: 307,428\nOutpatient Radiology - Encounter: 213,376\nOutpatient Infusion - Encounter: 142,395\nHospital Outpatient Procedure: 138,481\nOutpatient Radiation Oncology - Series: 78,302\nHospital Outpatient Surgery: 62,511\nLab Referred Specimen: 61,779\nNewborn: 61,247\nObservation: 45,629\nOutpatient Clinic Visit - Encounter: 45,119\nOutpatient Other - Encounter: 42,548\nOutpatient Physical Therapy - Series: 34,727\nTrauma Inpatient Admission: 29,018\nOutpatient Labor and Delivery - Encounter: 28,863\nInpatient Psychiatry: 24,856\nOutpatient in a Bed: 23,542\nOutpatient Chronic Dialysis - Series: 15,686\nHospital Outpatient Lab: 15,517\nOutpatient Nuclear Medicine - Series: 13,880\nHospital Inpatient Surgery: 10,594\nTrauma Outpatient: 8,071\nOutpatient Occupational Therapy - Series: 7,989\nOutpatient Series - Apheresis: 7,387\nTelemedicine - Encounter: 3,539\nSurgical OB Patient: 3,115\nTrauma Observation Admission: 2,786\nOutpatient Burn Clinic Visit - Encounter: 2,750\nOutpatient Speech Therapy - Series: 1,046\nTrauma Outpatient in a Bed: 621\nObservation Psychiatry: 3\nOutpatient Dialysis - Series: 2\nInpatient: 1\n", "type": "stream"}], "id": "ZHCJ", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "ba72406502acb2ad95be6bfce254f396", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Total unique departments: 219\nLJ EMERGENCY DEPT: 206,952\nHC EMERGENCY DEPT: 157,350\nEC EMERGENCY DEPT: 87,964\nJM 9-OBSTETRICS: 76,422\nMUC ONC CHEMO: 57,675\nLJ 2-PERIOP: 47,447\nMUC RADIATION ONCOLOGY: 35,074\nUCSD LAB: 34,081\nROP RADIATION ONCOLOGY: 27,184\nKOP PAIN PROCEDURES: 26,142\nHC 2-PERIOP: 25,985\nKOP ORTHO XRAY: 25,012\nMUC FAST TRACK: 24,540\nSC 2-PTU: 24,254\nLJ INTERVENTIONAL RADIOLOGY: 22,509\nKOP MAMMOGRAPHY: 21,553\nKOP CT: 20,664\nJM 10-POSTPARTUM: 19,650\nHCH OP PHYSICAL THERAPY: 19,338\nJM 8-NICU: 18,636\nKOP INFUSION CENTER: 18,036\nTHH SPECIAL PROCEDURES: 17,917\nTH 3-WEST: 17,883\nJM 10-NURSERY: 17,879\nKOP MRI: 17,850\nVIS DRAW STATION: 17,197\nTH 3-EAST: 17,054\nTH 2-WEST: 16,727\nECC ONC CHEMO: 15,854\nHC 10-EAST: 15,799\nKOP PERIOP: 15,760\nHCH CHRONIC DIALYSIS: 15,695\nTH 2-EAST: 15,683\nHCH XRAY: 15,423\nEC 6-NORTH: 15,225\nECC DRAW STATION: 15,189\nKOP XRAY: 15,156\nHC 5-WEST: 14,499\nHC 2-SICU: 14,060\nEC 5-SOUTH: 13,611\nHCH ONC CHEMO: 13,197\nHCH INTERVENTIONAL RADIOLOGY: 13,153\nHC 2-OBSTETRICS: 12,961\nMOP INFUSION CENTER: 12,939\nHC 2-TRAUMA: 12,751\nHCH CV IMAGING: 12,749\nHC 6-WEST: 12,500\nHC 7-WEST: 12,491\nHCH GIENDO: 12,394\nHC 11-EAST: 12,215\nHC 6-EAST: 12,214\nSHH PERIOP: 12,070\nEC 3-WT SBH: 11,862\nSCV CV IMAGING: 11,569\nECC RADIATION ONCOLOGY: 11,253\nKOP ULTRASOUND: 11,252\nLJ 2-SHORT STAY: 11,210\nHC 11-WEST: 10,049\nMUC PET: 9,318\nSC 3B-PCU: 9,200\nEC OP PHYSICAL THERAPY: 9,043\nHCH MRI: 9,033\nKOP BREAST ULTRASOUND: 9,023\nHC 10-CCU: 8,977\nENC HYPERBARIC MED: 8,929\nHC NBMU: 8,741\nJM 3F-ICU: 8,725\nVIS ONC CHEMO: 8,711\nHCH CT: 8,577\nHCH NUCLEAR MEDICINE: 8,404\nSC 4B-PCU: 8,380\nHC 4-EAST: 8,379\nHC 8-EAST: 8,319\nSCH CATH LAB: 8,203\nEC 2-PERIOP: 8,114\nHC 8-WEST: 7,942\nEC SPECIAL PROCEDURES: 7,941\nALT RESEARCH: 7,920\nJM 3H-ICU: 7,798\nJM 5H: 7,563\nHC 9-EAST: 7,485\nJM 4H: 7,350\nHC OUTPATIENT SURGERY: 7,327\nJM 4F: 7,183\nTH 2-CVICU: 7,183\nJM 4G: 7,181\nJM 5G: 7,066\nKOP APHERESIS: 7,059\nJM 3G-ICU: 6,995\nMOP CT: 6,930\nJM 5F: 6,836\nEC 5-NORTH: 6,804\nSC 3A-ICU: 6,606\nSC 4A-PCU: 6,558\nEC 2-ICU: 6,501\nTHH MRI: 6,491\nSC 2-PTU-INP: 6,484\nTHH OP PHYSICAL THERAPY: 6,386\nHCH INTERVENTIONAL PULMONOLOGY: 6,311\nTHH CT: 6,267\nJM 6G: 6,113\nJM 6F: 6,046\nJM 6H: 6,039\nMOP MAMMOGRAPHY: 6,005\nHCH OP OCCUPATIONAL THERAPY: 5,907\nBKH CV IMAGING: 5,847\nKOP BONE DENSITY: 5,716\nLJR MRI: 5,689\nJM 9-WOMENS SPCL CARE: 5,470\nEC 4-NORTH: 5,445\nEC 5-ICU: 5,426\nTHH ULTRASOUND: 5,352\nVTC INFUSION CENTER: 5,343\nTHH PFT LAB: 5,315\nMOP SPECIALTY PROCEDURES: 5,276\nUSS XRAY: 5,191\nHCH PFT LAB: 5,017\nJM 9-BIRTH CENTER: 4,894\nHCH ULTRASOUND: 4,771\nMOP ORTHO XRAY: 4,647\nTHH NUCLEAR MEDICINE: 4,602\nMOP ULTRASOUND: 4,564\nMOP XRAY: 4,381\nHC 5-BURN ICU: 4,332\nMOP RADIATION ONCOLOGY: 4,065\nLWC MAMMOGRAPHY: 3,996\nHC OP MRI: 3,975\nHC 2-NURSERY: 3,957\nUNC XRAY: 3,922\nEC INTERVENTIONAL RADIOLOGY: 3,919\nHC 9-WEST: 3,898\nHCH HYPERBARIC MED: 3,772\nHC 5-BURN SP CARE: 3,750\nMOP MRI: 3,658\nHCH CARDIAC RECOVERY: 3,436\nTHH EP LAB: 3,359\nMOP ENDOSCOPY PROCEDURES: 3,319\nHC 7-EAST SBH: 3,198\nUC HYPERACUTE TELEMED: 3,177\nALT MRI: 3,171\nMOP PET: 3,015\nEXE VASCULAR IMAGING: 2,838\nHCH BURN: 2,761\nCTI MRI: 2,725\nHCH CATH LAB: 2,523\nMOP OP SURG PERIOP: 2,373\nEC ULTRASOUND: 2,279\nKOP VASCULAR LAB: 2,278\nMUC MOBILE PET/CT: 2,245\nMOP BONE DENSITY: 2,221\nLWC XRAY: 2,145\nHC 2-ISCC: 2,057\nMOP BREAST ULTRASOUND: 2,038\nHCH HNS AUDIOLOGY: 1,916\nEC CT: 1,915\nEC CV IMAGING: 1,870\nHCH EP LAB: 1,812\nEC MRI: 1,771\nHC 7-EAST: 1,752\nLWC BONE DENSITY: 1,740\nUCSD TRANSPLANT BMT: 1,687\nUSS PFT LAB: 1,608\nENCINITAS SURGERY CTR: 1,559\nTHH XRAY: 1,551\nMON VASCULAR LAB: 1,508\nSCSD DIR PL: 1,414\nMOP VASCULAR IMAGING: 1,378\nMUC MRI: 1,299\nMUC PROCEDURE ROOM: 1,243\nHCH MOTILITY: 1,229\nTHH OP OCCUPATIONAL THERAPY: 1,227\nEC 4-SOUTH: 1,212\nEC XRAY: 1,056\nUASC OUTPATIENT SURGERY: 1,011\nEC CATH LAB: 940\nEC OP OCCUPATIONAL THERAPY: 817\nHC 4-BIRTH CENTER: 811\nMOP MOTILITY: 776\nKOP PAIN TX ROOM: 765\nHC 4-NURSERY: 758\nHCH SPEECH THERAPY: 699\nMUC CT: 677\nMON EEG: 643\nTHH EEG: 610\nGEN ESOPHAGEAL MOTILITY: 564\nMUC RAD ONC PROCEDURES: 496\nMOP RAD ONC PROCEDURES: 477\nUC ORGAN PERFUSION: 476\nHCH RADIO-INFUSIONS: 466\nTHH MOTILITY: 462\nEC NUCLEAR MEDICINE: 402\nPATIENT FINANCIAL SVCS: 391\nUC EMERGENCY TELEMED: 364\nEXE OP VASCULAR LAB: 341\nEC SPEECH THERAPY: 300\nGEN OBGYN PROCEDURES: 287\nMUC APHERESIS: 270\nUTC MOTILITY: 223\nZZZ EC 4-CUSTODY: 149\nKOP UROLOGY XRAY: 148\nSCV CT: 106\nKOP PAIN MGMT XRAY: 89\nUCSD QI MEG: 84\nHCH APHERESIS: 59\nFRO RESEARCH: 55\nMOP VASCULAR PROCEDURES: 47\nJMC XRAY: 40\nRANCHO SPRINGS MED CTR: 39\nALT US: 20\nJM ADMITTING: 18\nUCSD FREE CLINIC US: 17\nSCV XRAY: 7\nMOP OCCUPATIONAL THERAPY: 6\nMUC ONCOLOGY: 4\nMUC MAMMOGRAPHY: 4\nKOP STEM CELL PROCEDURE ROOM: 1\nPMC XRAY: 1\nMOP HNS AUDIOLOGY: 1\nREPRODUCTIVE PARTNERS: 1\n", "type": "stream"}], "id": "ROlb", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "666138ac22488079556b53d52c777832", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Unique Department Groupings:\ndepartment_group\nMedSurg              120979\nOB                   120208\nPCU                  117717\nICU                   77661\nIMU                   60804\nMedSTele              32526\nBehavioral Health     23801\nNursery               22594\nNICU                  20693\nName: count, dtype: int64\n\nTotal unique department groups: 9\n", "type": "stream"}], "id": "qnkX", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "884e2db34551e05eb90c27b1eed10c4f", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Total unique hospital services: 118\nEmergency Medicine: 311,183\nOBGYN: 98,455\nNewborn Nursery: 40,196\nTrauma Surgery: 39,915\nMedicine La Jolla Unassigned: 35,067\nInterventional Radiology: 34,162\nGastroenterology: 33,613\nMedicine East Campus Unassigned: 32,912\nPain Service: 30,809\nGeneral Medicine: 29,016\nPsychiatry: 27,557\nBone Marrow Transplant: 24,083\nCardiology Interventional: 22,883\nCardiothoracic Surgery: 21,281\nNeonatology: 20,826\nMedicine Hillcrest Unassigned: 19,740\nPulmonary / Critical Care (LJ): 19,249\nCardiology Sulpizio General: 18,580\nPulmonary / Critical Care (HC): 17,867\nUrology: 17,660\nNeurosurgery: 17,558\nCardiology Sulpizio Heart Failure: 15,345\nOrtho General: 15,174\nCardiology Electrophysiology: 13,583\nOphthalmology: 12,712\nMedicine Hillcrest  2: 11,831\nMedicine Hillcrest  3: 11,823\nMedicine Hillcrest  1: 11,773\nSurgery Colorectal (LJ): 11,517\nMedicine Hillcrest  4: 11,444\nSurgical Oncology (LJ): 11,435\nMedicine Hillcrest  6: 11,432\nMedicine Hillcrest  5: 11,363\nHead \u0026 Neck Surgery: 10,643\nNeuro Critical Care: 10,582\nFamily Medicine: 10,198\nCardiology Hillcrest Gen / HF: 10,171\nMidwife Service: 9,053\nMedicine La Jolla  3: 9,001\nMedicine La Jolla  5: 8,927\nMedicine La Jolla  1: 8,879\nMedicine Hillcrest  7: 8,799\nMedicine La Jolla  4: 8,771\nMedicine La Jolla  6: 8,424\nMedicine La Jolla  8: 8,250\nMedicine La Jolla  7: 8,196\nMedicine La Jolla  9: 8,008\nNeuro Stroke: 7,952\nMedicine La Jolla 10: 7,880\nMedicine La Jolla  2: 7,458\nACCM Critical Care: 7,348\nMedicine La Jolla 11: 7,077\nPlastic Surgery: 7,054\nBurn Surgery: 7,028\nNeurology: 7,003\nGynecology Oncology: 6,656\nOrtho Spine: 6,547\nEmergency General Surgery (HC): 6,505\nVascular Surgery (LJ): 6,381\nSurgery Subspecialties (HC): 5,924\nPulmonary Vascular Medicine: 5,796\nSurgery Minimally Invasive (LJ): 5,407\nOrtho Joint: 5,401\nEmergency General Surgery (LJ): 5,155\nTransplant Surgery: 4,905\nSurgical Critical Care: 3,914\nMedicine East Campus 1: 3,856\nGynecology: 3,761\nGeneral Surgery: 3,561\nMedicine Hillcrest  9: 2,866\nTransplant Surgery, Liver: 2,656\nMedicine Hillcrest  8: 2,541\nOrtho Trauma: 2,211\nMedicine East Campus 5: 2,129\nTransplant Surgery, Kidney: 2,102\nMedicine La Jolla 12: 1,801\nOrtho Hand: 1,155\nVascular Surgery (HC): 943\nMedicine Hillcrest Teach Overflow: 842\nCritical Care (EC): 651\nOrtho Oncology: 574\nMedicine Hillcrest 10: 540\nCell / Regenerative Medicine: 408\nCardiology Heart Failure (EC): 357\nNeurology Oncology: 353\nMedicine East Campus 6: 335\nOrtho Foot: 280\nMedicine East Campus 4: 130\nMedicine Hillcrest 11: 123\nUrogynecology: 117\nOB High Risk: 98\nMedicine La Jolla 13: 93\nMedicine East Campus 2: 78\nJacobs Surgical Critical Care: 51\nAnesthesiology: 42\nPathology: 36\nTelemedicine East Campus: 32\nNephrology: 14\nOrtho Rehab: 14\nHepatology: 12\nTelemedicine Hillcrest: 12\nPediatric Surgery: 12\nAncillary/Lab: 10\nMedicine East Campus 3: 10\nStroke SCVC: 9\nPediatric Pulmonary Medicine: 8\nHematology/Oncology: 7\nAdolescent Psychiatry: 6\nED Urgent Care: 6\nRadiology MRI: 3\nOrtho Sports Med: 2\nMedicine Hillcrest 12: 2\nPediatrics General: 2\nLifesharing: 2\nObstetrics: 1\nMCC Infusion Center: 1\nSurg Dental Care: 1\nPediatric Cardiology: 1\n", "type": "stream"}], "id": "TqIu", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "c4c5d25fee7e80abeac56583a19e84be", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Total unique transfer types: 12\nInpatient to Inpatient: 26,139\nED to Inpatient: 16,344\nED to ED: 14,184\nTrauma: 11,336\nPTU: 2,593\nECMO: 1,504\nCMH: 1,050\nStroke: 757\nTransplant: 307\nSTEMI: 274\nLVAD: 97\nBurn: 21\n", "type": "stream"}], "id": "Vxnm", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "aa3c363f6e423e411b9a50c7b8a6c1d6", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Transfers by department group:\ndepartment_group\nOB                   50241\nMedSurg              34207\nPCU                  27195\nICU                  24187\nIMU                  16756\nMedSTele              8833\nNursery               7280\nBehavioral Health     3977\nNICU                  3658\nName: count, dtype: int64\n", "type": "stream"}], "id": "DnEU", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "e11336cdaca7c42e9addf0e72efd5abf", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Unique Base Patient Classes:\nbase_patient_class\nEmergency     118737\nOutpatient    103257\nInpatient      47799\nName: count, dtype: int64\n\nTotal unique base patient classes: 3\n", "type": "stream"}], "id": "ulZA", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "aec438bd62b85b58b26b5ca127e8119d", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Encounters with class changes: 47,201\nTotal encounters: 984,801\n", "type": "stream"}], "id": "ecfG", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "0662983f0e930a744b90a7fa110763e4", "console": [], "id": "Pvdt", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ELooking at the transfer data, we can see clear patterns of patient movement:\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003ETransfer Types:\u003C/strong\u003E\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003EInpatient to Inpatient: 26,139 (most common - patients moving between units)\u003C/li\u003E\n\u003Cli\u003EED to Inpatient: 16,344 (patients getting admitted from ED)\u003C/li\u003E\n\u003Cli\u003EED to ED: 14,184 (transfers between emergency departments)\u003C/li\u003E\n\u003Cli\u003ETrauma: 11,336 (trauma activations)\u003C/li\u003E\n\u003Cli\u003ESpecialty transfers: ECMO, Stroke, STEMI, Transplant, Burn (time-sensitive care)\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003ETransfer Activity by Tier:\u003C/strong\u003E\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003EOB: 50,241 transfers (obstetrics - lots of movement)\u003C/li\u003E\n\u003Cli\u003EMedSurg: 34,207 (general medical/surgical floors - Tier 2)\u003C/li\u003E\n\u003Cli\u003EPCU: 27,195 (progressive care - Tier 2)\u003C/li\u003E\n\u003Cli\u003EICU: 24,187 (intensive care - Tier 3)\u003C/li\u003E\n\u003Cli\u003EIMU: 16,756 (intermediate medical - Tier 2)\u003C/li\u003E\n\u003Cli\u003ENICU: 3,658 (neonatal intensive care - Tier 3)\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003EWe have good transfer data across all three tiers. The transfer events will let us build a transition matrix showing how patients move between ED, regular floors, and ICU across the different hospitals.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003ENext step is to filter the data to focus on encounters with actual patient flow (those with transfers), then build the transition matrix.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "3e6ea9bf0a4891ad9cf2a1ded2e33d4e", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Events per encounter:\nMin: 1\nMax: 451\nMean: 2.14\nMedian: 1\n\nEncounters with only 1 event: 754,627\nPercentage: 76.6%\n", "type": "stream"}], "id": "ZBYS", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "8060a46acad1be98e9980805c5ae16eb", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Total encounters: 984,801\nEncounters WITH transfers: 83,423\nEncounters WITHOUT transfers: 901,378\nPercentage without transfers: 91.5%\n", "type": "stream"}], "id": "aLJB", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "1ae03d821a483388f54946037b79104f", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Single event encounters by event type:\nevent_type\nDischarge         983931\nCensus            323411\nAdmission         229440\nTransfer Out      207300\nTransfer In       207300\nPatient Update    155746\nName: count, dtype: int64\n\nSingle event encounters by patient class:\npatient_class\nInpatient Admission                       616028\nEmergency Department - Encounter          307428\nOutpatient Radiology - Encounter          213376\nOutpatient Infusion - Encounter           142395\nHospital Outpatient Procedure             138481\nOutpatient Radiation Oncology - Series     78302\nHospital Outpatient Surgery                62511\nLab Referred Specimen                      61779\nNewborn                                    61247\nObservation                                45629\nName: count, dtype: int64\n", "type": "stream"}], "id": "nHfw", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "758484c0ac92c2de9bc6f2acd85923ec", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Total linked transfers: 207,300\n\nTransfers within SAME department: 82,058\nTransfers to DIFFERENT department: 125,242\n", "type": "stream"}], "id": "xXTn", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "0c75468c71b0608a26cca1f47e394215", "console": [], "id": "AjVT", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EIssue 1: Most encounters have only 1 event (76.6%)\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003EThese are mostly outpatient visits (radiology, infusion, procedures)\u003C/li\u003E\n\u003Cli\u003EAlso ED visits that discharge home\u003C/li\u003E\n\u003Cli\u003EThey have 1 event and leave - no patient flow to model, at least for right now while we build the simple model.\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003EIssue 2: 91.5% of encounters have NO transfers\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003EOnly 83,423 encounters (8.5%) actually have transfer events between units\u003C/li\u003E\n\u003Cli\u003EBUT this doesn't mean the other 91.5% are irrelevant!\u003C/li\u003E\n\u003Cli\u003EMany are still valid patient flow: ED \u2192 Discharge, ICU \u2192 Discharge (these are important transitions)\u003C/li\u003E\n\u003Cli\u003EThe real question is what TYPE of encounters to include (ED/ICU/Floor vs Outpatient), not whether they have transfers\u003C/li\u003E\n\u003Cli\u003EWe'll decide which encounter types to keep after looking at the data more carefully\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003EIssue 3: Same Department Bed Changes\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003E\n\u003Cspan class=\"paragraph\"\u003EOut of 207,300 total transfers:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003E82,058 (40%) are within the SAME department - just bed changes!\u003C/li\u003E\n\u003Cli\u003E125,242 (60%) are to DIFFERENT departments - actual patient flow!\u003C/li\u003E\n\u003Cli\u003EWe need to filter these out.\u003C/li\u003E\n\u003C/ul\u003E\n\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003EWhat This Means for Data Cleaning:\u003C/span\u003E\n\u003Col\u003E\n\u003Cli\u003EFilter by encounter TYPE (keep ED/ICU/Floor, remove outpatient), not by whether they have transfers\u003C/li\u003E\n\u003Cli\u003EOnly use transfers to DIFFERENT departments (125,242 transfers)\u003C/li\u003E\n\u003Cli\u003EIgnore same-department bed shuffles (82,058 transfers)\u003C/li\u003E\n\u003C/ol\u003E\n\u003Cspan class=\"paragraph\"\u003EThis will give us clean patient flow data for the transition matrix.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "ea12cb960b86dbaa09f65c432622c089", "console": [], "id": "pHFh", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EWhat Encounters Do We Have?\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003EBefore filtering, let's see all the encounter types and decide which ones are relevant for ED \u2192 Floor \u2192 ICU flow modeling.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "5d8170c31e578946d9e53a1f546ecde1", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Patient Class + Department Group combinations:\n                            patient_class  department_group  count\n                      Inpatient Admission           MedSurg 107792\n                      Inpatient Admission               PCU  98693\n                      Inpatient Admission                OB  69009\n                      Inpatient Admission               ICU  66185\n                      Inpatient Admission               IMU  56266\n                      Inpatient Admission          MedSTele  30523\nOutpatient Labor and Delivery - Encounter                OB  28839\n                     Inpatient Psychiatry Behavioral Health  23798\n                                  Newborn           Nursery  22590\n                                  Newborn              NICU  20682\n                                  Newborn                OB  17921\n               Trauma Inpatient Admission               PCU  13856\n               Trauma Inpatient Admission               ICU   7283\n                              Observation           MedSurg   6679\n                      Outpatient in a Bed           MedSurg   5514\n                              Observation               IMU   3243\n                      Surgical OB Patient                OB   3111\n                      Outpatient in a Bed               ICU   2968\n                              Observation               PCU   1842\n             Trauma Observation Admission               PCU   1487\n                      Outpatient in a Bed               PCU   1184\n                              Observation          MedSTele   1170\n                              Observation                OB   1053\n                      Outpatient in a Bed               IMU    865\n               Trauma Inpatient Admission           MedSurg    862\n                      Outpatient in a Bed          MedSTele    763\n                              Observation               ICU    538\n               Trauma Outpatient in a Bed               PCU    414\n               Trauma Inpatient Admission               IMU    409\n               Hospital Inpatient Surgery               ICU    404\n               Hospital Inpatient Surgery               PCU    238\n            Hospital Outpatient Procedure               ICU    176\n               Hospital Inpatient Surgery           MedSurg     84\n                      Outpatient in a Bed                OB     81\n             Trauma Observation Admission               ICU     58\n             Trauma Observation Admission                OB     53\n               Trauma Inpatient Admission          MedSTele     53\n               Trauma Inpatient Admission                OB     44\n              Hospital Outpatient Surgery               ICU     33\n             Trauma Observation Admission           MedSurg     29\n            Hospital Outpatient Procedure                OB     27\n              Hospital Outpatient Surgery                OB     24\n               Hospital Inpatient Surgery                OB     23\n               Trauma Outpatient in a Bed           MedSurg     19\n               Hospital Inpatient Surgery               IMU     17\n               Trauma Outpatient in a Bed               ICU     16\n               Hospital Inpatient Surgery          MedSTele      9\n                        Trauma Outpatient                OB      9\n                      Inpatient Admission              NICU      7\n             Trauma Observation Admission          MedSTele      4\n               Trauma Outpatient in a Bed               IMU      4\n         Emergency Department - Encounter          MedSTele      4\n                              Observation           Nursery      4\n                              Observation              NICU      3\n         Emergency Department - Encounter               PCU      3\n                   Observation Psychiatry Behavioral Health      3\n                                Inpatient              NICU      1\n", "type": "stream"}], "id": "NCOB", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "d6062f341bc1ee5a3c472b5fdb456f80", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "\nPatient classes in ED:\npatient_class\nEmergency Department - Encounter             303870\nInpatient Admission                          119632\nObservation                                   26868\nOutpatient in a Bed                            1709\nTelemedicine - Encounter                        364\nHospital Outpatient Surgery                     103\nHospital Outpatient Procedure                    56\nOutpatient Labor and Delivery - Encounter        24\nInpatient Psychiatry                              2\nNewborn                                           2\nName: count, dtype: int64\n", "type": "stream"}], "id": "aqbW", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "b4b48e3e9350a589a02eebb3105cbe03", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "\nPatient classes in ICU:\npatient_class\nInpatient Admission              66185\nTrauma Inpatient Admission        7283\nOutpatient in a Bed               2968\nObservation                        538\nHospital Inpatient Surgery         404\nHospital Outpatient Procedure      176\nTrauma Observation Admission        58\nHospital Outpatient Surgery         33\nTrauma Outpatient in a Bed          16\nName: count, dtype: int64\n", "type": "stream"}], "id": "TRpd", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "e8df0678e165ab8ddecb7f3132b1de0f", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "\nPatient classes on Floors (MedSurg/PCU/IMU):\npatient_class\nInpatient Admission                 262751\nTrauma Inpatient Admission           15127\nObservation                          11764\nOutpatient in a Bed                   7563\nTrauma Observation Admission          1516\nTrauma Outpatient in a Bed             437\nHospital Inpatient Surgery             339\nEmergency Department - Encounter         3\nName: count, dtype: int64\n", "type": "stream"}], "id": "TXez", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "22ff1655aae2e4503b8f36694a40f9b4", "console": [], "id": "dNNg", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"data-filtering-plan-what-we-are-keeping-vs-removing-and-why\"\u003EData Filtering Plan: What We Are Keeping vs Removing and Why\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EKeeping patients who occupy beds and can move between units:\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003EInpatient Admission\u003C/li\u003E\n\u003Cli\u003EEmergency Department - Encounter\u003C/li\u003E\n\u003Cli\u003ETrauma Inpatient Admission\u003C/li\u003E\n\u003Cli\u003EObservation\u003C/li\u003E\n\u003Cli\u003ETrauma Observation Admission\u003C/li\u003E\n\u003Cli\u003EHospital Inpatient Surgery\u003C/li\u003E\n\u003Cli\u003EInpatient Psychiatry\u003C/li\u003E\n\u003Cli\u003ENewborn\u003C/li\u003E\n\u003Cli\u003ESurgical OB Patient\u003C/li\u003E\n\u003Cli\u003EOutpatient in a Bed (they're in ICU/MedSurg/PCU - physical beds!)\u003C/li\u003E\n\u003Cli\u003EOutpatient Labor and Delivery - Encounter (in OB units)\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003ERemoving same-day outpatient services (no bed, no movement):\u003C/span\u003E\n\u003Cul\u003E\n\u003Cli\u003EOutpatient Radiology - Encounter\u003C/li\u003E\n\u003Cli\u003EOutpatient Infusion - Encounter\u003C/li\u003E\n\u003Cli\u003EOutpatient Radiation Oncology - Series\u003C/li\u003E\n\u003Cli\u003EHospital Outpatient Procedure\u003C/li\u003E\n\u003Cli\u003EHospital Outpatient Surgery\u003C/li\u003E\n\u003Cli\u003EOutpatient Clinic Visit - Encounter\u003C/li\u003E\n\u003Cli\u003EOutpatient Physical Therapy - Series\u003C/li\u003E\n\u003Cli\u003EOutpatient Other - Encounter\u003C/li\u003E\n\u003Cli\u003ELab Referred Specimen\u003C/li\u003E\n\u003Cli\u003ETelemedicine - Encounter\u003C/li\u003E\n\u003Cli\u003EAll other \"Outpatient [service] - Series/Encounter\"\u003C/li\u003E\n\u003Cli\u003ETrauma Outpatient (unless in a bed)\u003C/li\u003E\n\u003C/ul\u003E\n\u003Cspan class=\"paragraph\"\u003EThis will give us clean patient flow data for the 9\u00d710 transition matrix.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "5eb214e5ef25128a3a3a24cc8fb07f0b", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Original data: 2,107,128 rows, 984,801 encounters\nFiltered data: 1,153,106 rows, 153,878 encounters\nRemoved: 954,022 rows (45.3%)\n", "type": "stream"}], "id": "yCnT", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "4991d0f9d735457aff1bb0c2be1ea725", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Removed Patient Classes:\nTotal classes removed: 22\n\nOutpatient Radiology - Encounter: 213,376\nOutpatient Infusion - Encounter: 142,395\nHospital Outpatient Procedure: 138,481\nOutpatient Radiation Oncology - Series: 78,302\nHospital Outpatient Surgery: 62,511\nLab Referred Specimen: 61,779\nOutpatient Clinic Visit - Encounter: 45,119\nOutpatient Other - Encounter: 42,548\nOutpatient Physical Therapy - Series: 34,727\nOutpatient Chronic Dialysis - Series: 15,686\nHospital Outpatient Lab: 15,517\nOutpatient Nuclear Medicine - Series: 13,880\nTrauma Outpatient: 8,071\nOutpatient Occupational Therapy - Series: 7,989\nOutpatient Series - Apheresis: 7,387\nTelemedicine - Encounter: 3,539\nOutpatient Burn Clinic Visit - Encounter: 2,750\nOutpatient Speech Therapy - Series: 1,046\nTrauma Outpatient in a Bed: 621\nObservation Psychiatry: 3\nOutpatient Dialysis - Series: 2\nInpatient: 1\n", "type": "stream"}], "id": "wlCL", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "c787e4c240b9cc4235a31b1bda1903c5", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "\nKept Patient Classes:\npatient_class\nInpatient Admission                 616028\nEmergency Department - Encounter    307428\nNewborn                              61247\nObservation                          45629\nTrauma Inpatient Admission           29018\n                                     ...  \nInpatient Psychiatry                 24856\nOutpatient in a Bed                  23542\nHospital Inpatient Surgery           10594\nSurgical OB Patient                   3115\nTrauma Observation Admission          2786\nName: count, Length: 11, dtype: int64\n", "type": "stream"}], "id": "kqZH", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "cae27eeb5c8ee31caf7afede0d01c209", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "\nFiltered encounters: 153,878\nFiltered encounters with transfers: 73,904\nPercentage with transfers: 48.0%\n", "type": "stream"}], "id": "wAgl", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "e8f95cfefc0cfaac56b7f007fd882165", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "\nDepartment Groups in Filtered Data:\ndepartment_group\nMedSurg              120960\nOB                   120134\nPCU                  117303\nICU                   77436\nIMU                   60800\nMedSTele              32526\nBehavioral Health     23798\nNursery               22594\nNICU                  20692\nName: count, dtype: int64\n", "type": "stream"}], "id": "rEll", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "a38f9262c644d291718799963fffd1c8", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Events per encounter in filtered data:\nMin: 1\nMean: 7.49\nMedian: 3\n\nEncounters with only 1 event: 1,720\nPercentage: 1.1%\n", "type": "stream"}], "id": "dGlV", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "13a7798ca37e4f4384bd947a02d3d234", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "\nSingle Event Encounters (after filtering):\nBy event type:\nevent_type\nDischarge    1697\nAdmission      23\nName: count, dtype: int64\n\nBy patient class:\npatient_class\nEmergency Department - Encounter    933\nInpatient Admission                 500\nTrauma Inpatient Admission          185\nHospital Inpatient Surgery           44\nObservation                          14\nName: count, dtype: int64\n\nBy department group:\ndepartment_group\nOB         138\nPCU         23\nMedSurg     22\nNursery     10\nIMU          9\nName: count, dtype: int64\n", "type": "stream"}], "id": "SdmI", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "dc32b07a74715cf565a7d5007aee2d58", "console": [], "id": "lgWD", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThese data quality checks looks good, the filter worked as intended. Now moving on to other data quality checks.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "cc7744bea38f66f211c963c0787d4929", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Missing Values in Key Fields:\nMissing effective_time: 0\nMissing department_name: 0\nMissing department_group: 556,863\nMissing event_type: 0\n", "type": "stream"}], "id": "yOPj", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "d50de6c40f59542f40ebf8eb851519bd", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "\nDischarge Events:\nTotal encounters: 153,878\nEncounters with Discharge: 152,933\nEncounters without Discharge: 945\nPercentage missing discharge: 0.6%\n", "type": "stream"}], "id": "fwwy", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "0b4623bf778786f8780496b00db03759", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "\nLength of Stay Distribution:\ncount    153878.000000\nmean          2.119385\nstd           6.231043\nmin           0.000000\n25%           0.105556\n50%           0.227778\n75%           1.902778\nmax         299.515972\nName: los_days, dtype: float64\nEncounters with LOS \u003E 180 days: 10\n", "type": "stream"}], "id": "LJZf", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "7a5314c853dd021f1524143753dfa3d4", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Encounters with LOS=0: 1,720\n\nEvents per encounter for LOS=0:\n1    1720\nName: count, dtype: int64\n\nEvent types for LOS=0:\nevent_type\nDischarge    1697\nAdmission      23\nName: count, dtype: int64\n\nPatient class for LOS=0:\npatient_class\nEmergency Department - Encounter             933\nInpatient Admission                          500\nTrauma Inpatient Admission                   185\nHospital Inpatient Surgery                    44\nObservation                                   14\nNewborn                                       13\nOutpatient Labor and Delivery - Encounter     12\nTrauma Observation Admission                  12\nOutpatient in a Bed                            5\nInpatient Psychiatry                           1\nName: count, dtype: int64\n", "type": "stream"}], "id": "urSm", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "6664e603c146e7e36bb1ff307251e46e", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "count    1720.000000\nmean        1.079651\nstd         0.748117\nmin         1.000000\n25%         1.000000\n50%         1.000000\n75%         1.000000\nmax        16.000000\ndtype: float64\npatient_class\nEmergency Department - Encounter             933\nInpatient Admission                          500\nTrauma Inpatient Admission                   185\nHospital Outpatient Surgery                   92\nHospital Outpatient Procedure                 45\nHospital Inpatient Surgery                    44\nObservation                                   14\nNewborn                                       13\nOutpatient Labor and Delivery - Encounter     12\nTrauma Observation Admission                  12\nName: count, dtype: int64\n", "type": "stream"}], "id": "jxvo", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "d9bf0a5cc3e88fbe7caf40116abf34d1", "console": [], "id": "mWxS", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003E1,720 encounters (1.1% of 153,878) have only a single event in df_filtered, resulting in LOS = 0.\nThese are not filtering artifacts \u2014 they had only ~1 event in the original data too (mean 1.08).\nThey are incomplete records (orphan discharges, registration-only entries) and contribute no\ntransitions. Dropping them to keep only encounters with 2+ events.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "ecd6e2284451cc0ed6778ed20b2475fd", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Remaining encounters: 152,158\nRemaining events: 1,151,386\n", "type": "stream"}], "id": "CcZR", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "088368f4b4b6f18e0cf1d29416ee1e18", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "\nEvent Ordering:\nEncounters checked: 152158\nEncounters with seq_num out of order: 8490\n", "type": "stream"}], "id": "YWSi", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "a5f71284cf30491290a226b2d99d9649", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Encounters with multiple patient classes (BEFORE filter): 47,201\nEncounters with multiple patient classes (AFTER filter): 40,731\n", "type": "stream"}], "id": "zlud", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "2e677d7d35641b6fda696ec8b1135552", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Example Encounter with Multiple Classes: 66129951028:\n\nTotal events in this encounter: 12\n\n\nEvent: Admission       | Time: 2025-06-06 05:27:00 | Class: Hospital Inpatient Surgery     | Dept: LJ 2-PERIOP                    | Group: nan\nEvent: Patient Update  | Time: 2025-06-06 12:23:00 | Class: Inpatient Admission            | Dept: LJ 2-PERIOP                    | Group: nan\nEvent: Transfer Out    | Time: 2025-06-06 17:00:00 | Class: Inpatient Admission            | Dept: LJ 2-PERIOP                    | Group: nan\nEvent: Transfer In     | Time: 2025-06-06 17:00:00 | Class: Inpatient Admission            | Dept: JM 4F                          | Group: PCU\nEvent: Census          | Time: 2025-06-06 23:59:00 | Class: Inpatient Admission            | Dept: JM 4F                          | Group: PCU\nEvent: Patient Update  | Time: 2025-06-07 08:15:00 | Class: Inpatient Admission            | Dept: JM 4F                          | Group: PCU\nEvent: Patient Update  | Time: 2025-06-07 09:27:00 | Class: Inpatient Admission            | Dept: JM 4F                          | Group: PCU\nEvent: Census          | Time: 2025-06-07 23:59:00 | Class: Inpatient Admission            | Dept: JM 4F                          | Group: PCU\nEvent: Census          | Time: 2025-06-08 23:59:00 | Class: Inpatient Admission            | Dept: JM 4F                          | Group: PCU\nEvent: Census          | Time: 2025-06-09 23:59:00 | Class: Inpatient Admission            | Dept: JM 4F                          | Group: PCU\nEvent: Census          | Time: 2025-06-10 23:59:00 | Class: Inpatient Admission            | Dept: JM 4F                          | Group: PCU\nEvent: Discharge       | Time: 2025-06-11 12:50:00 | Class: Inpatient Admission            | Dept: JM 4F                          | Group: PCU\n", "type": "stream"}], "id": "tZnO", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "b0920a6532e1634e3d6408a1fa64f63e", "console": [], "id": "xvXZ", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003ELooking at encounters with multiple patient classes, we found that it's completely normal for patient_class to change during a hospital stay. For example, a patient might start as \"Hospital Inpatient Surgery\" in a perioperative area, then get updated to \"Inpatient Admission\" once they transfer to an actual inpatient unit. This explains why we have 40,731 encounters with multiple patient classes after filtering. The 556,863 missing department_group values are from events in perioperative areas, holding areas, recovery rooms, and other pre-admission locations that don't fit into the ED/Floor/ICU tier system. These aren't data errors - they're just areas we don't need to model. For the transition matrix, we'll only use events where department_group exists, which represents when patients are actually in one of our three tiers (ED, Floor, ICU).\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "a45fbd1ea13fead4ac2101d78df0b713", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Encounters with timestamps going BACKWARDS: 0\n", "type": "stream"}], "id": "CLip", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "f9b8f6b7c692f9e71981fbcfa2791937", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Encounter with Sequencing Issue: 66185614861:\n\n", "type": "stream"}], "id": "YECM", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "8670bc02262e19b23e957486c8fa38f2", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Before Filtering (Original Data):\nseq=1 | 2025-01-04 20:02:00 | Patient Update  | Inpatient Admission           \nseq=2 | 2025-01-04 21:00:00 | Patient Update  | Inpatient Admission           \nseq=3 | 2025-01-04 21:50:00 | Transfer Out    | Inpatient Admission           \nseq=4 | 2025-01-04 21:50:00 | Transfer In     | Inpatient Admission           \nseq=5 | 2025-01-04 23:59:00 | Census          | Inpatient Admission           \nseq=6 | 2025-01-05 12:17:00 | Transfer Out    | Inpatient Admission           \nseq=7 | 2025-01-05 12:17:00 | Transfer In     | Inpatient Admission           \nseq=8 | 2025-01-05 14:41:00 | Transfer Out    | Inpatient Admission           \nseq=9 | 2025-01-05 14:41:00 | Transfer In     | Inpatient Admission           \nseq=10 | 2025-01-05 23:59:00 | Census          | Inpatient Admission           \nseq=11 | 2025-01-06 23:54:00 | Patient Update  | Inpatient Admission           \nseq=12 | 2025-01-06 23:59:00 | Census          | Inpatient Admission           \nseq=13 | 2025-01-07 11:58:00 | Discharge       | Inpatient Admission           \nseq=nan | 2025-01-04 18:07:00 | Admission       | Emergency Department - Encount\n", "type": "stream"}], "id": "cEAS", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "ec96cd3bbe97d3840a5bdaed81ccbf0f", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "\n\nAfter Filtering (Kept Events):\nseq=1 | 2025-01-04 20:02:00 | Patient Update  | Inpatient Admission           \nseq=2 | 2025-01-04 21:00:00 | Patient Update  | Inpatient Admission           \nseq=3 | 2025-01-04 21:50:00 | Transfer Out    | Inpatient Admission           \nseq=4 | 2025-01-04 21:50:00 | Transfer In     | Inpatient Admission           \nseq=5 | 2025-01-04 23:59:00 | Census          | Inpatient Admission           \nseq=6 | 2025-01-05 12:17:00 | Transfer Out    | Inpatient Admission           \nseq=7 | 2025-01-05 12:17:00 | Transfer In     | Inpatient Admission           \nseq=8 | 2025-01-05 14:41:00 | Transfer Out    | Inpatient Admission           \nseq=9 | 2025-01-05 14:41:00 | Transfer In     | Inpatient Admission           \nseq=10 | 2025-01-05 23:59:00 | Census          | Inpatient Admission           \nseq=11 | 2025-01-06 23:54:00 | Patient Update  | Inpatient Admission           \nseq=12 | 2025-01-06 23:59:00 | Census          | Inpatient Admission           \nseq=13 | 2025-01-07 11:58:00 | Discharge       | Inpatient Admission           \nseq=nan | 2025-01-04 18:07:00 | Admission       | Emergency Department - Encount\n", "type": "stream"}], "id": "iXej", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "cbab6f595fd36e459649170890de08e0", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Total events with NaN seq_num: 5\nTotal encounters with at least one NaN seq: 5\nOut of total encounters: 153,878\nPercentage of encounters affected: 0.0%\n\n--- Event type breakdown for NaN seq events ---\nevent_type\nAdmission    5\nName: count, dtype: int64\n\n--- Patient class breakdown for NaN seq events ---\npatient_class\nEmergency Department - Encounter    5\nName: count, dtype: int64\n\n--- Department group breakdown for NaN seq events ---\nSeries([], Name: count, dtype: int64)\n\n================================================================================\nEncounter: 66185614861 (14 events)\n================================================================================\n     seq=NaN | 2025-01-04 18:07:00 | Admission            | Emergency Department - Encounter | nan\n       seq=1 | 2025-01-04 20:02:00 | Patient Update       | Inpatient Admission            | nan\n       seq=2 | 2025-01-04 21:00:00 | Patient Update       | Inpatient Admission            | nan\n       seq=3 | 2025-01-04 21:50:00 | Transfer Out         | Inpatient Admission            | nan\n       seq=4 | 2025-01-04 21:50:00 | Transfer In          | Inpatient Admission            | MedSTele\n       seq=5 | 2025-01-04 23:59:00 | Census               | Inpatient Admission            | MedSTele\n       seq=6 | 2025-01-05 12:17:00 | Transfer Out         | Inpatient Admission            | MedSTele\n       seq=7 | 2025-01-05 12:17:00 | Transfer In          | Inpatient Admission            | nan\n       seq=8 | 2025-01-05 14:41:00 | Transfer Out         | Inpatient Admission            | nan\n       seq=9 | 2025-01-05 14:41:00 | Transfer In          | Inpatient Admission            | MedSTele\n      seq=10 | 2025-01-05 23:59:00 | Census               | Inpatient Admission            | MedSTele\n      seq=11 | 2025-01-06 23:54:00 | Patient Update       | Inpatient Admission            | MedSTele\n      seq=12 | 2025-01-06 23:59:00 | Census               | Inpatient Admission            | MedSTele\n      seq=13 | 2025-01-07 11:58:00 | Discharge            | Inpatient Admission            | MedSTele\n\n================================================================================\nEncounter: 66188238732 (15 events)\n================================================================================\n     seq=NaN | 2025-02-03 20:54:00 | Admission            | Emergency Department - Encounter | nan\n       seq=1 | 2025-02-03 22:47:00 | Patient Update       | Inpatient Admission            | nan\n       seq=2 | 2025-02-03 23:59:00 | Census               | Inpatient Admission            | nan\n       seq=3 | 2025-02-04 02:34:00 | Patient Update       | Inpatient Admission            | nan\n       seq=4 | 2025-02-04 07:34:00 | Transfer Out         | Inpatient Admission            | nan\n       seq=5 | 2025-02-04 07:34:00 | Transfer In          | Inpatient Admission            | nan\n       seq=6 | 2025-02-04 16:07:00 | Transfer Out         | Inpatient Admission            | nan\n       seq=7 | 2025-02-04 16:07:00 | Transfer In          | Inpatient Admission            | MedSurg\n       seq=8 | 2025-02-04 17:42:00 | Patient Update       | Inpatient Admission            | MedSurg\n       seq=9 | 2025-02-04 20:29:00 | Transfer Out         | Inpatient Admission            | MedSurg\n      seq=10 | 2025-02-04 20:29:00 | Transfer In          | Inpatient Admission            | IMU\n      seq=11 | 2025-02-04 23:43:00 | Patient Update       | Inpatient Admission            | IMU\n      seq=12 | 2025-02-04 23:59:00 | Census               | Inpatient Admission            | IMU\n      seq=13 | 2025-02-05 23:59:00 | Census               | Inpatient Admission            | IMU\n      seq=14 | 2025-02-06 18:22:00 | Discharge            | Inpatient Admission            | IMU\n\n================================================================================\nEncounter: 66196752433 (2 events)\n================================================================================\n     seq=NaN | 2025-05-08 14:51:00 | Admission            | Emergency Department - Encounter | nan\n       seq=1 | 2025-05-08 15:48:00 | Discharge            | Emergency Department - Encounter | nan\n\n================================================================================\nEncounter: 66197363404 (2 events)\n================================================================================\n     seq=NaN | 2025-05-15 13:44:00 | Admission            | Emergency Department - Encounter | nan\n       seq=1 | 2025-05-15 17:08:00 | Discharge            | Emergency Department - Encounter | nan\n\n================================================================================\nEncounter: 66198624563 (2 events)\n================================================================================\n     seq=NaN | 2025-05-30 13:01:00 | Admission            | Emergency Department - Encounter | nan\n       seq=1 | 2025-05-30 16:27:00 | Discharge            | Emergency Department - Encounter | nan\n", "type": "stream"}], "id": "EJmg", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "9c8ec43aba145232574bd666dc8e6d96", "console": [], "id": "UmEG", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EThe seq_num_in_enc field is scoped to the Inpatient Admission patient class, not the full encounter.\nWhen a patient starts in the ED and converts to inpatient, the initial ED Admission event receives no\nsequence number (NaN). This is systematic, not a data quality issue. Since all NaN cases follow this\npattern and timestamps are in correct chronological order, we will use effective_time to order events\nand extract transitions \u2014 no resequencing needed.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "15354471e895b7c2ad93902b4c539e1a", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "ED events: 306,495\n\nED department_group values:\ndepartment_group\nNaN         306488\nMedSTele         4\nPCU              3\nName: count, dtype: int64\n\nED department_name samples:\ndepartment_name\nHC EMERGENCY DEPT               117352\nLJ EMERGENCY DEPT               114202\nEC EMERGENCY DEPT                72263\nLJ 2-PERIOP                       1214\nUC ORGAN PERFUSION                 476\nHC 2-PERIOP                        313\nLJ INTERVENTIONAL RADIOLOGY        156\nHCH INTERVENTIONAL RADIOLOGY       129\nTHH SPECIAL PROCEDURES             122\nHCH GIENDO                          64\nName: count, dtype: int64\n", "type": "stream"}], "id": "vEBW", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "9f6dd6ed47c8a124a3f8d90a5737bfd6", "console": [], "id": "kLmu", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Cspan class=\"paragraph\"\u003EED events (306,495) have NaN for department_group in the source data \u2014 the field was never populated\nfor emergency departments. This accounts for the majority of the ~556K missing department_group values\nidentified earlier. ED events are still present in df_clean and can be identified via patient_class\n(\"Emergency Department - Encounter\") or department_name prefix (LJ/HC/EC EMERGENCY DEPT). We will\nfill in \"ED\" as the department_group for these events before building the transition matrix.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "b329e37e5b17da7ad16847c7ec8b5c6e", "console": [], "id": "IpqN", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"tier-mapping\"\u003ETier Mapping\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EOur simulation models patient flow between 9 states: 3 care tiers (ED, ICU, Floor) \u00d7 3 campuses\n(La Jolla, Hillcrest, East Campus), plus discharge home. The raw data has ~10 granular department\ngroups (MedSurg, PCU, IMU, OB, etc.) that need to be collapsed into these 3 tiers. Mapping: ED\nevents (identified via patient_class/department_name since department_group is NaN for ED), ICU stays\nas ICU, and everything else (MedSurg, OB, PCU, IMU, MedSTele, Behavioral Health, Nursery, NICU) as\nFloor. Events with no tier (perioperative/holding) will be skipped in transition extraction so\ntransitions connect around them (e.g., ED \u2192 periop \u2192 Floor becomes ED \u2192 Floor).\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "f03863db75af8a9d8ee6c6fdc3412bcc", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Tier counts:\ntier\nFloor    518591\nED       454729\nNaN      100633\nICU       77433\nName: count, dtype: int64\n\nTier x Location:\nlocation  East Campus  Hillcrest  La Jolla\ntier                                      \nED              87949     157289    206836\nFloor           59718     163283    295590\nICU              6501      27352     43580\n", "type": "stream"}], "id": "dxZZ", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "40fc7fa5e2c3d5ecd6966cc902e34e58", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Events with no tier: 100,633\nEncounters affected: 24,123\n\ndepartment_name for no-tier events:\n  LJ 2-PERIOP: 27,460\n  HC 2-PERIOP: 14,435\n  LJ 2-SHORT STAY: 11,210\n  SC 2-PTU: 10,403\n  LJ INTERVENTIONAL RADIOLOGY: 8,200\n  HC 2-TRAUMA: 4,808\n  HCH INTERVENTIONAL RADIOLOGY: 4,326\n  THH SPECIAL PROCEDURES: 4,024\n  SCH CATH LAB: 3,718\n  EC 2-PERIOP: 3,164\n  HCH GIENDO: 2,051\n  THH EP LAB: 1,561\n  HCH CARDIAC RECOVERY: 927\n  HCH INTERVENTIONAL PULMONOLOGY: 909\n  EC INTERVENTIONAL RADIOLOGY: 734\n  HCH CATH LAB: 698\n  HC OUTPATIENT SURGERY: 526\n  EC CATH LAB: 513\n  EC SPECIAL PROCEDURES: 492\n  HCH EP LAB: 427\n  KOP PERIOP: 28\n  JM ADMITTING: 17\n  UC HYPERACUTE TELEMED: 2\n", "type": "stream"}], "id": "dlnW", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "414fc64fa3e996aa6a201d13f6c55db0", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Total transitions: 185,866\n\nTransition counts:\n  ED_La Jolla -\u003E Discharge: 34,999\n  ED_Hillcrest -\u003E Discharge: 33,162\n  Floor_La Jolla -\u003E Discharge: 28,809\n  ED_East Campus -\u003E Discharge: 26,899\n  Floor_Hillcrest -\u003E Discharge: 16,265\n  ED_Hillcrest -\u003E Floor_Hillcrest: 7,396\n  ED_La Jolla -\u003E Floor_La Jolla: 7,282\n  Floor_East Campus -\u003E Discharge: 6,680\n  ED_East Campus -\u003E Floor_East Campus: 3,521\n  ICU_La Jolla -\u003E Floor_La Jolla: 3,116\n  ICU_La Jolla -\u003E Discharge: 2,444\n  ICU_Hillcrest -\u003E Floor_Hillcrest: 2,137\n  Floor_La Jolla -\u003E ICU_La Jolla: 1,262\n  ED_La Jolla -\u003E ICU_La Jolla: 1,186\n  ED_Hillcrest -\u003E ICU_Hillcrest: 1,178\n  ED_Hillcrest -\u003E Floor_East Campus: 985\n  ICU_Hillcrest -\u003E Discharge: 660\n  ED_La Jolla -\u003E Floor_East Campus: 654\n  Floor_Hillcrest -\u003E ICU_Hillcrest: 630\n  ICU_East Campus -\u003E Floor_East Campus: 616\n", "type": "stream"}], "id": "TTti", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "33fe649568c018722ea661716633a0bb", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Count Matrix:\n                   ED_La Jolla  ED_Hillcrest  ED_East Campus  Floor_La Jolla  \\\nED_La Jolla                  0            21               0            7282   \nED_Hillcrest                21             0              11              20   \nED_East Campus              64           195               0              12   \nFloor_La Jolla              19             0               0               0   \nFloor_Hillcrest              0            12               0             169   \nFloor_East Campus            2             1               2              29   \nICU_La Jolla                 2             0               0            3116   \nICU_Hillcrest                0             4               0               9   \nICU_East Campus              0             0               2               6   \n\n                   Floor_Hillcrest  Floor_East Campus  ICU_La Jolla  \\\nED_La Jolla                    376                654          1186   \nED_Hillcrest                  7396                985            20   \nED_East Campus                 146               3521            12   \nFloor_La Jolla                  48                 22          1262   \nFloor_Hillcrest                  0                 42            27   \nFloor_East Campus               78                  0             1   \nICU_La Jolla                     3                  1             0   \nICU_Hillcrest                 2137                  0            50   \nICU_East Campus                  5                616            30   \n\n                   ICU_Hillcrest  ICU_East Campus  Discharge  \nED_La Jolla                   21               21      34999  \nED_Hillcrest                1178               49      33162  \nED_East Campus                29              604      26899  \nFloor_La Jolla                 2                0      28809  \nFloor_Hillcrest              630                2      16265  \nFloor_East Campus              2              189       6680  \nICU_La Jolla                   6                5       2444  \nICU_Hillcrest                  0               15        660  \nICU_East Campus               17                0        275  \n\nProbability Matrix:\n                   ED_La Jolla  ED_Hillcrest  ED_East Campus  Floor_La Jolla  \\\nED_La Jolla             0.0000        0.0005          0.0000          0.1634   \nED_Hillcrest            0.0005        0.0000          0.0003          0.0005   \nED_East Campus          0.0020        0.0062          0.0000          0.0004   \nFloor_La Jolla          0.0006        0.0000          0.0000          0.0000   \nFloor_Hillcrest         0.0000        0.0007          0.0000          0.0099   \nFloor_East Campus       0.0003        0.0001          0.0003          0.0042   \nICU_La Jolla            0.0004        0.0000          0.0000          0.5587   \nICU_Hillcrest           0.0000        0.0014          0.0000          0.0031   \nICU_East Campus         0.0000        0.0000          0.0021          0.0063   \n\n                   Floor_Hillcrest  Floor_East Campus  ICU_La Jolla  \\\nED_La Jolla                 0.0084             0.0147        0.0266   \nED_Hillcrest                0.1726             0.0230        0.0005   \nED_East Campus              0.0046             0.1118        0.0004   \nFloor_La Jolla              0.0016             0.0007        0.0418   \nFloor_Hillcrest             0.0000             0.0024        0.0016   \nFloor_East Campus           0.0112             0.0000        0.0001   \nICU_La Jolla                0.0005             0.0002        0.0000   \nICU_Hillcrest               0.7433             0.0000        0.0174   \nICU_East Campus             0.0053             0.6477        0.0315   \n\n                   ICU_Hillcrest  ICU_East Campus  Discharge  \nED_La Jolla               0.0005           0.0005     0.7854  \nED_Hillcrest              0.0275           0.0011     0.7741  \nED_East Campus            0.0009           0.0192     0.8544  \nFloor_La Jolla            0.0001           0.0000     0.9551  \nFloor_Hillcrest           0.0367           0.0001     0.9486  \nFloor_East Campus         0.0003           0.0271     0.9565  \nICU_La Jolla              0.0011           0.0009     0.4382  \nICU_Hillcrest             0.0000           0.0052     0.2296  \nICU_East Campus           0.0179           0.0000     0.2892  \n\nRow sums: [1. 1. 1. 1. 1. 1. 1. 1. 1.]\n", "type": "stream"}], "id": "RKFZ", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "d8a4c68e04f9837a6a3de23009289ca0", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "\nTotal trajectories: 150,337\n", "type": "stream"}], "id": "IaQp", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "8a8d963cd06c3c3ec78134da699a5685", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "ED_EAST_CAMPUS: n=31,544, mean=3.7h, median=2.5h, std=5.2h\nED_HILLCREST: n=43,135, mean=7.0h, median=4.8h, std=7.3h\nED_LA_JOLLA: n=44,836, mean=13.7h, median=4.8h, std=20.6h\nFLOOR_EAST_CAMPUS: n=6,984, mean=110.5h, median=53.1h, std=251.4h\nFLOOR_HILLCREST: n=17,147, mean=112.1h, median=61.9h, std=186.0h\nFLOOR_LA_JOLLA: n=30,162, mean=99.8h, median=53.8h, std=172.6h\nICU_EAST_CAMPUS: n=951, mean=74.6h, median=42.8h, std=95.7h\nICU_HILLCREST: n=2,875, mean=102.2h, median=51.6h, std=165.2h\nICU_LA_JOLLA: n=5,577, mean=93.2h, median=43.4h, std=178.4h\n", "type": "stream"}], "id": "IWgg", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "8e5300a66b1a9ca72e68b0ad7ba0e257", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "\n============================================================\nFitting: ED_EAST_CAMPUS (n=31,543)\n============================================================\n  lognorm: SSE=0.033096, params=(np.float64(10.5208), np.float64(0.0167), np.float64(0.1025))\n  gamma: SSE=0.032126, params=(np.float64(0.0835), np.float64(0.0167), np.float64(2.603))\n  expon: SSE=0.000184, params=(0.0167, 3.6727)\n  weibull_min: SSE=0.001890, params=(np.float64(0.7428), np.float64(0.0167), np.float64(1.8389))\n  \u2192 Best: expon\n\n============================================================\nFitting: ED_HILLCREST (n=43,129)\n============================================================\n  lognorm: SSE=0.000616, params=(np.float64(0.7769), -0.6578, np.float64(5.6441))\n  gamma: SSE=0.030306, params=(np.float64(0.2852), np.float64(0.0167), np.float64(2.9093))\n  expon: SSE=0.005164, params=(0.0167, 7.0269)\n  weibull_min: SSE=0.003558, params=(np.float64(1.1095), np.float64(0.0097), np.float64(7.335))\n  \u2192 Best: lognorm\n\n============================================================\nFitting: ED_LA_JOLLA (n=44,819)\n============================================================\n  lognorm: SSE=0.001807, params=(np.float64(1.2554), -0.1069, np.float64(6.1228))\n  gamma: SSE=0.003979, params=(np.float64(0.5797), np.float64(0.0167), np.float64(25.7248))\n  expon: SSE=0.004537, params=(0.0167, 13.6991)\n  weibull_min: SSE=0.002833, params=(np.float64(0.7231), np.float64(0.0167), np.float64(10.0768))\n  \u2192 Best: lognorm\n\n============================================================\nFitting: FLOOR_EAST_CAMPUS (n=6,984)\n============================================================\n  lognorm: SSE=0.000000, params=(np.float64(1.0007), -1.784, np.float64(59.8819))\n  gamma: SSE=0.000036, params=(np.float64(0.0025), np.float64(0.05), np.float64(4.1215))\n  expon: SSE=0.000002, params=(0.05, 110.4614)\n  weibull_min: SSE=0.000003, params=(np.float64(0.8426), np.float64(0.05), np.float64(97.8375))\n  \u2192 Best: lognorm\n\n============================================================\nFitting: FLOOR_HILLCREST (n=17,146)\n============================================================\n  lognorm: SSE=0.000000, params=(np.float64(1.1857), -3.2589, np.float64(59.2356))\n  gamma: SSE=0.000056, params=(np.float64(0.006), np.float64(0.0167), np.float64(4.1924))\n  expon: SSE=0.000002, params=(0.0167, 112.1124)\n  weibull_min: SSE=0.000004, params=(np.float64(0.6825), np.float64(0.0167), np.float64(75.3029))\n  \u2192 Best: lognorm\n\n============================================================\nFitting: FLOOR_LA_JOLLA (n=30,161)\n============================================================\n  lognorm: SSE=0.000001, params=(np.float64(1.1765), -3.345, np.float64(52.9992))\n  gamma: SSE=0.000058, params=(np.float64(0.0059), np.float64(0.0167), np.float64(4.1658))\n  expon: SSE=0.000003, params=(0.0167, 99.8298)\n  weibull_min: SSE=0.000004, params=(np.float64(0.8042), np.float64(0.0167), np.float64(86.7287))\n  \u2192 Best: lognorm\n\n============================================================\nFitting: ICU_EAST_CAMPUS (n=951)\n============================================================\n  lognorm: SSE=0.000023, params=(np.float64(0.9463), -2.6491, np.float64(48.3134))\n  gamma: SSE=0.000510, params=(np.float64(0.0577), np.float64(0.0667), np.float64(3.7264))\n  expon: SSE=0.000070, params=(0.0667, 74.4866)\n  weibull_min: SSE=0.000077, params=(np.float64(0.9551), np.float64(0.0667), np.float64(71.5435))\n  \u2192 Best: lognorm\n\n============================================================\nFitting: ICU_HILLCREST (n=2,872)\n============================================================\n  lognorm: SSE=0.000001, params=(np.float64(1.0023), -2.1755, np.float64(59.6485))\n  gamma: SSE=0.000093, params=(np.float64(0.0073), np.float64(0.0167), np.float64(4.179))\n  expon: SSE=0.000005, params=(0.0167, 102.3156)\n  weibull_min: SSE=0.000005, params=(np.float64(0.8959), np.float64(0.0167), np.float64(101.4421))\n  \u2192 Best: lognorm\n\n============================================================\nFitting: ICU_LA_JOLLA (n=5,576)\n============================================================\n  lognorm: SSE=0.000000, params=(np.float64(1.1196), -0.9556, np.float64(46.637))\n  gamma: SSE=0.000104, params=(np.float64(0.0066), np.float64(0.0167), np.float64(4.1638))\n  expon: SSE=0.000007, params=(0.0167, 93.1627)\n  weibull_min: SSE=0.000006, params=(np.float64(0.8103), np.float64(0.0167), np.float64(81.0345))\n  \u2192 Best: lognorm\n", "type": "stream"}], "id": "fCoF", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "e0db2b3447c6a046128ef3c4ec6599c7", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Potential boarded events: 148,234\n\nTier breakdown:\n  ED: 148,234\n", "type": "stream"}], "id": "LkGn", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "52aaf93a6c571f17d908fa5f1fe2ccc7", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "ED durations for encounters WITH boarding:\ncount    28022.000000\nmean        23.811335\nstd         22.596703\nmin          0.000000\n25%          7.666667\n50%         14.716667\n75%         31.633333\nmax        156.216667\nName: duration_hours, dtype: float64\n\nED durations for encounters WITHOUT boarding:\ncount    91493.000000\nmean         4.018271\nstd          3.994135\nmin          0.000000\n25%          1.716667\n50%          3.283333\n75%          5.200000\nmax        121.583333\nName: duration_hours, dtype: float64\n", "type": "stream"}], "id": "zVRe", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "b5f99b93fd803e14ffb9170cfe1038e2", "console": [], "id": "woaO", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"boarded-patients-known-limitation\"\u003EBoarded Patients (Known Limitation)\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003E148,234 ED events (~33% of all ED events) are boarded patients \u2014 physically in the ED but already\nadmitted as inpatients. These inflate ED duration distributions significantly: median 14.7h with\nboarding vs 3.3h without. For v1 of the simulation, boarded time is counted as ED occupancy. Future\niterations could split these encounters at the patient_class change point to separate true ED time\nfrom boarding time.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "d5f2bd8344b9c77e20daf9ba799a0a77", "console": [], "id": "HnMC", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch2 id=\"arrival-rates-weekday-vs-weekend\"\u003EArrival Rates: Weekday vs Weekend\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EThe simulation needs to know how many patients enter the system per day at each campus. Patient arrival\npatterns differ between weekdays and weekends (e.g., fewer elective admissions on weekends, different ED\nvolumes). We calculate mean daily arrivals by campus (La Jolla, Hillcrest, East Campus) split by\nweekday vs weekend. These rates will drive patient generation in the simulation \u2014 each simulated day\nsamples from the appropriate arrival distribution to determine how many new patients enter each campus.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "a2fbb065545707eb1827cfea177c3e04", "console": [{"mimetype": "text/plain", "name": "stdout", "text": "Mean daily arrivals by campus and day type:\n  East Campus (Weekday): mean=92.4, std=10.5\n  East Campus (Weekend): mean=83.3, std=10.5\n  Hillcrest (Weekday): mean=144.7, std=19.9\n  Hillcrest (Weekend): mean=125.1, std=10.3\n  La Jolla (Weekday): mean=198.2, std=26.2\n  La Jolla (Weekend): mean=148.9, std=14.5\n", "type": "stream"}], "id": "wadT", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "18faa67fc0a2f5254b2b2c256a9e20c5", "console": [], "id": "VCRE", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"ucsd-health-des-eda-data-preparation-summary\"\u003EUCSD Health DES \u2014 EDA \u0026amp; Data Preparation Summary\u003C/h1\u003E\n\u003Ch2 id=\"data-cleaning-pipeline\"\u003EData Cleaning Pipeline\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003EStarting point:\u003C/strong\u003E 2.1M ADT events across 985K patient encounters (2025).\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003EStep 1 \u2014 Filter to bed-occupying patients:\u003C/strong\u003E Removed non-bed-occupying patient classes (outpatient radiology, infusion, therapy, etc.), reducing to 1.15M rows across 153,878 encounters.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003EStep 2 \u2014 Drop single-event encounters:\u003C/strong\u003E 1,720 encounters (1.1%) had only a single event, producing no usable transitions. These were incomplete records in the source system (orphan discharges, registration-only entries), not artifacts of our filtering. Dropped to yield 152,158 encounters / 1,151,386 events.\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003EStep 3 \u2014 Tier mapping:\u003C/strong\u003E Collapsed ~10 granular department groups into 3 care tiers for the simulation's 9-state model (3 tiers \u00d7 3 campuses). ED events had NaN for \u003Ccode\u003Edepartment_group\u003C/code\u003E in the source data (never populated for emergency departments) and were identified via \u003Ccode\u003Epatient_class\u003C/code\u003E and \u003Ccode\u003Edepartment_name\u003C/code\u003E. Mapping: ED \u2192 ED, ICU \u2192 ICU, everything else (MedSurg, OB, PCU, IMU, MedSTele, Behavioral Health, Nursery, NICU) \u2192 Floor. 100,633 events with no tier (perioperative/holding areas) are skipped in transition extraction so transitions connect around them (e.g., ED \u2192 periop \u2192 Floor becomes ED \u2192 Floor).\u003C/span\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003EStep 4 \u2014 Timestamp-based ordering:\u003C/strong\u003E The \u003Ccode\u003Eseq_num_in_enc\u003C/code\u003E field is scoped to the Inpatient Admission patient class, not the full encounter. ED Admission events receive NaN sequence numbers. Since timestamps are in correct chronological order, all event ordering uses \u003Ccode\u003Eeffective_time\u003C/code\u003E \u2014 no resequencing needed.\u003C/span\u003E\n\u003Chr /\u003E\n\u003Ch2 id=\"1-transition-matrix-910\"\u003E1. Transition Matrix (9\u00d710)\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003ETransition probabilities between 9 states (ED/Floor/ICU \u00d7 La Jolla/Hillcrest/East Campus) plus Discharge. Built by sorting each encounter by \u003Ccode\u003Eeffective_time\u003C/code\u003E, extracting the sequence of states (dropping NaN-tier events and consecutive duplicates), and counting state-to-state transitions. 185,866 total transitions extracted.\u003C/span\u003E\n\u003Ctable\u003E\n\u003Cthead\u003E\n\u003Ctr\u003E\n\u003Cth\u003E\u003C/th\u003E\n\u003Cth\u003EED_LJ\u003C/th\u003E\n\u003Cth\u003EED_HC\u003C/th\u003E\n\u003Cth\u003EED_EC\u003C/th\u003E\n\u003Cth\u003EFl_LJ\u003C/th\u003E\n\u003Cth\u003EFl_HC\u003C/th\u003E\n\u003Cth\u003EFl_EC\u003C/th\u003E\n\u003Cth\u003EICU_LJ\u003C/th\u003E\n\u003Cth\u003EICU_HC\u003C/th\u003E\n\u003Cth\u003EICU_EC\u003C/th\u003E\n\u003Cth\u003EDisch\u003C/th\u003E\n\u003C/tr\u003E\n\u003C/thead\u003E\n\u003Ctbody\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E\u003Cstrong\u003EED_LJ\u003C/strong\u003E\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.001\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.163\u003C/td\u003E\n\u003Ctd\u003E0.008\u003C/td\u003E\n\u003Ctd\u003E0.015\u003C/td\u003E\n\u003Ctd\u003E0.027\u003C/td\u003E\n\u003Ctd\u003E0.001\u003C/td\u003E\n\u003Ctd\u003E0.001\u003C/td\u003E\n\u003Ctd\u003E0.785\u003C/td\u003E\n\u003C/tr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E\u003Cstrong\u003EED_HC\u003C/strong\u003E\u003C/td\u003E\n\u003Ctd\u003E0.001\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.001\u003C/td\u003E\n\u003Ctd\u003E0.173\u003C/td\u003E\n\u003Ctd\u003E0.023\u003C/td\u003E\n\u003Ctd\u003E0.001\u003C/td\u003E\n\u003Ctd\u003E0.028\u003C/td\u003E\n\u003Ctd\u003E0.001\u003C/td\u003E\n\u003Ctd\u003E0.774\u003C/td\u003E\n\u003C/tr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E\u003Cstrong\u003EED_EC\u003C/strong\u003E\u003C/td\u003E\n\u003Ctd\u003E0.002\u003C/td\u003E\n\u003Ctd\u003E0.006\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.005\u003C/td\u003E\n\u003Ctd\u003E0.112\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.001\u003C/td\u003E\n\u003Ctd\u003E0.019\u003C/td\u003E\n\u003Ctd\u003E0.854\u003C/td\u003E\n\u003C/tr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E\u003Cstrong\u003EFl_LJ\u003C/strong\u003E\u003C/td\u003E\n\u003Ctd\u003E0.001\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.002\u003C/td\u003E\n\u003Ctd\u003E0.001\u003C/td\u003E\n\u003Ctd\u003E0.042\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.955\u003C/td\u003E\n\u003C/tr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E\u003Cstrong\u003EFl_HC\u003C/strong\u003E\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.001\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.010\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.002\u003C/td\u003E\n\u003Ctd\u003E0.002\u003C/td\u003E\n\u003Ctd\u003E0.037\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.949\u003C/td\u003E\n\u003C/tr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E\u003Cstrong\u003EFl_EC\u003C/strong\u003E\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.004\u003C/td\u003E\n\u003Ctd\u003E0.011\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.027\u003C/td\u003E\n\u003Ctd\u003E0.957\u003C/td\u003E\n\u003C/tr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E\u003Cstrong\u003EICU_LJ\u003C/strong\u003E\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.559\u003C/td\u003E\n\u003Ctd\u003E0.001\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.001\u003C/td\u003E\n\u003Ctd\u003E0.001\u003C/td\u003E\n\u003Ctd\u003E0.438\u003C/td\u003E\n\u003C/tr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E\u003Cstrong\u003EICU_HC\u003C/strong\u003E\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.001\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.003\u003C/td\u003E\n\u003Ctd\u003E0.743\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.017\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.005\u003C/td\u003E\n\u003Ctd\u003E0.230\u003C/td\u003E\n\u003C/tr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003E\u003Cstrong\u003EICU_EC\u003C/strong\u003E\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.002\u003C/td\u003E\n\u003Ctd\u003E0.006\u003C/td\u003E\n\u003Ctd\u003E0.005\u003C/td\u003E\n\u003Ctd\u003E0.648\u003C/td\u003E\n\u003Ctd\u003E0.032\u003C/td\u003E\n\u003Ctd\u003E0.018\u003C/td\u003E\n\u003Ctd\u003E0.000\u003C/td\u003E\n\u003Ctd\u003E0.289\u003C/td\u003E\n\u003C/tr\u003E\n\u003C/tbody\u003E\n\u003C/table\u003E\n\u003Cspan class=\"paragraph\"\u003E\u003Cstrong\u003EKey patterns:\u003C/strong\u003E ED \u2192 Discharge is dominant (77\u201385%), reflecting most ED patients going home. Floor \u2192 Discharge (95\u201396%) shows most floor patients discharge directly. ICU \u2192 Floor same campus (56\u201374%) is the primary step-down pathway. Cross-campus transfers exist but are rare.\u003C/span\u003E\n\u003Chr /\u003E\n\u003Ch2 id=\"2-duration-distributions-lognormal-fits\"\u003E2. Duration Distributions (Lognormal Fits)\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003ELength of stay per state block, fit using scipy. Lognormal wins 8 of 9 states (exponential for ED East Campus). All states are heavily right-skewed (mean \u0026gt;\u0026gt; median) due to long-stay outliers.\u003C/span\u003E\n\u003Ctable\u003E\n\u003Cthead\u003E\n\u003Ctr\u003E\n\u003Cth\u003EState\u003C/th\u003E\n\u003Cth\u003EBest Fit\u003C/th\u003E\n\u003Cth\u003EParams (shape, loc, scale)\u003C/th\u003E\n\u003Cth\u003EMean (h)\u003C/th\u003E\n\u003Cth\u003EMedian (h)\u003C/th\u003E\n\u003C/tr\u003E\n\u003C/thead\u003E\n\u003Ctbody\u003E\n\u003Ctr\u003E\n\u003Ctd\u003EED_East Campus\u003C/td\u003E\n\u003Ctd\u003Eexpon\u003C/td\u003E\n\u003Ctd\u003E(0.017, 3.67)\u003C/td\u003E\n\u003Ctd\u003E3.7\u003C/td\u003E\n\u003Ctd\u003E2.5\u003C/td\u003E\n\u003C/tr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003EED_Hillcrest\u003C/td\u003E\n\u003Ctd\u003Elognorm\u003C/td\u003E\n\u003Ctd\u003E(0.777, -0.658, 5.644)\u003C/td\u003E\n\u003Ctd\u003E7.0\u003C/td\u003E\n\u003Ctd\u003E4.8\u003C/td\u003E\n\u003C/tr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003EED_La Jolla\u003C/td\u003E\n\u003Ctd\u003Elognorm\u003C/td\u003E\n\u003Ctd\u003E(1.255, -0.107, 6.123)\u003C/td\u003E\n\u003Ctd\u003E13.7\u003C/td\u003E\n\u003Ctd\u003E4.8\u003C/td\u003E\n\u003C/tr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003EFloor_East Campus\u003C/td\u003E\n\u003Ctd\u003Elognorm\u003C/td\u003E\n\u003Ctd\u003E(1.001, -1.784, 59.882)\u003C/td\u003E\n\u003Ctd\u003E110.5\u003C/td\u003E\n\u003Ctd\u003E53.1\u003C/td\u003E\n\u003C/tr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003EFloor_Hillcrest\u003C/td\u003E\n\u003Ctd\u003Elognorm\u003C/td\u003E\n\u003Ctd\u003E(1.186, -3.259, 59.236)\u003C/td\u003E\n\u003Ctd\u003E112.1\u003C/td\u003E\n\u003Ctd\u003E61.9\u003C/td\u003E\n\u003C/tr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003EFloor_La Jolla\u003C/td\u003E\n\u003Ctd\u003Elognorm\u003C/td\u003E\n\u003Ctd\u003E(1.177, -3.345, 52.999)\u003C/td\u003E\n\u003Ctd\u003E99.8\u003C/td\u003E\n\u003Ctd\u003E53.8\u003C/td\u003E\n\u003C/tr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003EICU_East Campus\u003C/td\u003E\n\u003Ctd\u003Elognorm\u003C/td\u003E\n\u003Ctd\u003E(0.946, -2.649, 48.313)\u003C/td\u003E\n\u003Ctd\u003E74.6\u003C/td\u003E\n\u003Ctd\u003E42.8\u003C/td\u003E\n\u003C/tr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003EICU_Hillcrest\u003C/td\u003E\n\u003Ctd\u003Elognorm\u003C/td\u003E\n\u003Ctd\u003E(1.002, -2.176, 59.649)\u003C/td\u003E\n\u003Ctd\u003E102.2\u003C/td\u003E\n\u003Ctd\u003E51.6\u003C/td\u003E\n\u003C/tr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003EICU_La Jolla\u003C/td\u003E\n\u003Ctd\u003Elognorm\u003C/td\u003E\n\u003Ctd\u003E(1.120, -0.956, 46.637)\u003C/td\u003E\n\u003Ctd\u003E93.2\u003C/td\u003E\n\u003Ctd\u003E43.4\u003C/td\u003E\n\u003C/tr\u003E\n\u003C/tbody\u003E\n\u003C/table\u003E\n\u003Chr /\u003E\n\u003Ch2 id=\"3-trajectory-library\"\u003E3. Trajectory Library\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003E150,337 patient trajectories with state and duration at each stop. Each encounter maps to a sequence of \u003Ccode\u003E(state, duration_hours)\u003C/code\u003E tuples. Example: \u003Ccode\u003EED_La Jolla (4.5h) \u2192 Floor_La Jolla (48.2h) \u2192 Discharge\u003C/code\u003E. Combines the transition logic with the duration data for full patient path reconstruction.\u003C/span\u003E\n\u003Chr /\u003E\n\u003Ch2 id=\"4-arrival-rates-weekday-vs-weekend\"\u003E4. Arrival Rates (Weekday vs Weekend)\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003EMean daily arrivals by campus and day type, calculated from the first event of each encounter.\u003C/span\u003E\n\u003Ctable\u003E\n\u003Cthead\u003E\n\u003Ctr\u003E\n\u003Cth\u003ECampus\u003C/th\u003E\n\u003Cth\u003EWeekday (mean \u00b1 std)\u003C/th\u003E\n\u003Cth\u003EWeekend (mean \u00b1 std)\u003C/th\u003E\n\u003C/tr\u003E\n\u003C/thead\u003E\n\u003Ctbody\u003E\n\u003Ctr\u003E\n\u003Ctd\u003EEast Campus\u003C/td\u003E\n\u003Ctd\u003E92.4 \u00b1 10.5\u003C/td\u003E\n\u003Ctd\u003E83.3 \u00b1 10.5\u003C/td\u003E\n\u003C/tr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003EHillcrest\u003C/td\u003E\n\u003Ctd\u003E144.7 \u00b1 19.9\u003C/td\u003E\n\u003Ctd\u003E125.1 \u00b1 10.3\u003C/td\u003E\n\u003C/tr\u003E\n\u003Ctr\u003E\n\u003Ctd\u003ELa Jolla\u003C/td\u003E\n\u003Ctd\u003E198.2 \u00b1 26.2\u003C/td\u003E\n\u003Ctd\u003E148.9 \u00b1 14.5\u003C/td\u003E\n\u003C/tr\u003E\n\u003C/tbody\u003E\n\u003C/table\u003E\n\u003Cspan class=\"paragraph\"\u003EAll campuses show 10\u201325% fewer arrivals on weekends, consistent with reduced elective admissions. La Jolla has the largest absolute drop.\u003C/span\u003E\n\u003Chr /\u003E\n\u003Ch2 id=\"known-limitation-boarded-patients\"\u003EKnown Limitation: Boarded Patients\u003C/h2\u003E\n\u003Cspan class=\"paragraph\"\u003E148,234 ED events (~33% of all ED events) are boarded patients \u2014 physically in the ED but already admitted as inpatients. These inflate ED duration distributions significantly: median 14.7h with boarding vs 3.3h without. For v1 of the simulation, boarded time is counted as ED occupancy. Future iterations could split these encounters at the patient_class change point to separate true ED time from boarding time.\u003C/span\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "2f37e0322356a7f0d85ffc469d0b8f2f", "console": [], "id": "hgqU", "outputs": [{"data": {"text/markdown": "\u003Cspan class=\"markdown prose dark:prose-invert contents\"\u003E\u003Ch1 id=\"saving-all-tables-to-be-imported-to-another-notebook-for-des\"\u003ESaving all tables to be imported to another notebook for DES\u003C/h1\u003E\u003C/span\u003E"}, "type": "data"}]}, {"code_hash": "831d8109e51406ed77dc4b22b8dac329", "console": [], "id": "PSUk", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "0e887b641b5020b61b4b0ed78dacad54", "console": [], "id": "mfOT", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='mfOT-0' random-id='c41bab0d-0aa2-007e-c966-87d7f151ec0a'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:\u0026#92;\u0026quot;ED_La Jolla\u0026#92;\u0026quot;,\u0026#92;\u0026quot;ED_La Jolla\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;ED_Hillcrest\u0026#92;\u0026quot;:0.0004712746858168761,\u0026#92;\u0026quot;ED_East Campus\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;Floor_La Jolla\u0026#92;\u0026quot;:0.16342010771992818,\u0026#92;\u0026quot;Floor_Hillcrest\u0026#92;\u0026quot;:0.00843806104129264,\u0026#92;\u0026quot;Floor_East Campus\u0026#92;\u0026quot;:0.014676840215439857,\u0026#92;\u0026quot;ICU_La Jolla\u0026#92;\u0026quot;:0.026615798922800717,\u0026#92;\u0026quot;ICU_Hillcrest\u0026#92;\u0026quot;:0.0004712746858168761,\u0026#92;\u0026quot;ICU_East Campus\u0026#92;\u0026quot;:0.0004712746858168761,\u0026#92;\u0026quot;Discharge\u0026#92;\u0026quot;:0.785435368043088},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:\u0026#92;\u0026quot;ED_Hillcrest\u0026#92;\u0026quot;,\u0026#92;\u0026quot;ED_La Jolla\u0026#92;\u0026quot;:0.0004901731945287335,\u0026#92;\u0026quot;ED_Hillcrest\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;ED_East Campus\u0026#92;\u0026quot;:0.00025675738761028895,\u0026#92;\u0026quot;Floor_La Jolla\u0026#92;\u0026quot;:0.00046683161383688905,\u0026#92;\u0026quot;Floor_Hillcrest\u0026#92;\u0026quot;:0.17263433079688156,\u0026#92;\u0026quot;Floor_East Campus\u0026#92;\u0026quot;:0.022991456981466783,\u0026#92;\u0026quot;ICU_La Jolla\u0026#92;\u0026quot;:0.00046683161383688905,\u0026#92;\u0026quot;ICU_Hillcrest\u0026#92;\u0026quot;:0.027496382054992764,\u0026#92;\u0026quot;ICU_East Campus\u0026#92;\u0026quot;:0.0011437374539003781,\u0026#92;\u0026quot;Discharge\u0026#92;\u0026quot;:0.7740534989029457},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:\u0026#92;\u0026quot;ED_East Campus\u0026#92;\u0026quot;,\u0026#92;\u0026quot;ED_La Jolla\u0026#92;\u0026quot;:0.002032907693285052,\u0026#92;\u0026quot;ED_Hillcrest\u0026#92;\u0026quot;:0.0061940156279778925,\u0026#92;\u0026quot;ED_East Campus\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;Floor_La Jolla\u0026#92;\u0026quot;:0.0003811701924909472,\u0026#92;\u0026quot;Floor_Hillcrest\u0026#92;\u0026quot;:0.004637570675306524,\u0026#92;\u0026quot;Floor_East Campus\u0026#92;\u0026quot;:0.11184168731338542,\u0026#92;\u0026quot;ICU_La Jolla\u0026#92;\u0026quot;:0.0003811701924909472,\u0026#92;\u0026quot;ICU_Hillcrest\u0026#92;\u0026quot;:0.0009211612985197891,\u0026#92;\u0026quot;ICU_East Campus\u0026#92;\u0026quot;:0.019185566355377676,\u0026#92;\u0026quot;Discharge\u0026#92;\u0026quot;:0.8544247506511657},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Floor_La Jolla\u0026#92;\u0026quot;,\u0026#92;\u0026quot;ED_La Jolla\u0026#92;\u0026quot;:0.0006299317021417678,\u0026#92;\u0026quot;ED_Hillcrest\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;ED_East Campus\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;Floor_La Jolla\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;Floor_Hillcrest\u0026#92;\u0026quot;:0.0015914064054107818,\u0026#92;\u0026quot;Floor_East Campus\u0026#92;\u0026quot;:0.0007293946024799417,\u0026#92;\u0026quot;ICU_La Jolla\u0026#92;\u0026quot;:0.04184072674225847,\u0026#92;\u0026quot;ICU_Hillcrest\u0026#92;\u0026quot;:6.630860022544923e-05,\u0026#92;\u0026quot;ICU_East Campus\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;Discharge\u0026#92;\u0026quot;:0.9551422319474836},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Floor_Hillcrest\u0026#92;\u0026quot;,\u0026#92;\u0026quot;ED_La Jolla\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;ED_Hillcrest\u0026#92;\u0026quot;:0.0006998308742054004,\u0026#92;\u0026quot;ED_East Campus\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;Floor_La Jolla\u0026#92;\u0026quot;:0.009855951478392721,\u0026#92;\u0026quot;Floor_Hillcrest\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;Floor_East Campus\u0026#92;\u0026quot;:0.0024494080597189014,\u0026#92;\u0026quot;ICU_La Jolla\u0026#92;\u0026quot;:0.0015746194669621508,\u0026#92;\u0026quot;ICU_Hillcrest\u0026#92;\u0026quot;:0.03674112089578352,\u0026#92;\u0026quot;ICU_East Campus\u0026#92;\u0026quot;:0.0001166384790342334,\u0026#92;\u0026quot;Discharge\u0026#92;\u0026quot;:0.9485624307459031},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Floor_East Campus\u0026#92;\u0026quot;,\u0026#92;\u0026quot;ED_La Jolla\u0026#92;\u0026quot;:0.000286368843069874,\u0026#92;\u0026quot;ED_Hillcrest\u0026#92;\u0026quot;:0.000143184421534937,\u0026#92;\u0026quot;ED_East Campus\u0026#92;\u0026quot;:0.000286368843069874,\u0026#92;\u0026quot;Floor_La Jolla\u0026#92;\u0026quot;:0.004152348224513173,\u0026#92;\u0026quot;Floor_Hillcrest\u0026#92;\u0026quot;:0.011168384879725086,\u0026#92;\u0026quot;Floor_East Campus\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;ICU_La Jolla\u0026#92;\u0026quot;:0.000143184421534937,\u0026#92;\u0026quot;ICU_Hillcrest\u0026#92;\u0026quot;:0.000286368843069874,\u0026#92;\u0026quot;ICU_East Campus\u0026#92;\u0026quot;:0.027061855670103094,\u0026#92;\u0026quot;Discharge\u0026#92;\u0026quot;:0.9564719358533792},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:\u0026#92;\u0026quot;ICU_La Jolla\u0026#92;\u0026quot;,\u0026#92;\u0026quot;ED_La Jolla\u0026#92;\u0026quot;:0.00035861574323112785,\u0026#92;\u0026quot;ED_Hillcrest\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;ED_East Campus\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;Floor_La Jolla\u0026#92;\u0026quot;:0.5587233279540972,\u0026#92;\u0026quot;Floor_Hillcrest\u0026#92;\u0026quot;:0.0005379236148466917,\u0026#92;\u0026quot;Floor_East Campus\u0026#92;\u0026quot;:0.00017930787161556393,\u0026#92;\u0026quot;ICU_La Jolla\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;ICU_Hillcrest\u0026#92;\u0026quot;:0.0010758472296933835,\u0026#92;\u0026quot;ICU_East Campus\u0026#92;\u0026quot;:0.0008965393580778196,\u0026#92;\u0026quot;Discharge\u0026#92;\u0026quot;:0.4382284382284382},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:\u0026#92;\u0026quot;ICU_Hillcrest\u0026#92;\u0026quot;,\u0026#92;\u0026quot;ED_La Jolla\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;ED_Hillcrest\u0026#92;\u0026quot;:0.001391304347826087,\u0026#92;\u0026quot;ED_East Campus\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;Floor_La Jolla\u0026#92;\u0026quot;:0.003130434782608696,\u0026#92;\u0026quot;Floor_Hillcrest\u0026#92;\u0026quot;:0.743304347826087,\u0026#92;\u0026quot;Floor_East Campus\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;ICU_La Jolla\u0026#92;\u0026quot;:0.017391304347826087,\u0026#92;\u0026quot;ICU_Hillcrest\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;ICU_East Campus\u0026#92;\u0026quot;:0.0052173913043478265,\u0026#92;\u0026quot;Discharge\u0026#92;\u0026quot;:0.22956521739130434},{\u0026#92;\u0026quot;\u0026#92;\u0026quot;:\u0026#92;\u0026quot;ICU_East Campus\u0026#92;\u0026quot;,\u0026#92;\u0026quot;ED_La Jolla\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;ED_Hillcrest\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;ED_East Campus\u0026#92;\u0026quot;:0.002103049421661409,\u0026#92;\u0026quot;Floor_La Jolla\u0026#92;\u0026quot;:0.006309148264984227,\u0026#92;\u0026quot;Floor_Hillcrest\u0026#92;\u0026quot;:0.005257623554153523,\u0026#92;\u0026quot;Floor_East Campus\u0026#92;\u0026quot;:0.647739221871714,\u0026#92;\u0026quot;ICU_La Jolla\u0026#92;\u0026quot;:0.031545741324921134,\u0026#92;\u0026quot;ICU_Hillcrest\u0026#92;\u0026quot;:0.017875920084121977,\u0026#92;\u0026quot;ICU_East Campus\u0026#92;\u0026quot;:0.0,\u0026#92;\u0026quot;Discharge\u0026#92;\u0026quot;:0.2891692954784437}]\u0026quot;' data-total-rows='9' data-total-columns='10' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='10' data-field-types='[[\u0026quot;ED_La Jolla\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;ED_Hillcrest\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;ED_East Campus\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;Floor_La Jolla\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;Floor_Hillcrest\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;Floor_East Campus\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;ICU_La Jolla\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;ICU_Hillcrest\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;ICU_East Campus\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;Discharge\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='true' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[[\u0026quot;\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]]]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "3ffbf2a43690019e7d3187833cc84d74", "console": [], "id": "vGiW", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": "07f3032b5b97f2e336ac211811cb4c29", "console": [], "id": "SYQT", "outputs": [{"data": {"text/html": "\u003Cmarimo-ui-element object-id='SYQT-0' random-id='8d2bd1e3-a0fb-6f72-fe48-a8f85e813a56'\u003E\u003Cmarimo-table data-initial-value='[]' data-label='null' data-data='\u0026quot;[{\u0026#92;\u0026quot;campus\u0026#92;\u0026quot;:\u0026#92;\u0026quot;East Campus\u0026#92;\u0026quot;,\u0026#92;\u0026quot;weekday_mean\u0026#92;\u0026quot;:92.4,\u0026#92;\u0026quot;weekday_std\u0026#92;\u0026quot;:10.5,\u0026#92;\u0026quot;weekend_mean\u0026#92;\u0026quot;:83.3,\u0026#92;\u0026quot;weekend_std\u0026#92;\u0026quot;:10.5},{\u0026#92;\u0026quot;campus\u0026#92;\u0026quot;:\u0026#92;\u0026quot;Hillcrest\u0026#92;\u0026quot;,\u0026#92;\u0026quot;weekday_mean\u0026#92;\u0026quot;:144.7,\u0026#92;\u0026quot;weekday_std\u0026#92;\u0026quot;:19.9,\u0026#92;\u0026quot;weekend_mean\u0026#92;\u0026quot;:125.1,\u0026#92;\u0026quot;weekend_std\u0026#92;\u0026quot;:10.3},{\u0026#92;\u0026quot;campus\u0026#92;\u0026quot;:\u0026#92;\u0026quot;La Jolla\u0026#92;\u0026quot;,\u0026#92;\u0026quot;weekday_mean\u0026#92;\u0026quot;:198.2,\u0026#92;\u0026quot;weekday_std\u0026#92;\u0026quot;:26.2,\u0026#92;\u0026quot;weekend_mean\u0026#92;\u0026quot;:148.9,\u0026#92;\u0026quot;weekend_std\u0026#92;\u0026quot;:14.5}]\u0026quot;' data-total-rows='3' data-total-columns='5' data-max-columns='50' data-banner-text='\u0026quot;\u0026quot;' data-pagination='true' data-page-size='10' data-field-types='[[\u0026quot;campus\u0026quot;,[\u0026quot;string\u0026quot;,\u0026quot;str\u0026quot;]],[\u0026quot;weekday_mean\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;weekday_std\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;weekend_mean\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]],[\u0026quot;weekend_std\u0026quot;,[\u0026quot;number\u0026quot;,\u0026quot;float64\u0026quot;]]]' data-show-filters='true' data-show-download='true' data-show-column-summaries='false' data-show-data-types='true' data-show-page-size-selector='false' data-show-column-explorer='true' data-show-chart-builder='true' data-row-headers='[]' data-has-stable-row-id='false' data-lazy='false' data-preload='false'\u003E\u003C/marimo-table\u003E\u003C/marimo-ui-element\u003E"}, "type": "data"}]}, {"code_hash": "079c15461fa339690a6a862553e29491", "console": [], "id": "bMrW", "outputs": [{"data": {"text/html": "\u003Cpre class='text-xs'\u003E\u0026lt;class \u0026#x27;dict\u0026#x27;\u0026gt;\u003C/pre\u003E"}, "type": "data"}]}, {"code_hash": "54e86e4a133db83451cc24c25e61e20d", "console": [], "id": "PSQn", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}, {"code_hash": null, "console": [], "id": "OfTS", "outputs": [{"data": {"text/plain": ""}, "type": "data"}]}], "metadata": {"marimo_version": "0.19.9"}, "version": "1"},
            "runtimeConfig": null,
        };
    </script>
  
<marimo-code hidden="">
    %23%20%2F%2F%2F%20script%0A%23%20requires-python%20%3D%20%22%3E%3D3.13%22%0A%23%20dependencies%20%3D%20%5B%0A%23%20%20%20%20%20%22ibis-framework%5Bduckdb%5D%3D%3D12.0.0%22%2C%0A%23%20%20%20%20%20%22marimo%3E%3D0.19.7%22%2C%0A%23%20%20%20%20%20%22matplotlib%3D%3D3.10.8%22%2C%0A%23%20%20%20%20%20%22numpy%3D%3D2.4.2%22%2C%0A%23%20%20%20%20%20%22pandas%3D%3D2.3.3%22%2C%0A%23%20%20%20%20%20%22scipy%3D%3D1.17.0%22%2C%0A%23%20%20%20%20%20%22seaborn%3D%3D0.13.2%22%2C%0A%23%20%20%20%20%20%22simpy%3D%3D4.1.1%22%2C%0A%23%20%20%20%20%20%22vidigi%3D%3D1.2.2%22%2C%0A%23%20%5D%0A%23%20%2F%2F%2F%0A%0Aimport%20marimo%0A%0A__generated_with%20%3D%20%220.19.9%22%0Aapp%20%3D%20marimo.App(width%3D%22medium%22%2C%20auto_download%3D%5B%22html%22%5D)%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20import%20marimo%20as%20mo%0A%20%20%20%20import%20ibis%0A%20%20%20%20import%20ibis.selectors%20as%20s%0A%20%20%20%20from%20ibis%20import%20_%0A%20%20%20%20import%20simpy%0A%20%20%20%20import%20random%0A%20%20%20%20import%20numpy%20as%20np%0A%20%20%20%20import%20pandas%20as%20pd%0A%20%20%20%20import%20matplotlib.pyplot%20as%20plt%0A%20%20%20%20from%20vidigi.resources%20import%20VidigiStore%0A%20%20%20%20from%20vidigi.logging%20import%20EventLogger%0A%20%20%20%20from%20vidigi.utils%20import%20EventPosition%2C%20create_event_position_df%0A%20%20%20%20from%20vidigi.animation%20import%20animate_activity_log%0A%20%20%20%20import%20re%0A%20%20%20%20from%20scipy%20import%20stats%0A%0A%20%20%20%20%23%20Set%20options%0A%20%20%20%20ibis.options.interactive%20%3D%20True%0A%20%20%20%20pd.set_option(%22display.max_columns%22%2C%20None)%0A%20%20%20%20return%20mo%2C%20np%2C%20pd%2C%20re%2C%20stats%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20PHI_COLS%20%3D%20%5B'event_id'%2C%20'pat_enc_csn_id'%2C%20'pat_id'%5D%0A%20%20%20%20return%20(PHI_COLS%2C)%0A%0A%0A%40app.cell%0Adef%20_(pd%2C%20re)%3A%0A%20%20%20%20def%20to_snake(name%3A%20str)%20-%3E%20str%3A%0A%20%20%20%20%20%20%20%20name%20%3D%20name.strip()%0A%20%20%20%20%20%20%20%20name%20%3D%20re.sub(r%22%5B%20%5C-%5D%2B%22%2C%20%22_%22%2C%20name)%0A%20%20%20%20%20%20%20%20name%20%3D%20re.sub(r%22(.)(%5BA-Z%5D%5Ba-z%5D%2B)%22%2C%20r%22%5C1_%5C2%22%2C%20name)%0A%20%20%20%20%20%20%20%20name%20%3D%20re.sub(r%22(%5Ba-z0-9%5D)(%5BA-Z%5D)%22%2C%20r%22%5C1_%5C2%22%2C%20name)%0A%20%20%20%20%20%20%20%20name%20%3D%20re.sub(r%22_%2B%22%2C%20%22_%22%2C%20name)%0A%20%20%20%20%20%20%20%20return%20name.lower()%0A%0A%20%20%20%20%23%20Load%20data%0A%20%20%20%20df%20%3D%20pd.read_csv('JCHI_ADT%20Extract_Event%20Dates%20CY2025.csv')%0A%0A%20%20%20%20%23%20convert%20columns%20to%20all%20snake%20case%0A%20%20%20%20df.columns%20%3D%20%5Bto_snake(c)%20for%20c%20in%20df.columns%5D%0A%0A%20%20%20%20%23%20Convert%20time%20and%20sort%0A%20%20%20%20df%5B%22effective_time%22%5D%20%3D%20pd.to_datetime(df%5B%22effective_time%22%5D)%0A%20%20%20%20df%20%3D%20df.sort_values(%0A%20%20%20%20%20%20%20%20by%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22pat_enc_csn_id%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22effective_time%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22seq_num_in_enc%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22event_id%22%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Show%20result%0A%20%20%20%20df.loc%5B%3A%2C%20~df.columns.isin(%5B'event_id'%2C%20'pat_enc_csn_id'%2C%20'pat_id'%5D)%5D%0A%20%20%20%20return%20(df%2C)%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Goal%3A%20to%20understand%20all%20of%20the%20columns%2C%20their%20data%20types%2C%20and%20events%20in%20each%20column.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20%23%20Display%20all%20columns%20and%20their%20data%20types%0A%20%20%20%20df.dtypes%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%23%20Column%20Definitions%20-%20JCHI%20ADT%20Data%0A%0A%20%20%20%20%23%23%20Patient%20Identifiers%0A%20%20%20%20-%20**pat_id**%20-%20Patient%20medical%20record%20number%20(same%20person%20across%20multiple%20visits)%0A%20%20%20%20-%20**pat_enc_csn_id**%20-%20Patient%20encounter%20ID%20(one%20unique%20hospital%20visit)%0A%0A%20%20%20%20%23%23%20Event%20Information%0A%20%20%20%20-%20**event_id**%20-%20Unique%20ID%20for%20this%20event%20record%0A%20%20%20%20-%20**event_type**%20-%20What%20happened%3A%20Admission%2C%20Transfer%20In%2C%20Transfer%20Out%2C%20Discharge%2C%20Census%2C%20Patient%20Update%0A%20%20%20%20-%20**event_type_c**%20-%20Numeric%20code%20for%20event_type%0A%20%20%20%20-%20**effective_time**%20-%20When%20this%20event%20occurred%0A%20%20%20%20-%20**seq_num_in_enc**%20-%20Order%20number%20of%20events%20within%20this%20encounter%20(1%2C%202%2C%203...)%0A%0A%20%20%20%20%23%23%20Transfer%20Tracking%0A%20%20%20%20-%20**linked_transfer_in_event_id**%20-%20Links%20to%20the%20%22transfer%20in%22%20event_id%0A%20%20%20%20-%20**linked_transfer_out_event_id**%20-%20Links%20to%20the%20%22transfer%20out%22%20event_id%0A%20%20%20%20-%20**transfer_type**%20-%20Why%20patient%20transferred%20(ED%20to%20Inpatient%2C%20Trauma%2C%20STEMI%2C%20etc.)%0A%0A%20%20%20%20%23%23%20Location%20Information%0A%20%20%20%20-%20**department_id**%20-%20Department%20ID%20number%0A%20%20%20%20-%20**department_name**%20-%20Name%20of%20department%2Funit%20(e.g.%2C%20%22LJ%20EMERGENCY%20DEPT%22%2C%20%22HC%202-SICU%22)%0A%20%20%20%20-%20**department_group**%20-%20Care%20level%20grouping%20(MedSurg%2C%20ICU%2C%20PCU%2C%20OB%2C%20etc.)%0A%20%20%20%20-%20**location**%20-%20Specific%20location%20description%0A%20%20%20%20-%20**room_id**%20%2F%20**room_csn_id**%20%2F%20**room**%20-%20Room%20identifiers%20and%20name%0A%20%20%20%20-%20**bed_id**%20%2F%20**bed_csn_id**%20%2F%20**bed**%20-%20Bed%20identifiers%20and%20name%0A%0A%20%20%20%20%23%23%20Patient%20Classification%0A%20%20%20%20-%20**base_patient_class**%20-%20Simplified%3A%20Emergency%2C%20Inpatient%2C%20or%20Outpatient%0A%20%20%20%20-%20**base_pat_class_c**%20-%20Numeric%20code%20for%20base_patient_class%0A%20%20%20%20-%20**patient_class**%20-%20Detailed%20class%20(e.g.%2C%20%22Inpatient%20Admission%22%2C%20%22Emergency%20Department%20-%20Encounter%22)%0A%20%20%20%20-%20**pat_class_c**%20-%20Numeric%20code%20for%20patient_class%0A%20%20%20%20-%20**patient_levelof_care**%20-%20Level%20of%20care%20needed%20(text)%0A%20%20%20%20-%20**pat_lvl_of_care_c**%20-%20Level%20of%20care%20code%20(numeric)%0A%0A%20%20%20%20%23%23%20Clinical%20Service%0A%20%20%20%20-%20**hospital_service**%20-%20Which%20clinical%20team%20(Emergency%20Medicine%2C%20Cardiology%2C%20Trauma%20Surgery%2C%20etc.)%0A%20%20%20%20-%20**pat_service_c**%20-%20Numeric%20code%20for%20hospital_service%0A%0A%20%20%20%20%23%23%20Bed%20Request%20Tracking%20(often%20empty)%0A%20%20%20%20-%20**pend_id**%20-%20Pending%20bed%20request%20ID%0A%20%20%20%20-%20**bed_request_created_dttm**%20-%20When%20bed%20was%20requested%0A%20%20%20%20-%20**bed_request_first_readyto_plan_dttm**%20-%20Ready%20for%20bed%20planning%0A%20%20%20%20-%20**bed_request_first_preassigned_dttm**%20-%20Bed%20pre-assigned%0A%20%20%20%20-%20**bed_request_first_assigned_dttm**%20-%20Bed%20officially%20assigned%0A%20%20%20%20-%20**bed_request_first_bed_ready_dttm**%20-%20Bed%20physically%20ready%0A%20%20%20%20-%20**bed_request_first_readyto_move_dttm**%20-%20Patient%20ready%20to%20move%0A%0A%20%20%20%20%23%23%20Other%0A%20%20%20%20-%20**tc_admit_flag**%20-%20Flag%20indicating%20admission%20event%0A%20%20%20%20-%20**referring_location**%20-%20Where%20patient%20was%20referred%20from%0A%0A%20%20%20%20---%0A%0A%20%20%20%20**Total%3A%2037%20columns**%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20%23%20Look%20at%20first%20few%20rows%20with%20all%20columns%20visible%0A%20%20%20%20df.head(10)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20%23%20Event%20types%2C%20what%20kinds%20of%20events%20do%20we%20have%3F%0A%20%20%20%20print(%22Unique%20Event%20Types%3A%22)%0A%20%20%20%20print(df%5B'event_type'%5D.value_counts())%0A%20%20%20%20print(f%22%5CnTotal%20unique%20event%20types%3A%20%7Bdf%5B'event_type'%5D.nunique()%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%23%23%20Why%20are%20there%20way%20more%20discharges%20than%20admissions%3F%0A%0A%20%20%20%20Looking%20at%20event%20types%3A%0A%20%20%20%20-%20Admissions%3A%20229%2C440%0A%20%20%20%20-%20Discharges%3A%20983%2C931%0A%0A%20%20%20%20That's%204-5x%20more%20discharges%20than%20admissions%2C%20which%20doesn't%20make%20sense.%20You%20can't%20discharge%20more%20people%20than%20you%20admit.%0A%0A%20%20%20%20What's%20probably%20happening%3A%0A%20%20%20%20-%20%22Discharge%22%20might%20include%20ED%20patients%20who%20go%20home%20without%20being%20admitted%0A%20%20%20%20-%20Outpatient%20visits%20that%20end%20also%20get%20counted%20as%20discharges%0A%20%20%20%20-%20We%20need%20to%20check%20if%20this%20is%20true%0A%0A%20%20%20%20Let's%20look%20at%20what%20patient%20classes%20are%20getting%20%22discharged%22%20vs%20%22admitted%22%20to%20figure%20out%20what's%20actually%20going%20on.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20%23%20What%20patient%20classes%20have%20Discharge%20events%3F%0A%20%20%20%20discharge_events%20%3D%20df%5Bdf%5B'event_type'%5D%20%3D%3D%20'Discharge'%5D%0A%20%20%20%20discharge_classes%20%3D%20discharge_events%5B'patient_class'%5D.value_counts()%0A%20%20%20%20print(%22Discharges%20by%20Patient%20Class%3A%22)%0A%20%20%20%20print(f%22Total%20unique%20classes%3A%20%7Blen(discharge_classes)%7D%5Cn%22)%0A%20%20%20%20for%20class_name%2C%20class_count%20in%20discharge_classes.items()%3A%0A%20%20%20%20%20%20%20%20print(f%22%7Bclass_name%7D%3A%20%7Bclass_count%3A%2C%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20%23%20What%20about%20Admissions%3F%0A%20%20%20%20admission_events%20%3D%20df%5Bdf%5B'event_type'%5D%20%3D%3D%20'Admission'%5D%0A%20%20%20%20admission_classes%20%3D%20admission_events%5B'patient_class'%5D.value_counts()%0A%20%20%20%20print(%22Admissions%20by%20Patient%20Class%3A%22)%0A%20%20%20%20print(f%22Total%20unique%20classes%3A%20%7Blen(admission_classes)%7D%5Cn%22)%0A%20%20%20%20for%20admit_class%2C%20admit_count%20in%20admission_classes.items()%3A%0A%20%20%20%20%20%20%20%20print(f%22%7Badmit_class%7D%3A%20%7Badmit_count%3A%2C%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20Most%20%22Discharges%22%20are%20outpatients.%20Looking%20at%20the%20discharge%20and%20admission%20breakdown%20by%20patient%20class%2C%20we%20found%20that%20the%20majority%20of%20the%20983K%20discharges%20are%20from%20outpatient%20visits%20-%20people%20coming%20in%20for%20radiology%2C%20infusion%20therapy%2C%20procedures%2C%20clinic%20visits%2C%20etc.%20They%20come%20in%2C%20get%20their%20service%2C%20and%20leave%20the%20same%20day%2C%20which%20gets%20recorded%20as%20a%20%22discharge%22%20even%20though%20they%20were%20never%20%22admitted%22%20in%20the%20traditional%20sense.%20This%20explains%20why%20there%20are%20way%20more%20discharges%20than%20admissions%20overall.%20However%2C%20there%20are%20still%20weird%20discrepancies%20even%20within%20inpatient%20and%20ED%20encounters%20-%20for%20example%2C%2038K%20inpatient%20discharges%20but%20only%203K%20inpatient%20admissions.%20This%20suggests%20there%20might%20be%20data%20quality%20issues%20like%20duplicate%20discharge%20records%2C%20missing%20admission%20records%2C%20or%20the%20event%20types%20mean%20something%20different%20than%20we%20expect.%20We%20need%20to%20investigate%20these%20discrepancies%20before%20we%20can%20reliably%20model%20patient%20flow.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(events_per_encounter)%3A%0A%20%20%20%20events_per_encounter%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(PHI_COLS%2C%20df)%3A%0A%20%20%20%20%23%20Checking%20-%20how%20many%20events%20per%20encounter%3F%0A%20%20%20%20events_per_encounter%20%3D%20df.groupby('pat_enc_csn_id')%5B'event_type'%5D.value_counts().unstack(fill_value%3D0)%0A%20%20%20%20print(%22Sample%20of%20events%20per%20encounter%20(first%2010)%3A%22)%0A%20%20%20%20print(events_per_encounter.reset_index().loc%5B%3A%2C%20~events_per_encounter.reset_index().columns.isin(PHI_COLS)%5D.head(10))%0A%20%20%20%20print(%22%5CnSummary%20stats%3A%22)%0A%20%20%20%20print(events_per_encounter.describe())%0A%20%20%20%20return%20(events_per_encounter%2C)%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20%23%20Checking%20-%20do%20encounters%20have%20multiple%20discharges%3F%0A%20%20%20%20discharges_per_encounter%20%3D%20df%5Bdf%5B'event_type'%5D%20%3D%3D%20'Discharge'%5D.groupby('pat_enc_csn_id').size()%0A%20%20%20%20print(f%22Encounters%20with%20discharges%3A%20%7Blen(discharges_per_encounter)%3A%2C%7D%22)%0A%20%20%20%20print(f%22Encounters%20with%20%3E1%20discharge%3A%20%7B(discharges_per_encounter%20%3E%201).sum()%3A%2C%7D%22)%0A%20%20%20%20print(f%22%5CnMax%20discharges%20in%20one%20encounter%3A%20%7Bdischarges_per_encounter.max()%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20%23%20Checking%20-%20do%20encounters%20have%20multiple%20admissions%3F%0A%20%20%20%20admissions_per_encounter%20%3D%20df%5Bdf%5B'event_type'%5D%20%3D%3D%20'Admission'%5D.groupby('pat_enc_csn_id').size()%0A%20%20%20%20print(f%22Encounters%20with%20admissions%3A%20%7Blen(admissions_per_encounter)%3A%2C%7D%22)%0A%20%20%20%20print(f%22Encounters%20with%20%3E1%20admission%3A%20%7B(admissions_per_encounter%20%3E%201).sum()%3A%2C%7D%22)%0A%20%20%20%20print(f%22%5CnMax%20admissions%20in%20one%20encounter%3A%20%7Badmissions_per_encounter.max()%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20No%20duplicate%20events%2C%20but%20not%20all%20encounters%20have%20admissions.%20We%20discovered%20that%20each%20encounter%20has%20exactly%201%20discharge%2C%20no%20duplicates%2C%20clean%20data.%20Each%20encounter%20has%20exactly%201%20admission%20(when%20it%20has%20one)%20-%20no%20duplicates%2C%20clean%20data.%20BUT%20only%2023%25%20of%20encounters%20have%20an%20%22Admission%22%20event%20-%20this%20is%20the%20key!%0A%0A%20%20%20%20Looking%20at%20the%20summary%20stats%3A%0A%0A%20%20%20%20-%20Mean%20discharges%20per%20encounter%3A%200.999%20(almost%20everyone)%0A%20%20%20%20-%20Mean%20admissions%20per%20encounter%3A%200.233%20(only%2023%25!)%0A%20%20%20%20-%20This%20explains%20why%20983K%20discharges%20vs%20229K%20admissions%0A%0A%20%20%20%20What%20does%20this%20mean%3F%20Basically%2C%20outpatient%20visits%20get%20a%20%22Discharge%22%20when%20they%20leave%2C%20but%20never%20had%20an%20%22Admission%22.%20ED%20visits%20that%20go%20home%20%22Discharge%22%20from%20ED%20without%20hospital%20%22Admission%22.%20True%20inpatient%20stays%20should%20have%20both%20%22Admission%22%20AND%20%22Discharge%22.%0A%0A%20%20%20%20Some%20wild%20outliers%3A%0A%0A%20%20%20%20-%20One%20encounter%20has%20364%20Census%20events%20(daily%20snapshots%20over%20a%20year)%0A%20%20%20%20-%20One%20encounter%20has%2068%20transfers!%0A%0A%20%20%20%20The%20issue%20is%20that%20%22Admission%22%20and%20%22Discharge%22%20as%20event%20types%20mean%20different%20things%20depending%20on%20the%20encounter%20type.%0A%0A%20%20%20%20For%20our%20patient%20flow%20model%2C%20we%20don't%20need%20to%20worry%20about%20these%20administrative%20labels.%20Instead%2C%20we%20need%20to%20focus%20on%20the%20Transfer%20events%20which%20show%20actual%20physical%20movement%20between%20units.%20Let's%20look%20at%20what%20transfer%20patterns%20exist%20in%20the%20data.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20%23%20Patient%20classes%2C%20what%20types%20of%20patients%3F%0A%20%20%20%20print(%22Unique%20Patient%20Classes%3A%22)%0A%20%20%20%20all_patient_classes%20%3D%20df%5B'patient_class'%5D.value_counts()%0A%20%20%20%20print(f%22Total%20unique%20patient%20classes%3A%20%7Blen(all_patient_classes)%7D%22)%0A%20%20%20%20for%20patient_class%2C%20count%20in%20all_patient_classes.items()%3A%0A%20%20%20%20%20%20%20%20print(f%22%7Bpatient_class%7D%3A%20%7Bcount%3A%2C%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20%23%20Department%20names%2C%20where%20are%20patients%20located%3F%0A%20%20%20%20all_departments%20%3D%20df%5B'department_name'%5D.value_counts()%0A%20%20%20%20print(f%22Total%20unique%20departments%3A%20%7Blen(all_departments)%7D%22)%0A%20%20%20%20for%20dept_name%2C%20dept_count%20in%20all_departments.items()%3A%0A%20%20%20%20%20%20%20%20print(f%22%7Bdept_name%7D%3A%20%7Bdept_count%3A%2C%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20%23%20Department%20groups%2C%20what%20are%20the%20higher%20level%20groupings%3F%0A%20%20%20%20print(%22Unique%20Department%20Groupings%3A%22)%0A%20%20%20%20print(df%5B'department_group'%5D.value_counts())%0A%20%20%20%20print(f%22%5CnTotal%20unique%20department%20groups%3A%20%7Bdf%5B'department_group'%5D.nunique()%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20%23%20Hospital%20services%2C%20what%20service%20lines%3F%0A%20%20%20%20all_services%20%3D%20df%5B'hospital_service'%5D.value_counts()%0A%20%20%20%20print(f%22Total%20unique%20hospital%20services%3A%20%7Blen(all_services)%7D%22)%0A%20%20%20%20for%20service_name%2C%20service_count%20in%20all_services.items()%3A%0A%20%20%20%20%20%20%20%20print(f%22%7Bservice_name%7D%3A%20%7Bservice_count%3A%2C%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20%23%20Transfer%20types%0A%20%20%20%20all_transfer_types%20%3D%20df%5B'transfer_type'%5D.value_counts()%0A%20%20%20%20print(f%22Total%20unique%20transfer%20types%3A%20%7Blen(all_transfer_types)%7D%22)%0A%20%20%20%20for%20transfer_name%2C%20transfer_count%20in%20all_transfer_types.items()%3A%0A%20%20%20%20%20%20%20%20print(f%22%7Btransfer_name%7D%3A%20%7Btransfer_count%3A%2C%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20%23%20Look%20at%20transfers%20between%20department_groups%20(the%20tiers)%0A%20%20%20%20transfer_data%20%3D%20df%5Bdf%5B'event_type'%5D.isin(%5B'Transfer%20In'%2C%20'Transfer%20Out'%5D)%5D%0A%0A%20%20%20%20%23%20What%20tiers%20do%20patients%20transfer%20between%3F%0A%20%20%20%20print(%22Transfers%20by%20department%20group%3A%22)%0A%20%20%20%20print(transfer_data%5B'department_group'%5D.value_counts())%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20%23%20Base%20patient%20class%0A%20%20%20%20print(%22Unique%20Base%20Patient%20Classes%3A%22)%0A%20%20%20%20print(df%5B'base_patient_class'%5D.value_counts())%0A%20%20%20%20print(f%22%5CnTotal%20unique%20base%20patient%20classes%3A%20%7Bdf%5B'base_patient_class'%5D.nunique()%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20%23%20Do%20patients%20change%20class%20during%20an%20encounter%3F%0A%20%20%20%20class_changes%20%3D%20df.groupby('pat_enc_csn_id')%5B'patient_class'%5D.nunique()%0A%20%20%20%20print(f%22Encounters%20with%20class%20changes%3A%20%7B(class_changes%20%3E%201).sum()%3A%2C%7D%22)%0A%20%20%20%20print(f%22Total%20encounters%3A%20%7Bdf%5B'pat_enc_csn_id'%5D.nunique()%3A%2C%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20Looking%20at%20the%20transfer%20data%2C%20we%20can%20see%20clear%20patterns%20of%20patient%20movement%3A%0A%0A%20%20%20%20**Transfer%20Types%3A**%0A%20%20%20%20-%20Inpatient%20to%20Inpatient%3A%2026%2C139%20(most%20common%20-%20patients%20moving%20between%20units)%0A%20%20%20%20-%20ED%20to%20Inpatient%3A%2016%2C344%20(patients%20getting%20admitted%20from%20ED)%0A%20%20%20%20-%20ED%20to%20ED%3A%2014%2C184%20(transfers%20between%20emergency%20departments)%0A%20%20%20%20-%20Trauma%3A%2011%2C336%20(trauma%20activations)%0A%20%20%20%20-%20Specialty%20transfers%3A%20ECMO%2C%20Stroke%2C%20STEMI%2C%20Transplant%2C%20Burn%20(time-sensitive%20care)%0A%0A%20%20%20%20**Transfer%20Activity%20by%20Tier%3A**%0A%20%20%20%20-%20OB%3A%2050%2C241%20transfers%20(obstetrics%20-%20lots%20of%20movement)%0A%20%20%20%20-%20MedSurg%3A%2034%2C207%20(general%20medical%2Fsurgical%20floors%20-%20Tier%202)%0A%20%20%20%20-%20PCU%3A%2027%2C195%20(progressive%20care%20-%20Tier%202)%0A%20%20%20%20-%20ICU%3A%2024%2C187%20(intensive%20care%20-%20Tier%203)%0A%20%20%20%20-%20IMU%3A%2016%2C756%20(intermediate%20medical%20-%20Tier%202)%0A%20%20%20%20-%20NICU%3A%203%2C658%20(neonatal%20intensive%20care%20-%20Tier%203)%0A%0A%20%20%20%20We%20have%20good%20transfer%20data%20across%20all%20three%20tiers.%20The%20transfer%20events%20will%20let%20us%20build%20a%20transition%20matrix%20showing%20how%20patients%20move%20between%20ED%2C%20regular%20floors%2C%20and%20ICU%20across%20the%20different%20hospitals.%0A%0A%20%20%20%20Next%20step%20is%20to%20filter%20the%20data%20to%20focus%20on%20encounters%20with%20actual%20patient%20flow%20(those%20with%20transfers)%2C%20then%20build%20the%20transition%20matrix.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20%23%20How%20many%20events%20does%20each%20encounter%20have%3F%0A%20%20%20%20encounter_event_counts%20%3D%20df.groupby('pat_enc_csn_id').size()%0A%0A%20%20%20%20print(%22Events%20per%20encounter%3A%22)%0A%20%20%20%20print(f%22Min%3A%20%7Bencounter_event_counts.min()%7D%22)%0A%20%20%20%20print(f%22Max%3A%20%7Bencounter_event_counts.max()%7D%22)%0A%20%20%20%20print(f%22Mean%3A%20%7Bencounter_event_counts.mean()%3A.2f%7D%22)%0A%20%20%20%20print(f%22Median%3A%20%7Bencounter_event_counts.median()%3A.0f%7D%22)%0A%20%20%20%20print(f%22%5CnEncounters%20with%20only%201%20event%3A%20%7B(encounter_event_counts%20%3D%3D%201).sum()%3A%2C%7D%22)%0A%20%20%20%20print(f%22Percentage%3A%20%7B(encounter_event_counts%20%3D%3D%201).sum()%20%2F%20len(encounter_event_counts)%20*%20100%3A.1f%7D%25%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20%23%20Check%20encounters%20with%20NO%20transfers%20(arrive%20and%20leave%20only)%0A%20%20%20%20encounters_with_transfers%20%3D%20df%5Bdf%5B'event_type'%5D.isin(%5B'Transfer%20In'%2C%20'Transfer%20Out'%5D)%5D%5B'pat_enc_csn_id'%5D.unique()%0A%20%20%20%20total_encounters%20%3D%20df%5B'pat_enc_csn_id'%5D.nunique()%0A%20%20%20%20no_transfer_encounters%20%3D%20total_encounters%20-%20len(encounters_with_transfers)%0A%0A%20%20%20%20print(f%22Total%20encounters%3A%20%7Btotal_encounters%3A%2C%7D%22)%0A%20%20%20%20print(f%22Encounters%20WITH%20transfers%3A%20%7Blen(encounters_with_transfers)%3A%2C%7D%22)%0A%20%20%20%20print(f%22Encounters%20WITHOUT%20transfers%3A%20%7Bno_transfer_encounters%3A%2C%7D%22)%0A%20%20%20%20print(f%22Percentage%20without%20transfers%3A%20%7Bno_transfer_encounters%20%2F%20total_encounters%20*%20100%3A.1f%7D%25%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df%2C%20events_per_encounter)%3A%0A%20%20%20%20%23%20What%20are%20these%20single-event%20encounters%3F%0A%20%20%20%20single_event_encounters%20%3D%20df%5Bdf%5B'pat_enc_csn_id'%5D.isin(events_per_encounter%5Bevents_per_encounter%20%3D%3D%201%5D.index)%5D%0A%20%20%20%20print(%22Single%20event%20encounters%20by%20event%20type%3A%22)%0A%20%20%20%20print(single_event_encounters%5B'event_type'%5D.value_counts())%0A%20%20%20%20print(%22%5CnSingle%20event%20encounters%20by%20patient%20class%3A%22)%0A%20%20%20%20print(single_event_encounters%5B'patient_class'%5D.value_counts().head(10))%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20%23%20Check%20linked%20Transfer%20Out%20%E2%86%92%20Transfer%20In%20pairs%0A%20%20%20%20%23%20Use%20linked_transfer_out_event_id%20to%20connect%20them%0A%0A%20%20%20%20%23%20Get%20Transfer%20Out%20events%20with%20their%20department%0A%20%20%20%20transfer_out%20%3D%20df%5Bdf%5B'event_type'%5D%20%3D%3D%20'Transfer%20Out'%5D%5B%5B'event_id'%2C%20'pat_enc_csn_id'%2C%20'department_name'%2C%20'department_group'%2C%20'effective_time'%5D%5D%0A%20%20%20%20transfer_out%20%3D%20transfer_out.rename(columns%3D%7B'event_id'%3A%20'transfer_out_id'%2C%20'department_name'%3A%20'from_dept'%2C%20'department_group'%3A%20'from_group'%2C%20'effective_time'%3A%20'out_time'%7D)%0A%0A%20%20%20%20%23%20Get%20Transfer%20In%20events%20with%20their%20department%0A%20%20%20%20transfer_in%20%3D%20df%5Bdf%5B'event_type'%5D%20%3D%3D%20'Transfer%20In'%5D%5B%5B'event_id'%2C%20'pat_enc_csn_id'%2C%20'department_name'%2C%20'department_group'%2C%20'effective_time'%2C%20'linked_transfer_out_event_id'%5D%5D%0A%20%20%20%20transfer_in%20%3D%20transfer_in.rename(columns%3D%7B'department_name'%3A%20'to_dept'%2C%20'department_group'%3A%20'to_group'%2C%20'effective_time'%3A%20'in_time'%7D)%0A%0A%20%20%20%20%23%20Merge%20them%0A%20%20%20%20transfers%20%3D%20transfer_in.merge(transfer_out%2C%20left_on%3D'linked_transfer_out_event_id'%2C%20right_on%3D'transfer_out_id'%2C%20suffixes%3D(''%2C%20'_out'))%0A%0A%20%20%20%20print(f%22Total%20linked%20transfers%3A%20%7Blen(transfers)%3A%2C%7D%22)%0A%20%20%20%20print(f%22%5CnTransfers%20within%20SAME%20department%3A%20%7B(transfers%5B'from_dept'%5D%20%3D%3D%20transfers%5B'to_dept'%5D).sum()%3A%2C%7D%22)%0A%20%20%20%20print(f%22Transfers%20to%20DIFFERENT%20department%3A%20%7B(transfers%5B'from_dept'%5D%20!%3D%20transfers%5B'to_dept'%5D).sum()%3A%2C%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20Issue%201%3A%20Most%20encounters%20have%20only%201%20event%20(76.6%25)%0A%20%20%20%20-%20These%20are%20mostly%20outpatient%20visits%20(radiology%2C%20infusion%2C%20procedures)%0A%20%20%20%20-%20Also%20ED%20visits%20that%20discharge%20home%0A%20%20%20%20-%20They%20have%201%20event%20and%20leave%20-%20no%20patient%20flow%20to%20model%2C%20at%20least%20for%20right%20now%20while%20we%20build%20the%20simple%20model.%0A%0A%20%20%20%20Issue%202%3A%2091.5%25%20of%20encounters%20have%20NO%20transfers%0A%20%20%20%20-%20Only%2083%2C423%20encounters%20(8.5%25)%20actually%20have%20transfer%20events%20between%20units%0A%20%20%20%20-%20BUT%20this%20doesn't%20mean%20the%20other%2091.5%25%20are%20irrelevant!%0A%20%20%20%20-%20Many%20are%20still%20valid%20patient%20flow%3A%20ED%20%E2%86%92%20Discharge%2C%20ICU%20%E2%86%92%20Discharge%20(these%20are%20important%20transitions)%0A%20%20%20%20-%20The%20real%20question%20is%20what%20TYPE%20of%20encounters%20to%20include%20(ED%2FICU%2FFloor%20vs%20Outpatient)%2C%20not%20whether%20they%20have%20transfers%0A%20%20%20%20-%20We'll%20decide%20which%20encounter%20types%20to%20keep%20after%20looking%20at%20the%20data%20more%20carefully%0A%0A%20%20%20%20Issue%203%3A%20Same%20Department%20Bed%20Changes%0A%20%20%20%20-%20Out%20of%20207%2C300%20total%20transfers%3A%0A%20%20%20%20%20%20-%2082%2C058%20(40%25)%20are%20within%20the%20SAME%20department%20-%20just%20bed%20changes!%0A%20%20%20%20%20%20-%20125%2C242%20(60%25)%20are%20to%20DIFFERENT%20departments%20-%20actual%20patient%20flow!%0A%20%20%20%20%20%20-%20We%20need%20to%20filter%20these%20out.%0A%0A%20%20%20%20What%20This%20Means%20for%20Data%20Cleaning%3A%0A%0A%20%20%20%201.%20Filter%20by%20encounter%20TYPE%20(keep%20ED%2FICU%2FFloor%2C%20remove%20outpatient)%2C%20not%20by%20whether%20they%20have%20transfers%0A%20%20%20%202.%20Only%20use%20transfers%20to%20DIFFERENT%20departments%20(125%2C242%20transfers)%0A%20%20%20%203.%20Ignore%20same-department%20bed%20shuffles%20(82%2C058%20transfers)%0A%0A%20%20%20%20This%20will%20give%20us%20clean%20patient%20flow%20data%20for%20the%20transition%20matrix.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20What%20Encounters%20Do%20We%20Have%3F%0A%0A%20%20%20%20Before%20filtering%2C%20let's%20see%20all%20the%20encounter%20types%20and%20decide%20which%20ones%20are%20relevant%20for%20ED%20%E2%86%92%20Floor%20%E2%86%92%20ICU%20flow%20modeling.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20%23%20Look%20at%20combinations%20of%20patient_class%20and%20department_group%0A%20%20%20%20encounter_summary%20%3D%20df.groupby(%5B'patient_class'%2C%20'department_group'%5D).size().reset_index(name%3D'count')%0A%20%20%20%20encounter_summary%20%3D%20encounter_summary.sort_values('count'%2C%20ascending%3DFalse)%0A%0A%20%20%20%20print(%22Patient%20Class%20%2B%20Department%20Group%20combinations%3A%22)%0A%20%20%20%20print(encounter_summary.to_string(index%3DFalse))%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20%23%20Also%20-%20which%20patient%20classes%20appear%20in%20ED%2C%20ICU%2C%20MedSurg%3F%0A%20%20%20%20ed_classes%20%3D%20df%5Bdf%5B'department_name'%5D.str.contains('EMERGENCY'%2C%20na%3DFalse)%5D%5B'patient_class'%5D.value_counts()%0A%20%20%20%20print(%22%5CnPatient%20classes%20in%20ED%3A%22)%0A%20%20%20%20print(ed_classes)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20icu_classes%20%3D%20df%5Bdf%5B'department_group'%5D%20%3D%3D%20'ICU'%5D%5B'patient_class'%5D.value_counts()%0A%20%20%20%20print(%22%5CnPatient%20classes%20in%20ICU%3A%22)%0A%20%20%20%20print(icu_classes)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20floor_classes%20%3D%20df%5Bdf%5B'department_group'%5D.isin(%5B'MedSurg'%2C%20'PCU'%2C%20'IMU'%5D)%5D%5B'patient_class'%5D.value_counts()%0A%20%20%20%20print(%22%5CnPatient%20classes%20on%20Floors%20(MedSurg%2FPCU%2FIMU)%3A%22)%0A%20%20%20%20print(floor_classes)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(%22%22%22%0A%20%20%20%20%23%23%20Data%20Filtering%20Plan%3A%20What%20We%20Are%20Keeping%20vs%20Removing%20and%20Why%0A%0A%20%20%20%20Keeping%20patients%20who%20occupy%20beds%20and%20can%20move%20between%20units%3A%0A%20%20%20%20-%20Inpatient%20Admission%0A%20%20%20%20-%20Emergency%20Department%20-%20Encounter%0A%20%20%20%20-%20Trauma%20Inpatient%20Admission%0A%20%20%20%20-%20Observation%0A%20%20%20%20-%20Trauma%20Observation%20Admission%0A%20%20%20%20-%20Hospital%20Inpatient%20Surgery%0A%20%20%20%20-%20Inpatient%20Psychiatry%0A%20%20%20%20-%20Newborn%0A%20%20%20%20-%20Surgical%20OB%20Patient%0A%20%20%20%20-%20Outpatient%20in%20a%20Bed%20(they're%20in%20ICU%2FMedSurg%2FPCU%20-%20physical%20beds!)%0A%20%20%20%20-%20Outpatient%20Labor%20and%20Delivery%20-%20Encounter%20(in%20OB%20units)%0A%0A%20%20%20%20Removing%20same-day%20outpatient%20services%20(no%20bed%2C%20no%20movement)%3A%0A%20%20%20%20-%20Outpatient%20Radiology%20-%20Encounter%0A%20%20%20%20-%20Outpatient%20Infusion%20-%20Encounter%0A%20%20%20%20-%20Outpatient%20Radiation%20Oncology%20-%20Series%0A%20%20%20%20-%20Hospital%20Outpatient%20Procedure%0A%20%20%20%20-%20Hospital%20Outpatient%20Surgery%0A%20%20%20%20-%20Outpatient%20Clinic%20Visit%20-%20Encounter%0A%20%20%20%20-%20Outpatient%20Physical%20Therapy%20-%20Series%0A%20%20%20%20-%20Outpatient%20Other%20-%20Encounter%0A%20%20%20%20-%20Lab%20Referred%20Specimen%0A%20%20%20%20-%20Telemedicine%20-%20Encounter%0A%20%20%20%20-%20All%20other%20%22Outpatient%20%5Bservice%5D%20-%20Series%2FEncounter%22%0A%20%20%20%20-%20Trauma%20Outpatient%20(unless%20in%20a%20bed)%0A%0A%20%20%20%20This%20will%20give%20us%20clean%20patient%20flow%20data%20for%20the%209%C3%9710%20transition%20matrix.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df)%3A%0A%20%20%20%20%23%20Filter%20by%20patient_class%20to%20identify%20which%20encounters%20involve%20physical%20bed%20occupancy%20in%20hospital%20units%0A%20%20%20%20%23%20Does%20this%20patient_class%20represent%20someone%20who%20occupies%20a%20physical%20bed%20in%20a%20hospital%20unit%20(ED%2FFloor%2FICU)%20and%20could%20potentially%20transfer%20between%20units%3F%0A%20%20%20%20keep_classes%20%3D%20%5B%0A%20%20%20%20%20%20%20%20'Inpatient%20Admission'%2C%0A%20%20%20%20%20%20%20%20'Emergency%20Department%20-%20Encounter'%2C%0A%20%20%20%20%20%20%20%20'Trauma%20Inpatient%20Admission'%2C%0A%20%20%20%20%20%20%20%20'Observation'%2C%0A%20%20%20%20%20%20%20%20'Trauma%20Observation%20Admission'%2C%0A%20%20%20%20%20%20%20%20'Hospital%20Inpatient%20Surgery'%2C%0A%20%20%20%20%20%20%20%20'Inpatient%20Psychiatry'%2C%0A%20%20%20%20%20%20%20%20'Newborn'%2C%0A%20%20%20%20%20%20%20%20'Surgical%20OB%20Patient'%2C%0A%20%20%20%20%20%20%20%20'Outpatient%20in%20a%20Bed'%2C%0A%20%20%20%20%20%20%20%20'Outpatient%20Labor%20and%20Delivery%20-%20Encounter'%0A%20%20%20%20%5D%0A%0A%20%20%20%20%23%20Filter%20the%20data%0A%20%20%20%20df_filtered%20%3D%20df%5Bdf%5B'patient_class'%5D.isin(keep_classes)%5D.copy()%0A%0A%20%20%20%20print(f%22Original%20data%3A%20%7Blen(df)%3A%2C%7D%20rows%2C%20%7Bdf%5B'pat_enc_csn_id'%5D.nunique()%3A%2C%7D%20encounters%22)%0A%20%20%20%20print(f%22Filtered%20data%3A%20%7Blen(df_filtered)%3A%2C%7D%20rows%2C%20%7Bdf_filtered%5B'pat_enc_csn_id'%5D.nunique()%3A%2C%7D%20encounters%22)%0A%20%20%20%20print(f%22Removed%3A%20%7Blen(df)%20-%20len(df_filtered)%3A%2C%7D%20rows%20(%7B(len(df)%20-%20len(df_filtered))%2Flen(df)*100%3A.1f%7D%25)%22)%0A%20%20%20%20return%20df_filtered%2C%20keep_classes%0A%0A%0A%40app.cell%0Adef%20_(df%2C%20keep_classes)%3A%0A%20%20%20%20%23%20What%20patient%20classes%20did%20we%20REMOVE%3F%0A%20%20%20%20data_removed%20%3D%20df%5B~df%5B'patient_class'%5D.isin(keep_classes)%5D%0A%20%20%20%20classes_removed%20%3D%20data_removed%5B'patient_class'%5D.value_counts()%0A%20%20%20%20print(%22Removed%20Patient%20Classes%3A%22)%0A%20%20%20%20print(f%22Total%20classes%20removed%3A%20%7Blen(classes_removed)%7D%5Cn%22)%0A%20%20%20%20for%20removed_class_name%2C%20removed_class_count%20in%20classes_removed.items()%3A%0A%20%20%20%20%20%20%20%20print(f%22%7Bremoved_class_name%7D%3A%20%7Bremoved_class_count%3A%2C%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_filtered)%3A%0A%20%20%20%20%23%20What%20patient%20classes%20did%20we%20KEEP%3F%0A%20%20%20%20print(%22%5CnKept%20Patient%20Classes%3A%22)%0A%20%20%20%20print(df_filtered%5B'patient_class'%5D.value_counts())%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_filtered)%3A%0A%20%20%20%20%23%20Check%3A%20Do%20filtered%20encounters%20have%20transfers%3F%0A%20%20%20%20filtered_encounters_with_transfers%20%3D%20df_filtered%5Bdf_filtered%5B'event_type'%5D.isin(%5B'Transfer%20In'%2C%20'Transfer%20Out'%5D)%5D%5B'pat_enc_csn_id'%5D.nunique()%0A%20%20%20%20print(f%22%5CnFiltered%20encounters%3A%20%7Bdf_filtered%5B'pat_enc_csn_id'%5D.nunique()%3A%2C%7D%22)%0A%20%20%20%20print(f%22Filtered%20encounters%20with%20transfers%3A%20%7Bfiltered_encounters_with_transfers%3A%2C%7D%22)%0A%20%20%20%20print(f%22Percentage%20with%20transfers%3A%20%7Bfiltered_encounters_with_transfers%20%2F%20df_filtered%5B'pat_enc_csn_id'%5D.nunique()%20*%20100%3A.1f%7D%25%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_filtered)%3A%0A%20%20%20%20%23%20What%20department_groups%20remain%3F%0A%20%20%20%20print(%22%5CnDepartment%20Groups%20in%20Filtered%20Data%3A%22)%0A%20%20%20%20print(df_filtered%5B'department_group'%5D.value_counts())%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_filtered)%3A%0A%20%20%20%20%23%20How%20many%20filtered%20encounters%20have%20only%201%20event%3F%0A%20%20%20%20filtered_events_per_encounter%20%3D%20df_filtered.groupby('pat_enc_csn_id').size()%0A%0A%20%20%20%20print(%22Events%20per%20encounter%20in%20filtered%20data%3A%22)%0A%20%20%20%20print(f%22Min%3A%20%7Bfiltered_events_per_encounter.min()%7D%22)%0A%20%20%20%20print(f%22Mean%3A%20%7Bfiltered_events_per_encounter.mean()%3A.2f%7D%22)%0A%20%20%20%20print(f%22Median%3A%20%7Bfiltered_events_per_encounter.median()%3A.0f%7D%22)%0A%20%20%20%20print(f%22%5CnEncounters%20with%20only%201%20event%3A%20%7B(filtered_events_per_encounter%20%3D%3D%201).sum()%3A%2C%7D%22)%0A%20%20%20%20print(f%22Percentage%3A%20%7B(filtered_events_per_encounter%20%3D%3D%201).sum()%20%2F%20len(filtered_events_per_encounter)%20*%20100%3A.1f%7D%25%22)%0A%20%20%20%20return%20(filtered_events_per_encounter%2C)%0A%0A%0A%40app.cell%0Adef%20_(df_filtered%2C%20filtered_events_per_encounter)%3A%0A%20%20%20%20%23%20What%20ARE%20these%20single-event%20filtered%20encounters%3F%0A%20%20%20%20single_event_filtered%20%3D%20df_filtered%5Bdf_filtered%5B'pat_enc_csn_id'%5D.isin(%0A%20%20%20%20%20%20%20%20filtered_events_per_encounter%5Bfiltered_events_per_encounter%20%3D%3D%201%5D.index%0A%20%20%20%20)%5D%0A%0A%20%20%20%20print(%22%5CnSingle%20Event%20Encounters%20(after%20filtering)%3A%22)%0A%20%20%20%20print(%22By%20event%20type%3A%22)%0A%20%20%20%20print(single_event_filtered%5B'event_type'%5D.value_counts())%0A%20%20%20%20print(%22%5CnBy%20patient%20class%3A%22)%0A%20%20%20%20print(single_event_filtered%5B'patient_class'%5D.value_counts().head())%0A%20%20%20%20print(%22%5CnBy%20department%20group%3A%22)%0A%20%20%20%20print(single_event_filtered%5B'department_group'%5D.value_counts().head())%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20These%20data%20quality%20checks%20looks%20good%2C%20the%20filter%20worked%20as%20intended.%20Now%20moving%20on%20to%20other%20data%20quality%20checks.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_filtered)%3A%0A%20%20%20%20%23%20Missing%20critical%20fields%0A%20%20%20%20print(%22Missing%20Values%20in%20Key%20Fields%3A%22)%0A%20%20%20%20print(f%22Missing%20effective_time%3A%20%7Bdf_filtered%5B'effective_time'%5D.isna().sum()%3A%2C%7D%22)%0A%20%20%20%20print(f%22Missing%20department_name%3A%20%7Bdf_filtered%5B'department_name'%5D.isna().sum()%3A%2C%7D%22)%0A%20%20%20%20print(f%22Missing%20department_group%3A%20%7Bdf_filtered%5B'department_group'%5D.isna().sum()%3A%2C%7D%22)%0A%20%20%20%20print(f%22Missing%20event_type%3A%20%7Bdf_filtered%5B'event_type'%5D.isna().sum()%3A%2C%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_filtered)%3A%0A%20%20%20%20%23%20Do%20all%20encounters%20have%20a%20discharge%20event%3F%0A%20%20%20%20encounters_with_discharge%20%3D%20df_filtered%5Bdf_filtered%5B'event_type'%5D%20%3D%3D%20'Discharge'%5D%5B'pat_enc_csn_id'%5D.nunique()%0A%20%20%20%20total_filtered_encounters%20%3D%20df_filtered%5B'pat_enc_csn_id'%5D.nunique()%0A%0A%20%20%20%20print(f%22%5CnDischarge%20Events%3A%22)%0A%20%20%20%20print(f%22Total%20encounters%3A%20%7Btotal_filtered_encounters%3A%2C%7D%22)%0A%20%20%20%20print(f%22Encounters%20with%20Discharge%3A%20%7Bencounters_with_discharge%3A%2C%7D%22)%0A%20%20%20%20print(f%22Encounters%20without%20Discharge%3A%20%7Btotal_filtered_encounters%20-%20encounters_with_discharge%3A%2C%7D%22)%0A%20%20%20%20print(f%22Percentage%20missing%20discharge%3A%20%7B(total_filtered_encounters%20-%20encounters_with_discharge)%20%2F%20total_filtered_encounters%20*%20100%3A.1f%7D%25%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_filtered)%3A%0A%20%20%20%20%23%20Calculate%20rough%20LOS%20per%20encounter%0A%20%20%20%20encounter_los%20%3D%20df_filtered.groupby('pat_enc_csn_id')%5B'effective_time'%5D.agg(%5B'min'%2C%20'max'%5D)%0A%20%20%20%20encounter_los%5B'los_days'%5D%20%3D%20(encounter_los%5B'max'%5D%20-%20encounter_los%5B'min'%5D).dt.total_seconds()%20%2F%2086400%0A%0A%20%20%20%20print(f%22%5CnLength%20of%20Stay%20Distribution%3A%22)%0A%20%20%20%20print(encounter_los%5B'los_days'%5D.describe())%0A%20%20%20%20print(f%22Encounters%20with%20LOS%20%3E%20180%20days%3A%20%7B(encounter_los%5B'los_days'%5D%20%3E%20180).sum()%3A%2C%7D%22)%0A%20%20%20%20return%20(encounter_los%2C)%0A%0A%0A%40app.cell%0Adef%20_(df_filtered%2C%20encounter_los)%3A%0A%20%20%20%20%23%20How%20many%20events%20do%20the%20LOS%3D0%20encounters%20have%3F%0A%20%20%20%20zero_los_encs%20%3D%20encounter_los%5Bencounter_los%5B'los_days'%5D%20%3D%3D%200%5D.index%0A%20%20%20%20zero_los_events%20%3D%20df_filtered%5Bdf_filtered%5B'pat_enc_csn_id'%5D.isin(zero_los_encs)%5D%0A%0A%20%20%20%20print(f%22Encounters%20with%20LOS%3D0%3A%20%7Blen(zero_los_encs)%3A%2C%7D%22)%0A%20%20%20%20print(f%22%5CnEvents%20per%20encounter%20for%20LOS%3D0%3A%22)%0A%20%20%20%20print(zero_los_events.groupby('pat_enc_csn_id').size().value_counts().sort_index())%0A%0A%20%20%20%20print(f%22%5CnEvent%20types%20for%20LOS%3D0%3A%22)%0A%20%20%20%20print(zero_los_events%5B'event_type'%5D.value_counts())%0A%0A%20%20%20%20print(f%22%5CnPatient%20class%20for%20LOS%3D0%3A%22)%0A%20%20%20%20print(zero_los_events%5B'patient_class'%5D.value_counts().head(10))%0A%20%20%20%20return%20(zero_los_encs%2C)%0A%0A%0A%40app.cell%0Adef%20_(df%2C%20zero_los_encs)%3A%0A%20%20%20%20%23%20Seeing%20what%20patient%20classes%20were%20in%20these%20encounters%20before%20filtering%0A%20%20%20%20orphan_in_original%20%3D%20df%5Bdf%5B'pat_enc_csn_id'%5D.isin(zero_los_encs)%5D%0A%20%20%20%20print(orphan_in_original.groupby('pat_enc_csn_id').size().describe())%0A%20%20%20%20print(orphan_in_original%5B'patient_class'%5D.value_counts().head(10))%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%201%2C720%20encounters%20(1.1%25%20of%20153%2C878)%20have%20only%20a%20single%20event%20in%20df_filtered%2C%20resulting%20in%20LOS%20%3D%200.%0A%20%20%20%20These%20are%20not%20filtering%20artifacts%20%E2%80%94%20they%20had%20only%20~1%20event%20in%20the%20original%20data%20too%20(mean%201.08).%0A%20%20%20%20They%20are%20incomplete%20records%20(orphan%20discharges%2C%20registration-only%20entries)%20and%20contribute%20no%0A%20%20%20%20transitions.%20Dropping%20them%20to%20keep%20only%20encounters%20with%202%2B%20events.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_filtered)%3A%0A%20%20%20%20%23%20Drop%20single-event%20encounters%0A%20%20%20%20event_counts%20%3D%20df_filtered.groupby('pat_enc_csn_id').size()%0A%20%20%20%20multi_event_encs%20%3D%20event_counts%5Bevent_counts%20%3E%201%5D.index%0A%20%20%20%20df_clean%20%3D%20df_filtered%5Bdf_filtered%5B'pat_enc_csn_id'%5D.isin(multi_event_encs)%5D%0A%20%20%20%20print(f%22Remaining%20encounters%3A%20%7Bdf_clean%5B'pat_enc_csn_id'%5D.nunique()%3A%2C%7D%22)%0A%20%20%20%20print(f%22Remaining%20events%3A%20%7Blen(df_clean)%3A%2C%7D%22)%0A%20%20%20%20return%20(df_clean%2C)%0A%0A%0A%40app.cell%0Adef%20_(df_filtered)%3A%0A%20%20%20%20%23%20Events%20out%20of%20order%3F%0A%20%20%20%20%23%20Check%20if%20seq_num_in_enc%20matches%20chronological%20order%0A%20%20%20%20sample_encounters%20%3D%20df_filtered.groupby('pat_enc_csn_id').filter(lambda%20x%3A%20len(x)%20%3E%201).groupby('pat_enc_csn_id').head(20)%0A%20%20%20%20sample%20%3D%20sample_encounters.groupby('pat_enc_csn_id').apply(%0A%20%20%20%20%20%20%20%20lambda%20x%3A%20(x.sort_values('effective_time')%5B'seq_num_in_enc'%5D.diff()%20%3C%200).any()%0A%20%20%20%20)%0A%20%20%20%20print(f%22%5CnEvent%20Ordering%3A%22)%0A%20%20%20%20print(f%22Encounters%20checked%3A%20%7Blen(sample)%7D%22)%0A%20%20%20%20print(f%22Encounters%20with%20seq_num%20out%20of%20order%3A%20%7Bsample.sum()%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df%2C%20df_filtered)%3A%0A%20%20%20%20%23%20Do%20encounters%20have%20mutliple%20patient%20classes%3F%0A%20%20%20%20encounters_with_multi_classes%20%3D%20df.groupby('pat_enc_csn_id')%5B'patient_class'%5D.nunique()%0A%20%20%20%20print(f%22Encounters%20with%20multiple%20patient%20classes%20(BEFORE%20filter)%3A%20%7B(encounters_with_multi_classes%20%3E%201).sum()%3A%2C%7D%22)%0A%0A%20%20%20%20%23%20After%20filtering%2C%20do%20they%20still%20have%20multiple%3F%0A%20%20%20%20filtered_multi_classes%20%3D%20df_filtered.groupby('pat_enc_csn_id')%5B'patient_class'%5D.nunique()%0A%20%20%20%20print(f%22Encounters%20with%20multiple%20patient%20classes%20(AFTER%20filter)%3A%20%7B(filtered_multi_classes%20%3E%201).sum()%3A%2C%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_filtered)%3A%0A%20%20%20%20%23%20Example%20of%20an%20encounter%20that%20has%20multiple%20patient%20classes%0A%20%20%20%20sample_multi_class%20%3D%20df_filtered.groupby('pat_enc_csn_id').filter(lambda%20x%3A%20x%5B'patient_class'%5D.nunique()%20%3E%201).groupby('pat_enc_csn_id').first().index%5B0%5D%0A%0A%20%20%20%20print(f%22Example%20Encounter%20with%20Multiple%20Classes%3A%20%7Bsample_multi_class%7D%3A%22)%0A%20%20%20%20sample_events%20%3D%20df_filtered%5Bdf_filtered%5B'pat_enc_csn_id'%5D%20%3D%3D%20sample_multi_class%5D%5B%0A%20%20%20%20%20%20%20%20%5B'event_type'%2C%20'effective_time'%2C%20'patient_class'%2C%20'department_name'%2C%20'department_group'%2C%20'seq_num_in_enc'%5D%0A%20%20%20%20%5D.sort_values('effective_time')%0A%0A%20%20%20%20print(f%22%5CnTotal%20events%20in%20this%20encounter%3A%20%7Blen(sample_events)%7D%22)%0A%20%20%20%20print(%22%5Cn%22)%0A%20%20%20%20for%20idx%2C%20row%20in%20sample_events.iterrows()%3A%0A%20%20%20%20%20%20%20%20print(f%22Event%3A%20%7Brow%5B'event_type'%5D%3A15%7D%20%7C%20Time%3A%20%7Brow%5B'effective_time'%5D%7D%20%7C%20Class%3A%20%7Brow%5B'patient_class'%5D%3A30%7D%20%7C%20Dept%3A%20%7Brow%5B'department_name'%5D%3A30%7D%20%7C%20Group%3A%20%7Brow%5B'department_group'%5D%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20Looking%20at%20encounters%20with%20multiple%20patient%20classes%2C%20we%20found%20that%20it's%20completely%20normal%20for%20patient_class%20to%20change%20during%20a%20hospital%20stay.%20For%20example%2C%20a%20patient%20might%20start%20as%20%22Hospital%20Inpatient%20Surgery%22%20in%20a%20perioperative%20area%2C%20then%20get%20updated%20to%20%22Inpatient%20Admission%22%20once%20they%20transfer%20to%20an%20actual%20inpatient%20unit.%20This%20explains%20why%20we%20have%2040%2C731%20encounters%20with%20multiple%20patient%20classes%20after%20filtering.%20The%20556%2C863%20missing%20department_group%20values%20are%20from%20events%20in%20perioperative%20areas%2C%20holding%20areas%2C%20recovery%20rooms%2C%20and%20other%20pre-admission%20locations%20that%20don't%20fit%20into%20the%20ED%2FFloor%2FICU%20tier%20system.%20These%20aren't%20data%20errors%20-%20they're%20just%20areas%20we%20don't%20need%20to%20model.%20For%20the%20transition%20matrix%2C%20we'll%20only%20use%20events%20where%20department_group%20exists%2C%20which%20represents%20when%20patients%20are%20actually%20in%20one%20of%20our%20three%20tiers%20(ED%2C%20Floor%2C%20ICU).%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_filtered)%3A%0A%20%20%20%20%23%20Check%20if%20timestamps%20are%20in%20proper%20chronological%20order%0A%20%20%20%20timestamp_order_issues%20%3D%20df_filtered.groupby('pat_enc_csn_id').apply(%0A%20%20%20%20%20%20%20%20lambda%20x%3A%20(x.sort_values('effective_time')%5B'effective_time'%5D.diff().dt.total_seconds()%20%3C%200).any()%0A%20%20%20%20)%0A%0A%20%20%20%20print(f%22Encounters%20with%20timestamps%20going%20BACKWARDS%3A%20%7Btimestamp_order_issues.sum()%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_filtered)%3A%0A%20%20%20%20%23%20Find%20an%20encounter%20with%20seq_num%20issues%0A%20%20%20%20encounters_multi_events%20%3D%20df_filtered.groupby('pat_enc_csn_id').filter(lambda%20x%3A%20len(x)%20%3E%201)%0A%20%20%20%20seq_check%20%3D%20encounters_multi_events.groupby('pat_enc_csn_id').apply(%0A%20%20%20%20%20%20%20%20lambda%20x%3A%20(x.sort_values('seq_num_in_enc')%5B'effective_time'%5D.diff().dt.total_seconds()%20%3C%200).any()%0A%20%20%20%20)%0A%20%20%20%20problem_encounter%20%3D%20seq_check%5Bseq_check%5D.index%5B0%5D%0A%0A%20%20%20%20print(f%22Encounter%20with%20Sequencing%20Issue%3A%20%7Bproblem_encounter%7D%3A%5Cn%22)%0A%20%20%20%20return%20(problem_encounter%2C)%0A%0A%0A%40app.cell%0Adef%20_(df%2C%20problem_encounter)%3A%0A%20%20%20%20%23%20Before%20filtering%2C%20all%20events%20from%20original%20data%0A%20%20%20%20print(%22Before%20Filtering%20(Original%20Data)%3A%22)%0A%20%20%20%20before_filter%20%3D%20df%5Bdf%5B'pat_enc_csn_id'%5D%20%3D%3D%20problem_encounter%5D%5B%0A%20%20%20%20%20%20%20%20%5B'seq_num_in_enc'%2C%20'effective_time'%2C%20'event_type'%2C%20'patient_class'%2C%20'department_name'%5D%0A%20%20%20%20%5D.sort_values('seq_num_in_enc')%0A%0A%20%20%20%20for%20before_idx%2C%20before_row%20in%20before_filter.iterrows()%3A%0A%20%20%20%20%20%20%20%20print(f%22seq%3D%7Bbefore_row%5B'seq_num_in_enc'%5D%3A.0f%7D%20%7C%20%7Bbefore_row%5B'effective_time'%5D%7D%20%7C%20%7Bbefore_row%5B'event_type'%5D%3A15%7D%20%7C%20%7Bbefore_row%5B'patient_class'%5D%5B%3A30%5D%3A30%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_filtered%2C%20problem_encounter)%3A%0A%20%20%20%20%23%20After%20filtering%2C%20only%20kept%20events%0A%20%20%20%20print(%22%5Cn%5CnAfter%20Filtering%20(Kept%20Events)%3A%22)%0A%20%20%20%20after_filter%20%3D%20df_filtered%5Bdf_filtered%5B'pat_enc_csn_id'%5D%20%3D%3D%20problem_encounter%5D%5B%0A%20%20%20%20%20%20%20%20%5B'seq_num_in_enc'%2C%20'effective_time'%2C%20'event_type'%2C%20'patient_class'%2C%20'department_name'%5D%0A%20%20%20%20%5D.sort_values('seq_num_in_enc')%0A%0A%20%20%20%20for%20after_idx%2C%20after_row%20in%20after_filter.iterrows()%3A%0A%20%20%20%20%20%20%20%20print(f%22seq%3D%7Bafter_row%5B'seq_num_in_enc'%5D%3A.0f%7D%20%7C%20%7Bafter_row%5B'effective_time'%5D%7D%20%7C%20%7Bafter_row%5B'event_type'%5D%3A15%7D%20%7C%20%7Bafter_row%5B'patient_class'%5D%5B%3A30%5D%3A30%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_filtered%2C%20pd)%3A%0A%20%20%20%20%23%20How%20widespread%20is%20Nan%20problem%20in%20sequencing%3F%0A%20%20%20%20nan_seq%20%3D%20df_filtered%5Bdf_filtered%5B'seq_num_in_enc'%5D.isna()%5D%0A%20%20%20%20print(f%22Total%20events%20with%20NaN%20seq_num%3A%20%7Blen(nan_seq)%3A%2C%7D%22)%0A%20%20%20%20print(f%22Total%20encounters%20with%20at%20least%20one%20NaN%20seq%3A%20%7Bnan_seq%5B'pat_enc_csn_id'%5D.nunique()%3A%2C%7D%22)%0A%20%20%20%20print(f%22Out%20of%20total%20encounters%3A%20%7Bdf_filtered%5B'pat_enc_csn_id'%5D.nunique()%3A%2C%7D%22)%0A%20%20%20%20print(f%22Percentage%20of%20encounters%20affected%3A%20%7Bnan_seq%5B'pat_enc_csn_id'%5D.nunique()%20%2F%20df_filtered%5B'pat_enc_csn_id'%5D.nunique()%20*%20100%3A.1f%7D%25%22)%0A%0A%20%20%20%20print(%22%5Cn---%20Event%20type%20breakdown%20for%20NaN%20seq%20events%20---%22)%0A%20%20%20%20print(nan_seq%5B'event_type'%5D.value_counts())%0A%0A%20%20%20%20print(%22%5Cn---%20Patient%20class%20breakdown%20for%20NaN%20seq%20events%20---%22)%0A%20%20%20%20print(nan_seq%5B'patient_class'%5D.value_counts().head(10))%0A%0A%20%20%20%20print(%22%5Cn---%20Department%20group%20breakdown%20for%20NaN%20seq%20events%20---%22)%0A%20%20%20%20print(nan_seq%5B'department_group'%5D.value_counts().head(10))%0A%0A%20%20%20%20%23%20Looking%20at%205%20example%20encounters%0A%20%20%20%20nan_encs%20%3D%20nan_seq%5B'pat_enc_csn_id'%5D.unique()%5B%3A5%5D%0A%0A%20%20%20%20for%20enc%20in%20nan_encs%3A%0A%20%20%20%20%20%20%20%20enc_data%20%3D%20df_filtered%5Bdf_filtered%5B'pat_enc_csn_id'%5D%20%3D%3D%20enc%5D.sort_values('effective_time')%0A%20%20%20%20%20%20%20%20print(f%22%5Cn%7B'%3D'*80%7D%22)%0A%20%20%20%20%20%20%20%20print(f%22Encounter%3A%20%7Benc%7D%20(%7Blen(enc_data)%7D%20events)%22)%0A%20%20%20%20%20%20%20%20print(f%22%7B'%3D'*80%7D%22)%0A%20%20%20%20%20%20%20%20for%20_%2C%20r%20in%20enc_data.iterrows()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20seq%20%3D%20r%5B'seq_num_in_enc'%5D%0A%20%20%20%20%20%20%20%20%20%20%20%20seq_str%20%3D%20f%22seq%3D%7Bint(seq)%7D%22%20if%20pd.notna(seq)%20else%20%22seq%3DNaN%22%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%7Bseq_str%3A%3E10%7D%20%7C%20%7Br%5B'effective_time'%5D%7D%20%7C%20%7Bstr(r%5B'event_type'%5D)%3A20s%7D%20%7C%20%7Bstr(r%5B'patient_class'%5D)%3A30s%7D%20%7C%20%7Bstr(r%5B'department_group'%5D)%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20The%20seq_num_in_enc%20field%20is%20scoped%20to%20the%20Inpatient%20Admission%20patient%20class%2C%20not%20the%20full%20encounter.%0A%20%20%20%20When%20a%20patient%20starts%20in%20the%20ED%20and%20converts%20to%20inpatient%2C%20the%20initial%20ED%20Admission%20event%20receives%20no%0A%20%20%20%20sequence%20number%20(NaN).%20This%20is%20systematic%2C%20not%20a%20data%20quality%20issue.%20Since%20all%20NaN%20cases%20follow%20this%0A%20%20%20%20pattern%20and%20timestamps%20are%20in%20correct%20chronological%20order%2C%20we%20will%20use%20effective_time%20to%20order%20events%0A%20%20%20%20and%20extract%20transitions%20%E2%80%94%20no%20resequencing%20needed.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_clean)%3A%0A%20%20%20%20%23%20Where%20is%20ED%20hiding%3F%0A%20%20%20%20ed_events%20%3D%20df_clean%5Bdf_clean%5B'patient_class'%5D.str.contains('Emergency'%2C%20na%3DFalse)%5D%0A%20%20%20%20print(f%22ED%20events%3A%20%7Blen(ed_events)%3A%2C%7D%22)%0A%20%20%20%20print(f%22%5CnED%20department_group%20values%3A%22)%0A%20%20%20%20print(ed_events%5B'department_group'%5D.value_counts(dropna%3DFalse))%0A%0A%20%20%20%20print(f%22%5CnED%20department_name%20samples%3A%22)%0A%20%20%20%20print(ed_events%5B'department_name'%5D.value_counts().head(10))%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20ED%20events%20(306%2C495)%20have%20NaN%20for%20department_group%20in%20the%20source%20data%20%E2%80%94%20the%20field%20was%20never%20populated%0A%20%20%20%20for%20emergency%20departments.%20This%20accounts%20for%20the%20majority%20of%20the%20~556K%20missing%20department_group%20values%0A%20%20%20%20identified%20earlier.%20ED%20events%20are%20still%20present%20in%20df_clean%20and%20can%20be%20identified%20via%20patient_class%0A%20%20%20%20(%22Emergency%20Department%20-%20Encounter%22)%20or%20department_name%20prefix%20(LJ%2FHC%2FEC%20EMERGENCY%20DEPT).%20We%20will%0A%20%20%20%20fill%20in%20%22ED%22%20as%20the%20department_group%20for%20these%20events%20before%20building%20the%20transition%20matrix.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Tier%20Mapping%0A%0A%20%20%20%20Our%20simulation%20models%20patient%20flow%20between%209%20states%3A%203%20care%20tiers%20(ED%2C%20ICU%2C%20Floor)%20%C3%97%203%20campuses%0A%20%20%20%20(La%20Jolla%2C%20Hillcrest%2C%20East%20Campus)%2C%20plus%20discharge%20home.%20The%20raw%20data%20has%20~10%20granular%20department%0A%20%20%20%20groups%20(MedSurg%2C%20PCU%2C%20IMU%2C%20OB%2C%20etc.)%20that%20need%20to%20be%20collapsed%20into%20these%203%20tiers.%20Mapping%3A%20ED%0A%20%20%20%20events%20(identified%20via%20patient_class%2Fdepartment_name%20since%20department_group%20is%20NaN%20for%20ED)%2C%20ICU%20stays%0A%20%20%20%20as%20ICU%2C%20and%20everything%20else%20(MedSurg%2C%20OB%2C%20PCU%2C%20IMU%2C%20MedSTele%2C%20Behavioral%20Health%2C%20Nursery%2C%20NICU)%20as%0A%20%20%20%20Floor.%20Events%20with%20no%20tier%20(perioperative%2Fholding)%20will%20be%20skipped%20in%20transition%20extraction%20so%0A%20%20%20%20transitions%20connect%20around%20them%20(e.g.%2C%20ED%20%E2%86%92%20periop%20%E2%86%92%20Floor%20becomes%20ED%20%E2%86%92%20Floor).%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_clean%2C%20pd)%3A%0A%20%20%20%20%23%20Create%20tier%20mapping%0A%20%20%20%20def%20assign_tier(row)%3A%0A%20%20%20%20%20%20%20%20if%20row%5B'patient_class'%5D%20%3D%3D%20'Emergency%20Department%20-%20Encounter'%20or%20%5C%0A%20%20%20%20%20%20%20%20%20%20%20(pd.isna(row%5B'department_group'%5D)%20and%20'EMERGENCY'%20in%20str(row%5B'department_name'%5D))%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20'ED'%0A%20%20%20%20%20%20%20%20elif%20row%5B'department_group'%5D%20%3D%3D%20'ICU'%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20'ICU'%0A%20%20%20%20%20%20%20%20elif%20pd.notna(row%5B'department_group'%5D)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20'Floor'%0A%20%20%20%20%20%20%20%20else%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%20None%20%20%23%20perioperative%2Fholding%20-%20no%20tier%0A%0A%20%20%20%20df_clean_tier%20%3D%20df_clean.copy()%0A%20%20%20%20df_clean_tier%5B'tier'%5D%20%3D%20df_clean_tier.apply(assign_tier%2C%20axis%3D1)%0A%0A%20%20%20%20print(%22Tier%20counts%3A%22)%0A%20%20%20%20print(df_clean_tier%5B'tier'%5D.value_counts(dropna%3DFalse))%0A%0A%20%20%20%20print(%22%5CnTier%20x%20Location%3A%22)%0A%20%20%20%20print(pd.crosstab(df_clean_tier%5B'tier'%5D%2C%20df_clean_tier%5B'location'%5D))%0A%20%20%20%20return%20(df_clean_tier%2C)%0A%0A%0A%40app.cell%0Adef%20_(df_clean_tier)%3A%0A%20%20%20%20%23%20Check%20None%20tier%20events%0A%20%20%20%20no_tier%20%3D%20df_clean_tier%5Bdf_clean_tier%5B'tier'%5D.isna()%5D%0A%20%20%20%20print(f%22Events%20with%20no%20tier%3A%20%7Blen(no_tier)%3A%2C%7D%22)%0A%20%20%20%20print(f%22Encounters%20affected%3A%20%7Bno_tier%5B'pat_enc_csn_id'%5D.nunique()%3A%2C%7D%22)%0A%20%20%20%20print(f%22%5Cndepartment_name%20for%20no-tier%20events%3A%22)%0A%20%20%20%20for%20dept%2C%20cnt%20in%20no_tier%5B'department_name'%5D.value_counts().items()%3A%0A%20%20%20%20%20%20%20%20print(f%22%20%20%7Bdept%7D%3A%20%7Bcnt%3A%2C%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_clean_tier%2C%20pd)%3A%0A%20%20%20%20%23%20Create%20state%20column%3A%20tier%20%2B%20location%0A%20%20%20%20df_clean_tier%5B'state'%5D%20%3D%20df_clean_tier%5B'tier'%5D%20%2B%20'_'%20%2B%20df_clean_tier%5B'location'%5D%0A%0A%20%20%20%20%23%20Sort%20by%20encounter%20and%20time%2C%20drop%20no-tier%20events%0A%20%20%20%20df_sorted%20%3D%20df_clean_tier%5Bdf_clean_tier%5B'tier'%5D.notna()%5D.sort_values(%5B'pat_enc_csn_id'%2C%20'effective_time'%5D)%0A%0A%20%20%20%20%23%20Extract%20transition%20pairs%0A%20%20%20%20transition_pairs%20%3D%20%5B%5D%0A%20%20%20%20for%20enc_id%2C%20group%20in%20df_sorted.groupby('pat_enc_csn_id')%3A%0A%20%20%20%20%20%20%20%20states%20%3D%20group%5B'state'%5D.values%0A%20%20%20%20%20%20%20%20%23%20Remove%20consecutive%20duplicates%0A%20%20%20%20%20%20%20%20path%20%3D%20%5Bstates%5B0%5D%5D%0A%20%20%20%20%20%20%20%20for%20st%20in%20states%5B1%3A%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20st%20!%3D%20path%5B-1%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20path.append(st)%0A%20%20%20%20%20%20%20%20%23%20Add%20discharge%20as%20final%20state%0A%20%20%20%20%20%20%20%20path.append('Discharge')%0A%20%20%20%20%20%20%20%20%23%20Collect%20pairs%0A%20%20%20%20%20%20%20%20for%20i%20in%20range(len(path)%20-%201)%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20transition_pairs.append((path%5Bi%5D%2C%20path%5Bi%2B1%5D))%0A%0A%20%20%20%20transitions_df%20%3D%20pd.DataFrame(transition_pairs%2C%20columns%3D%5B'from_state'%2C%20'to_state'%5D)%0A%20%20%20%20print(f%22Total%20transitions%3A%20%7Blen(transitions_df)%3A%2C%7D%22)%0A%20%20%20%20print(f%22%5CnTransition%20counts%3A%22)%0A%20%20%20%20for%20pair%2C%20n_trans%20in%20transitions_df.value_counts().head(20).items()%3A%0A%20%20%20%20%20%20%20%20print(f%22%20%20%7Bpair%5B0%5D%7D%20-%3E%20%7Bpair%5B1%5D%7D%3A%20%7Bn_trans%3A%2C%7D%22)%0A%20%20%20%20return%20(transitions_df%2C)%0A%0A%0A%40app.cell%0Adef%20_(pd%2C%20transitions_df)%3A%0A%20%20%20%20%23%20Define%20states%0A%20%20%20%20from_states%20%3D%20%5B%0A%20%20%20%20%20%20%20%20'ED_La%20Jolla'%2C%20'ED_Hillcrest'%2C%20'ED_East%20Campus'%2C%0A%20%20%20%20%20%20%20%20'Floor_La%20Jolla'%2C%20'Floor_Hillcrest'%2C%20'Floor_East%20Campus'%2C%0A%20%20%20%20%20%20%20%20'ICU_La%20Jolla'%2C%20'ICU_Hillcrest'%2C%20'ICU_East%20Campus'%0A%20%20%20%20%5D%0A%20%20%20%20to_states%20%3D%20from_states%20%2B%20%5B'Discharge'%5D%0A%0A%20%20%20%20%23%20Build%20count%20matrix%0A%20%20%20%20count_matrix%20%3D%20pd.DataFrame(0%2C%20index%3Dfrom_states%2C%20columns%3Dto_states)%0A%20%20%20%20for%20(f%2C%20t)%2C%20num%20in%20transitions_df.value_counts().items()%3A%0A%20%20%20%20%20%20%20%20if%20f%20in%20from_states%20and%20t%20in%20to_states%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20count_matrix.loc%5Bf%2C%20t%5D%20%3D%20num%0A%0A%20%20%20%20print(%22Count%20Matrix%3A%22)%0A%20%20%20%20print(count_matrix)%0A%0A%20%20%20%20%23%20Convert%20to%20probabilities%20(each%20row%20sums%20to%201)%0A%20%20%20%20prob_matrix%20%3D%20count_matrix.div(count_matrix.sum(axis%3D1)%2C%20axis%3D0)%0A%20%20%20%20print(%22%5CnProbability%20Matrix%3A%22)%0A%20%20%20%20print(prob_matrix.round(4))%0A%0A%20%20%20%20%23%20Verify%20rows%20sum%20to%201%0A%20%20%20%20print(f%22%5CnRow%20sums%3A%20%7Bprob_matrix.sum(axis%3D1).values%7D%22)%0A%20%20%20%20return%20(prob_matrix%2C)%0A%0A%0A%40app.cell%0Adef%20_(df_clean_tier)%3A%0A%20%20%20%20%23%20Build%20state%20blocks%20with%20duration%0A%20%20%20%20df_states%20%3D%20df_clean_tier%5Bdf_clean_tier%5B'tier'%5D.notna()%5D.copy()%0A%20%20%20%20df_states%5B'state'%5D%20%3D%20(df_states%5B'tier'%5D%20%2B%20'_'%20%2B%20df_states%5B'location'%5D).str.upper().str.replace('%20'%2C%20'_')%0A%20%20%20%20df_states%20%3D%20df_states.sort_values(%5B'pat_enc_csn_id'%2C%20'effective_time'%5D)%0A%0A%20%20%20%20%23%20Detect%20state%20changes%20and%20assign%20block%20IDs%0A%20%20%20%20df_states%5B'prev_state'%5D%20%3D%20df_states.groupby('pat_enc_csn_id')%5B'state'%5D.shift()%0A%20%20%20%20df_states%5B'is_new'%5D%20%3D%20(df_states%5B'state'%5D%20!%3D%20df_states%5B'prev_state'%5D).astype(int)%0A%20%20%20%20df_states%5B'block'%5D%20%3D%20df_states.groupby('pat_enc_csn_id')%5B'is_new'%5D.cumsum()%0A%0A%20%20%20%20%23%20Collapse%20to%20one%20row%20per%20block%20with%20time_in%2C%20time_out%2C%20duration%0A%20%20%20%20state_blocks%20%3D%20(%0A%20%20%20%20%20%20%20%20df_states.groupby(%5B'pat_enc_csn_id'%2C%20'block'%2C%20'state'%5D)%0A%20%20%20%20%20%20%20%20.agg(time_in%3D('effective_time'%2C%20'min')%2C%20time_out%3D('effective_time'%2C%20'max'))%0A%20%20%20%20%20%20%20%20.reset_index()%0A%20%20%20%20%20%20%20%20.sort_values(%5B'pat_enc_csn_id'%2C%20'block'%5D)%0A%20%20%20%20)%0A%20%20%20%20state_blocks%5B'duration_hours'%5D%20%3D%20(state_blocks%5B'time_out'%5D%20-%20state_blocks%5B'time_in'%5D).dt.total_seconds()%20%2F%203600%0A%0A%20%20%20%20%23%20Build%20trajectory%20library%0A%20%20%20%20trajectory_library%20%3D%20(%0A%20%20%20%20%20%20%20%20state_blocks%0A%20%20%20%20%20%20%20%20.sort_values(%5B'pat_enc_csn_id'%2C%20'block'%5D)%0A%20%20%20%20%20%20%20%20.groupby('pat_enc_csn_id')%0A%20%20%20%20%20%20%20%20.apply(lambda%20g%3A%20list(zip(g%5B'state'%5D%2C%20g%5B'duration_hours'%5D)))%0A%20%20%20%20%20%20%20%20.to_dict()%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20Preview%20a%20few%0A%20%20%20%20%23%20for%20eid%2C%20traj%20in%20list(trajectory_library.items())%5B%3A5%5D%3A%0A%20%20%20%20%23%20%20%20%20%20traj_str%20%3D%20'%20%E2%86%92%20'.join(%5Bf%22%7Bstate%7D%20(%7Bdur%3A.1f%7Dh)%22%20for%20state%2C%20dur%20in%20traj%5D)%0A%20%20%20%20%23%20%20%20%20%20print(f%22%7Beid%7D%3A%20%7Btraj_str%7D%22)%0A%0A%20%20%20%20print(f%22%5CnTotal%20trajectories%3A%20%7Blen(trajectory_library)%3A%2C%7D%22)%0A%20%20%20%20return%20state_blocks%2C%20trajectory_library%0A%0A%0A%40app.cell%0Adef%20_(state_blocks)%3A%0A%20%20%20%20%23%20Get%20durations%20per%20state%20from%20state_blocks%0A%20%20%20%20for%20state_name%2C%20grp%20in%20state_blocks.groupby('state')%3A%0A%20%20%20%20%20%20%20%20durations%20%3D%20grp%5B'duration_hours'%5D%0A%20%20%20%20%20%20%20%20print(f%22%7Bstate_name%7D%3A%20n%3D%7Blen(grp)%3A%2C%7D%2C%20mean%3D%7Bdurations.mean()%3A.1f%7Dh%2C%20median%3D%7Bdurations.median()%3A.1f%7Dh%2C%20std%3D%7Bdurations.std()%3A.1f%7Dh%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(np%2C%20state_blocks%2C%20stats)%3A%0A%20%20%20%20distributions%20%3D%20%7B%0A%20%20%20%20%20%20%20%20'lognorm'%3A%20stats.lognorm%2C%0A%20%20%20%20%20%20%20%20'gamma'%3A%20stats.gamma%2C%0A%20%20%20%20%20%20%20%20'expon'%3A%20stats.expon%2C%0A%20%20%20%20%20%20%20%20'weibull_min'%3A%20stats.weibull_min%0A%20%20%20%20%7D%0A%0A%20%20%20%20fit_results%20%3D%20%7B%7D%0A%20%20%20%20for%20sname%2C%20sgrp%20in%20state_blocks.groupby('state')%3A%0A%20%20%20%20%20%20%20%20dur_hrs%20%3D%20sgrp%5B'duration_hours'%5D.dropna()%0A%20%20%20%20%20%20%20%20dur_hrs%20%3D%20dur_hrs%5Bdur_hrs%20%3E%200%5D%0A%0A%20%20%20%20%20%20%20%20print(f%22%5Cn%7B'%3D'*60%7D%22)%0A%20%20%20%20%20%20%20%20print(f%22Fitting%3A%20%7Bsname%7D%20(n%3D%7Blen(dur_hrs)%3A%2C%7D)%22)%0A%20%20%20%20%20%20%20%20print(f%22%7B'%3D'*60%7D%22)%0A%0A%20%20%20%20%20%20%20%20best_name%20%3D%20None%0A%20%20%20%20%20%20%20%20best_sse%20%3D%20float('inf')%0A%20%20%20%20%20%20%20%20best_params%20%3D%20None%0A%0A%20%20%20%20%20%20%20%20for%20dist_name%2C%20dist%20in%20distributions.items()%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20params%20%3D%20dist.fit(dur_hrs)%0A%20%20%20%20%20%20%20%20%20%20%20%20pdf_values%20%3D%20dist.pdf(sorted(dur_hrs)%2C%20*params)%0A%20%20%20%20%20%20%20%20%20%20%20%20sse%20%3D%20np.sum((np.histogram(dur_hrs%2C%20bins%3D50%2C%20density%3DTrue)%5B0%5D%20-%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20dist.pdf(np.histogram(dur_hrs%2C%20bins%3D50)%5B1%5D%5B%3A-1%5D%20%2B%20%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20np.diff(np.histogram(dur_hrs%2C%20bins%3D50)%5B1%5D)%2F2%2C%20*params))**2)%0A%20%20%20%20%20%20%20%20%20%20%20%20print(f%22%20%20%7Bdist_name%7D%3A%20SSE%3D%7Bsse%3A.6f%7D%2C%20params%3D%7Btuple(round(p%2C4)%20for%20p%20in%20params)%7D%22)%0A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20sse%20%3C%20best_sse%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20best_sse%20%3D%20sse%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20best_name%20%3D%20dist_name%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20best_params%20%3D%20params%0A%0A%20%20%20%20%20%20%20%20fit_results%5Bsname%5D%20%3D%20%7B'dist'%3A%20best_name%2C%20'params'%3A%20best_params%2C%20'sse'%3A%20best_sse%7D%0A%20%20%20%20%20%20%20%20print(f%22%20%20%E2%86%92%20Best%3A%20%7Bbest_name%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_clean_tier)%3A%0A%20%20%20%20boarded%20%3D%20df_clean_tier%5B%0A%20%20%20%20%20%20%20%20(df_clean_tier%5B'department_name'%5D.str.contains('EMERGENCY'%2C%20na%3DFalse))%20%26%20%0A%20%20%20%20%20%20%20%20(df_clean_tier%5B'patient_class'%5D%20!%3D%20'Emergency%20Department%20-%20Encounter')%0A%20%20%20%20%5D%0A%20%20%20%20print(f%22Potential%20boarded%20events%3A%20%7Blen(boarded)%3A%2C%7D%22)%0A%20%20%20%20print(f%22%5CnTier%20breakdown%3A%22)%0A%20%20%20%20for%20tier_val%2C%20n%20in%20boarded%5B'tier'%5D.value_counts(dropna%3DFalse).items()%3A%0A%20%20%20%20%20%20%20%20print(f%22%20%20%7Btier_val%7D%3A%20%7Bn%3A%2C%7D%22)%0A%20%20%20%20return%20(boarded%2C)%0A%0A%0A%40app.cell%0Adef%20_(boarded%2C%20state_blocks)%3A%0A%20%20%20%20%23%20Compare%20ED%20durations%3A%20true%20ED%20patients%20vs%20boarded%0A%20%20%20%20ed_blocks%20%3D%20state_blocks%5Bstate_blocks%5B'state'%5D.str.startswith('ED_')%5D%0A%0A%20%20%20%20%23%20Tag%20which%20encounters%20have%20boarded%20events%0A%20%20%20%20boarded_encs%20%3D%20boarded%5B'pat_enc_csn_id'%5D.unique()%0A%20%20%20%20ed_blocks_tagged%20%3D%20ed_blocks.copy()%0A%20%20%20%20ed_blocks_tagged%5B'is_boarded'%5D%20%3D%20ed_blocks_tagged%5B'pat_enc_csn_id'%5D.isin(boarded_encs)%0A%0A%20%20%20%20print(%22ED%20durations%20for%20encounters%20WITH%20boarding%3A%22)%0A%20%20%20%20print(ed_blocks_tagged%5Bed_blocks_tagged%5B'is_boarded'%5D%5D%5B'duration_hours'%5D.describe())%0A%0A%20%20%20%20print(%22%5CnED%20durations%20for%20encounters%20WITHOUT%20boarding%3A%22)%0A%20%20%20%20print(ed_blocks_tagged%5B~ed_blocks_tagged%5B'is_boarded'%5D%5D%5B'duration_hours'%5D.describe())%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Boarded%20Patients%20(Known%20Limitation)%0A%0A%20%20%20%20148%2C234%20ED%20events%20(~33%25%20of%20all%20ED%20events)%20are%20boarded%20patients%20%E2%80%94%20physically%20in%20the%20ED%20but%20already%0A%20%20%20%20admitted%20as%20inpatients.%20These%20inflate%20ED%20duration%20distributions%20significantly%3A%20median%2014.7h%20with%0A%20%20%20%20boarding%20vs%203.3h%20without.%20For%20v1%20of%20the%20simulation%2C%20boarded%20time%20is%20counted%20as%20ED%20occupancy.%20Future%0A%20%20%20%20iterations%20could%20split%20these%20encounters%20at%20the%20patient_class%20change%20point%20to%20separate%20true%20ED%20time%0A%20%20%20%20from%20boarding%20time.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%23%20Arrival%20Rates%3A%20Weekday%20vs%20Weekend%0A%0A%20%20%20%20The%20simulation%20needs%20to%20know%20how%20many%20patients%20enter%20the%20system%20per%20day%20at%20each%20campus.%20Patient%20arrival%0A%20%20%20%20patterns%20differ%20between%20weekdays%20and%20weekends%20(e.g.%2C%20fewer%20elective%20admissions%20on%20weekends%2C%20different%20ED%0A%20%20%20%20volumes).%20We%20calculate%20mean%20daily%20arrivals%20by%20campus%20(La%20Jolla%2C%20Hillcrest%2C%20East%20Campus)%20split%20by%0A%20%20%20%20weekday%20vs%20weekend.%20These%20rates%20will%20drive%20patient%20generation%20in%20the%20simulation%20%E2%80%94%20each%20simulated%20day%0A%20%20%20%20samples%20from%20the%20appropriate%20arrival%20distribution%20to%20determine%20how%20many%20new%20patients%20enter%20each%20campus.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(df_clean_tier)%3A%0A%20%20%20%20%23%20Get%20first%20event%20per%20encounter%20(arrival)%20with%20tier%0A%20%20%20%20arrivals%20%3D%20df_clean_tier%5Bdf_clean_tier%5B'tier'%5D.notna()%5D.sort_values('effective_time').groupby('pat_enc_csn_id').first().reset_index()%0A%20%20%20%20arrivals%5B'day_of_week'%5D%20%3D%20arrivals%5B'effective_time'%5D.dt.dayofweek%0A%20%20%20%20arrivals%5B'is_weekend'%5D%20%3D%20arrivals%5B'day_of_week'%5D.isin(%5B5%2C%206%5D)%0A%20%20%20%20arrivals%5B'date'%5D%20%3D%20arrivals%5B'effective_time'%5D.dt.date%0A%0A%20%20%20%20%23%20Daily%20arrival%20counts%20by%20campus%20and%20weekday%2Fweekend%0A%20%20%20%20daily%20%3D%20arrivals.groupby(%5B'location'%2C%20'is_weekend'%2C%20'date'%5D).size().reset_index(name%3D'daily_arrivals')%0A%0A%20%20%20%20print(%22Mean%20daily%20arrivals%20by%20campus%20and%20day%20type%3A%22)%0A%20%20%20%20for%20(loc%2C%20wknd)%2C%20sub%20in%20daily.groupby(%5B'location'%2C%20'is_weekend'%5D)%3A%0A%20%20%20%20%20%20%20%20day_type%20%3D%20'Weekend'%20if%20wknd%20else%20'Weekday'%0A%20%20%20%20%20%20%20%20print(f%22%20%20%7Bloc%7D%20(%7Bday_type%7D)%3A%20mean%3D%7Bsub%5B'daily_arrivals'%5D.mean()%3A.1f%7D%2C%20std%3D%7Bsub%5B'daily_arrivals'%5D.std()%3A.1f%7D%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20UCSD%20Health%20DES%20%E2%80%94%20EDA%20%26%20Data%20Preparation%20Summary%0A%0A%20%20%20%20%23%23%20Data%20Cleaning%20Pipeline%0A%0A%20%20%20%20**Starting%20point%3A**%202.1M%20ADT%20events%20across%20985K%20patient%20encounters%20(2025).%0A%0A%20%20%20%20**Step%201%20%E2%80%94%20Filter%20to%20bed-occupying%20patients%3A**%20Removed%20non-bed-occupying%20patient%20classes%20(outpatient%20radiology%2C%20infusion%2C%20therapy%2C%20etc.)%2C%20reducing%20to%201.15M%20rows%20across%20153%2C878%20encounters.%0A%0A%20%20%20%20**Step%202%20%E2%80%94%20Drop%20single-event%20encounters%3A**%201%2C720%20encounters%20(1.1%25)%20had%20only%20a%20single%20event%2C%20producing%20no%20usable%20transitions.%20These%20were%20incomplete%20records%20in%20the%20source%20system%20(orphan%20discharges%2C%20registration-only%20entries)%2C%20not%20artifacts%20of%20our%20filtering.%20Dropped%20to%20yield%20152%2C158%20encounters%20%2F%201%2C151%2C386%20events.%0A%0A%20%20%20%20**Step%203%20%E2%80%94%20Tier%20mapping%3A**%20Collapsed%20~10%20granular%20department%20groups%20into%203%20care%20tiers%20for%20the%20simulation's%209-state%20model%20(3%20tiers%20%C3%97%203%20campuses).%20ED%20events%20had%20NaN%20for%20%60department_group%60%20in%20the%20source%20data%20(never%20populated%20for%20emergency%20departments)%20and%20were%20identified%20via%20%60patient_class%60%20and%20%60department_name%60.%20Mapping%3A%20ED%20%E2%86%92%20ED%2C%20ICU%20%E2%86%92%20ICU%2C%20everything%20else%20(MedSurg%2C%20OB%2C%20PCU%2C%20IMU%2C%20MedSTele%2C%20Behavioral%20Health%2C%20Nursery%2C%20NICU)%20%E2%86%92%20Floor.%20100%2C633%20events%20with%20no%20tier%20(perioperative%2Fholding%20areas)%20are%20skipped%20in%20transition%20extraction%20so%20transitions%20connect%20around%20them%20(e.g.%2C%20ED%20%E2%86%92%20periop%20%E2%86%92%20Floor%20becomes%20ED%20%E2%86%92%20Floor).%0A%0A%20%20%20%20**Step%204%20%E2%80%94%20Timestamp-based%20ordering%3A**%20The%20%60seq_num_in_enc%60%20field%20is%20scoped%20to%20the%20Inpatient%20Admission%20patient%20class%2C%20not%20the%20full%20encounter.%20ED%20Admission%20events%20receive%20NaN%20sequence%20numbers.%20Since%20timestamps%20are%20in%20correct%20chronological%20order%2C%20all%20event%20ordering%20uses%20%60effective_time%60%20%E2%80%94%20no%20resequencing%20needed.%0A%0A%20%20%20%20---%0A%0A%20%20%20%20%23%23%201.%20Transition%20Matrix%20(9%C3%9710)%0A%0A%20%20%20%20Transition%20probabilities%20between%209%20states%20(ED%2FFloor%2FICU%20%C3%97%20La%20Jolla%2FHillcrest%2FEast%20Campus)%20plus%20Discharge.%20Built%20by%20sorting%20each%20encounter%20by%20%60effective_time%60%2C%20extracting%20the%20sequence%20of%20states%20(dropping%20NaN-tier%20events%20and%20consecutive%20duplicates)%2C%20and%20counting%20state-to-state%20transitions.%20185%2C866%20total%20transitions%20extracted.%0A%0A%20%20%20%20%7C%20%20%7C%20ED_LJ%20%7C%20ED_HC%20%7C%20ED_EC%20%7C%20Fl_LJ%20%7C%20Fl_HC%20%7C%20Fl_EC%20%7C%20ICU_LJ%20%7C%20ICU_HC%20%7C%20ICU_EC%20%7C%20Disch%20%7C%0A%20%20%20%20%7C---%7C---%7C---%7C---%7C---%7C---%7C---%7C---%7C---%7C---%7C---%7C%0A%20%20%20%20%7C%20**ED_LJ**%20%7C%200.000%20%7C%200.001%20%7C%200.000%20%7C%200.163%20%7C%200.008%20%7C%200.015%20%7C%200.027%20%7C%200.001%20%7C%200.001%20%7C%200.785%20%7C%0A%20%20%20%20%7C%20**ED_HC**%20%7C%200.001%20%7C%200.000%20%7C%200.000%20%7C%200.001%20%7C%200.173%20%7C%200.023%20%7C%200.001%20%7C%200.028%20%7C%200.001%20%7C%200.774%20%7C%0A%20%20%20%20%7C%20**ED_EC**%20%7C%200.002%20%7C%200.006%20%7C%200.000%20%7C%200.000%20%7C%200.005%20%7C%200.112%20%7C%200.000%20%7C%200.001%20%7C%200.019%20%7C%200.854%20%7C%0A%20%20%20%20%7C%20**Fl_LJ**%20%7C%200.001%20%7C%200.000%20%7C%200.000%20%7C%200.000%20%7C%200.002%20%7C%200.001%20%7C%200.042%20%7C%200.000%20%7C%200.000%20%7C%200.955%20%7C%0A%20%20%20%20%7C%20**Fl_HC**%20%7C%200.000%20%7C%200.001%20%7C%200.000%20%7C%200.010%20%7C%200.000%20%7C%200.002%20%7C%200.002%20%7C%200.037%20%7C%200.000%20%7C%200.949%20%7C%0A%20%20%20%20%7C%20**Fl_EC**%20%7C%200.000%20%7C%200.000%20%7C%200.000%20%7C%200.004%20%7C%200.011%20%7C%200.000%20%7C%200.000%20%7C%200.000%20%7C%200.027%20%7C%200.957%20%7C%0A%20%20%20%20%7C%20**ICU_LJ**%20%7C%200.000%20%7C%200.000%20%7C%200.000%20%7C%200.559%20%7C%200.001%20%7C%200.000%20%7C%200.000%20%7C%200.001%20%7C%200.001%20%7C%200.438%20%7C%0A%20%20%20%20%7C%20**ICU_HC**%20%7C%200.000%20%7C%200.001%20%7C%200.000%20%7C%200.003%20%7C%200.743%20%7C%200.000%20%7C%200.017%20%7C%200.000%20%7C%200.005%20%7C%200.230%20%7C%0A%20%20%20%20%7C%20**ICU_EC**%20%7C%200.000%20%7C%200.000%20%7C%200.002%20%7C%200.006%20%7C%200.005%20%7C%200.648%20%7C%200.032%20%7C%200.018%20%7C%200.000%20%7C%200.289%20%7C%0A%0A%20%20%20%20**Key%20patterns%3A**%20ED%20%E2%86%92%20Discharge%20is%20dominant%20(77%E2%80%9385%25)%2C%20reflecting%20most%20ED%20patients%20going%20home.%20Floor%20%E2%86%92%20Discharge%20(95%E2%80%9396%25)%20shows%20most%20floor%20patients%20discharge%20directly.%20ICU%20%E2%86%92%20Floor%20same%20campus%20(56%E2%80%9374%25)%20is%20the%20primary%20step-down%20pathway.%20Cross-campus%20transfers%20exist%20but%20are%20rare.%0A%0A%20%20%20%20---%0A%0A%20%20%20%20%23%23%202.%20Duration%20Distributions%20(Lognormal%20Fits)%0A%0A%20%20%20%20Length%20of%20stay%20per%20state%20block%2C%20fit%20using%20scipy.%20Lognormal%20wins%208%20of%209%20states%20(exponential%20for%20ED%20East%20Campus).%20All%20states%20are%20heavily%20right-skewed%20(mean%20%3E%3E%20median)%20due%20to%20long-stay%20outliers.%0A%0A%20%20%20%20%7C%20State%20%7C%20Best%20Fit%20%7C%20Params%20(shape%2C%20loc%2C%20scale)%20%7C%20Mean%20(h)%20%7C%20Median%20(h)%20%7C%0A%20%20%20%20%7C---%7C---%7C---%7C---%7C---%7C%0A%20%20%20%20%7C%20ED_East%20Campus%20%7C%20expon%20%7C%20(0.017%2C%203.67)%20%7C%203.7%20%7C%202.5%20%7C%0A%20%20%20%20%7C%20ED_Hillcrest%20%7C%20lognorm%20%7C%20(0.777%2C%20-0.658%2C%205.644)%20%7C%207.0%20%7C%204.8%20%7C%0A%20%20%20%20%7C%20ED_La%20Jolla%20%7C%20lognorm%20%7C%20(1.255%2C%20-0.107%2C%206.123)%20%7C%2013.7%20%7C%204.8%20%7C%0A%20%20%20%20%7C%20Floor_East%20Campus%20%7C%20lognorm%20%7C%20(1.001%2C%20-1.784%2C%2059.882)%20%7C%20110.5%20%7C%2053.1%20%7C%0A%20%20%20%20%7C%20Floor_Hillcrest%20%7C%20lognorm%20%7C%20(1.186%2C%20-3.259%2C%2059.236)%20%7C%20112.1%20%7C%2061.9%20%7C%0A%20%20%20%20%7C%20Floor_La%20Jolla%20%7C%20lognorm%20%7C%20(1.177%2C%20-3.345%2C%2052.999)%20%7C%2099.8%20%7C%2053.8%20%7C%0A%20%20%20%20%7C%20ICU_East%20Campus%20%7C%20lognorm%20%7C%20(0.946%2C%20-2.649%2C%2048.313)%20%7C%2074.6%20%7C%2042.8%20%7C%0A%20%20%20%20%7C%20ICU_Hillcrest%20%7C%20lognorm%20%7C%20(1.002%2C%20-2.176%2C%2059.649)%20%7C%20102.2%20%7C%2051.6%20%7C%0A%20%20%20%20%7C%20ICU_La%20Jolla%20%7C%20lognorm%20%7C%20(1.120%2C%20-0.956%2C%2046.637)%20%7C%2093.2%20%7C%2043.4%20%7C%0A%0A%20%20%20%20---%0A%0A%20%20%20%20%23%23%203.%20Trajectory%20Library%0A%0A%20%20%20%20150%2C337%20patient%20trajectories%20with%20state%20and%20duration%20at%20each%20stop.%20Each%20encounter%20maps%20to%20a%20sequence%20of%20%60(state%2C%20duration_hours)%60%20tuples.%20Example%3A%20%60ED_La%20Jolla%20(4.5h)%20%E2%86%92%20Floor_La%20Jolla%20(48.2h)%20%E2%86%92%20Discharge%60.%20Combines%20the%20transition%20logic%20with%20the%20duration%20data%20for%20full%20patient%20path%20reconstruction.%0A%0A%20%20%20%20---%0A%0A%20%20%20%20%23%23%204.%20Arrival%20Rates%20(Weekday%20vs%20Weekend)%0A%0A%20%20%20%20Mean%20daily%20arrivals%20by%20campus%20and%20day%20type%2C%20calculated%20from%20the%20first%20event%20of%20each%20encounter.%0A%0A%20%20%20%20%7C%20Campus%20%7C%20Weekday%20(mean%20%C2%B1%20std)%20%7C%20Weekend%20(mean%20%C2%B1%20std)%20%7C%0A%20%20%20%20%7C---%7C---%7C---%7C%0A%20%20%20%20%7C%20East%20Campus%20%7C%2092.4%20%C2%B1%2010.5%20%7C%2083.3%20%C2%B1%2010.5%20%7C%0A%20%20%20%20%7C%20Hillcrest%20%7C%20144.7%20%C2%B1%2019.9%20%7C%20125.1%20%C2%B1%2010.3%20%7C%0A%20%20%20%20%7C%20La%20Jolla%20%7C%20198.2%20%C2%B1%2026.2%20%7C%20148.9%20%C2%B1%2014.5%20%7C%0A%0A%20%20%20%20All%20campuses%20show%2010%E2%80%9325%25%20fewer%20arrivals%20on%20weekends%2C%20consistent%20with%20reduced%20elective%20admissions.%20La%20Jolla%20has%20the%20largest%20absolute%20drop.%0A%0A%20%20%20%20---%0A%0A%20%20%20%20%23%23%20Known%20Limitation%3A%20Boarded%20Patients%0A%0A%20%20%20%20148%2C234%20ED%20events%20(~33%25%20of%20all%20ED%20events)%20are%20boarded%20patients%20%E2%80%94%20physically%20in%20the%20ED%20but%20already%20admitted%20as%20inpatients.%20These%20inflate%20ED%20duration%20distributions%20significantly%3A%20median%2014.7h%20with%20boarding%20vs%203.3h%20without.%20For%20v1%20of%20the%20simulation%2C%20boarded%20time%20is%20counted%20as%20ED%20occupancy.%20Future%20iterations%20could%20split%20these%20encounters%20at%20the%20patient_class%20change%20point%20to%20separate%20true%20ED%20time%20from%20boarding%20time.%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell(hide_code%3DTrue)%0Adef%20_(mo)%3A%0A%20%20%20%20mo.md(r%22%22%22%0A%20%20%20%20%23%20Saving%20all%20tables%20to%20be%20imported%20to%20another%20notebook%20for%20DES%0A%20%20%20%20%22%22%22)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20%23%20df_clean_tier.to_csv('ADT_cleaned_with_tiers.csv')%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(prob_matrix)%3A%0A%20%20%20%20%23%20prob_matrix.to_csv('probability_matrix.csv')%0A%20%20%20%20prob_matrix%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(pd)%3A%0A%0A%20%20%20%20fitted_dist_data%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%5B%22ED_East%20Campus%22%2C%20%22expon%22%2C%20(0.017%2C%203.67)%2C%203.7%2C%202.5%5D%2C%0A%20%20%20%20%20%20%20%20%5B%22ED_Hillcrest%22%2C%20%22lognorm%22%2C%20(0.777%2C%20-0.658%2C%205.644)%2C%207.0%2C%204.8%5D%2C%0A%20%20%20%20%20%20%20%20%5B%22ED_La%20Jolla%22%2C%20%22lognorm%22%2C%20(1.255%2C%20-0.107%2C%206.123)%2C%2013.7%2C%204.8%5D%2C%0A%20%20%20%20%20%20%20%20%5B%22Floor_East%20Campus%22%2C%20%22lognorm%22%2C%20(1.001%2C%20-1.784%2C%2059.882)%2C%20110.5%2C%2053.1%5D%2C%0A%20%20%20%20%20%20%20%20%5B%22Floor_Hillcrest%22%2C%20%22lognorm%22%2C%20(1.186%2C%20-3.259%2C%2059.236)%2C%20112.1%2C%2061.9%5D%2C%0A%20%20%20%20%20%20%20%20%5B%22Floor_La%20Jolla%22%2C%20%22lognorm%22%2C%20(1.177%2C%20-3.345%2C%2052.999)%2C%2099.8%2C%2053.8%5D%2C%0A%20%20%20%20%20%20%20%20%5B%22ICU_East%20Campus%22%2C%20%22lognorm%22%2C%20(0.946%2C%20-2.649%2C%2048.313)%2C%2074.6%2C%2042.8%5D%2C%0A%20%20%20%20%20%20%20%20%5B%22ICU_Hillcrest%22%2C%20%22lognorm%22%2C%20(1.002%2C%20-2.176%2C%2059.649)%2C%20102.2%2C%2051.6%5D%2C%0A%20%20%20%20%20%20%20%20%5B%22ICU_La%20Jolla%22%2C%20%22lognorm%22%2C%20(1.120%2C%20-0.956%2C%2046.637)%2C%2093.2%2C%2043.4%5D%2C%0A%20%20%20%20%5D%0A%0A%20%20%20%20fitted_dist_df%20%3D%20pd.DataFrame(%0A%20%20%20%20%20%20%20%20fitted_dist_data%2C%0A%20%20%20%20%20%20%20%20columns%3D%5B%22state%22%2C%20%22best_fit%22%2C%20%22params)%22%2C%20%22mean%22%2C%20%22median%22%5D%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20fitted_dist_df.to_csv('states_fitted_distribution_df.csv')%0A%20%20%20%20%23%20fitted_dist_df%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(pd)%3A%0A%20%20%20%20arrival_rates_data%20%3D%20%5B%0A%20%20%20%20%20%20%20%20%5B%22East%20Campus%22%2C%2092.4%2C%2010.5%2C%2083.3%2C%2010.5%5D%2C%0A%20%20%20%20%20%20%20%20%5B%22Hillcrest%22%2C%20144.7%2C%2019.9%2C%20125.1%2C%2010.3%5D%2C%0A%20%20%20%20%20%20%20%20%5B%22La%20Jolla%22%2C%20198.2%2C%2026.2%2C%20148.9%2C%2014.5%5D%2C%0A%20%20%20%20%5D%0A%0A%20%20%20%20df_week%20%3D%20pd.DataFrame(%0A%20%20%20%20%20%20%20%20arrival_rates_data%2C%0A%20%20%20%20%20%20%20%20columns%3D%5B%0A%20%20%20%20%20%20%20%20%20%20%20%20%22campus%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22weekday_mean%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22weekday_std%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22weekend_mean%22%2C%0A%20%20%20%20%20%20%20%20%20%20%20%20%22weekend_std%22%2C%0A%20%20%20%20%20%20%20%20%5D%0A%20%20%20%20)%0A%0A%20%20%20%20%23%20df_week.to_csv('weekday_weekend_arrival_rates_df.csv')%0A%20%20%20%20df_week%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_(trajectory_library)%3A%0A%20%20%20%20type(trajectory_library)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20%23%20import%20json%0A%20%20%20%20%23%20with%20open('trajectory_library.json'%2C%20'w')%20as%20json_file%3A%0A%20%20%20%20%23%20%20%20%20%20json.dump(trajectory_library%2C%20json_file%2C%20indent%3D4)%0A%20%20%20%20return%0A%0A%0A%40app.cell%0Adef%20_()%3A%0A%20%20%20%20return%0A%0A%0Aif%20__name__%20%3D%3D%20%22__main__%22%3A%0A%20%20%20%20app.run()%0A
</marimo-code>

<marimo-code-hash hidden="">1380b0d10aeb47ba7076f558f5deaf51</marimo-code-hash>
</body>
</html>
